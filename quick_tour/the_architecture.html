<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    <title>Архитектура &mdash; Symfony Framework Documentation  documentation</title>
    
    <link rel="stylesheet" href="../_static/" type="text/css">
    <link rel="stylesheet" href="..\_static\pygments.css" type="text/css">
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <link rel="top" title="Symfony Framework Documentation  documentation" href="..\index.html">

<link rel="stylesheet" href="..\_assets\app.css?v=8d6d457a0820d7c245bddae16bfd4c75">
<script src="..\_assets\manifest.js?v=d41d8cd98f00b204e980"></script>
<script src="..\_assets\app.js?v=900984040c7cb4dca514"></script>
<style>
    .header__top .container {
        overflow: hidden;
        padding-top: 10px;
        padding-bottom: 10px;
    }
    .header__top .header__logo {
        float: left;
    }
    .header__top .header__support {
        float: right;
    }

    .highlight .k, .highlight .gh, .highlight .gp,
    .highlight .gu, .highlight .kc, .highlight .kd,
    .highlight .kn, .highlight .kr, .highlight .nc,
    .highlight .nd, .highlight .ni, .highlight .nl,
    .highlight .nn, .highlight .nt, .highlight .ow,
    .highlight .se { font-weight: normal; }

    .highlight .c, .highlight .cm, .highlight .c1,
    .highlight .sd, .highlight .si { font-style: normal; }

    .doc { background: none; }
    #demo-warning {
        border: 3px dashed #c00;
        padding: 10px;
        margin-bottom: 30px;
    }
    #demo-warning h4 { font-size: 1.7em;font-weight: bold; }
    #demo-warning p { margin-bottom: 0; }
</style>

<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-107764519-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-107764519-1');
</script>

<!-- Facebook Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '250281335689441');
    fbq('track', 'PageView');
</script>
<img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=250281335689441&ev=PageView&noscript=1">
<!-- End Facebook Pixel Code -->

<script type="text/javascript">!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://vk.com/js/api/openapi.js?159",t.onload=function(){VK.Retargeting.Init("VK-RTRG-279161-8p6Jv"),VK.Retargeting.Hit()},document.head.appendChild(t)}();</script><img src="https://vk.com/rtrg?p=VK-RTRG-279161-8p6Jv" style="position:fixed; left:-999px;" alt="">


  </head>
  <body role="document">

<body class="quick_tour doc_article doc">

<header>
    <section class="header__top">
        <div class="container">
            <div class="header__logo">
                <a href="..\..\..\index.html">
                    <img src="..\..\..\_images\header-logo.svg" alt="Symfony.com.ua logo">
                </a>
            </div>
            <div class="header__support hidden-xs">
                <a href="http://playtini.ua/" title="Компания Playtini">
                    <img height="69" src="..\..\..\_images\support.png" alt="Symfony is a SensioLabs product">
                </a>
            </div>
        </div>
    </section>
</header>

<div class="container"><div id="page-content">
    <div class="row">
        <div id="sidebar" class="col-sm-3">
            <div id="sidebar-content"><div class="submenu">
    
    
    <ul class="list_submenu list-unstyled">
    
        <li class="first">
            <a href="..\index.html">Главная</a>
        </li>
    
        <li>
            <a href="..\components\index.html">Компоненты</a>
        </li>
    
        <li>
            <a href="..\best_practices\index.html">Лучшие практики</a>
        </li>
    
        <li>
            <a href="index.html">Быстрый старт</a>
        </li>
    
        <li>
            <a href="..\reference\index.html">Справочник</a>
        </li>
    
        <li>
            <a href="..\genindex.html">Индекс</a>
        </li>
    
        <li>
            <a href="..\contributing\index.html">Участие</a>
        </li>
    
    </ul>
</div>

                <div class="toc"> 
    <h4>Содержание</h4>
    <div class="toc-content">
        <ul>
<li><a class="reference internal" href="#">Архитектура</a><ul>
<li><a class="reference internal" href="#id2">Добавление логирования</a></li>
<li><a class="reference internal" href="#id3">Сервисы и автомонтирование</a></li>
<li><a class="reference internal" href="#id4">Создание сервисов</a></li>
<li><a class="reference internal" href="#twig">Расширение и автоконфигурация Twig</a></li>
<li><a class="reference internal" href="#id5">Со скоростью ветра: Кешированный контейнер</a></li>
<li><a class="reference internal" href="#id6">Разработка против производства: окружения</a></li>
<li><a class="reference internal" href="#id7">Переменные окружения</a></li>
<li><a class="reference internal" href="#id8">Продолжайте!</a></li>
</ul>
</li>
</ul>

    </div>
</div>
                
            </div>

            <div class="ads m-b-30">
                <h2>Вакансии Playtini</h2>
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/php-dev">
                            Middle+ PHP Developer/Symfony
                        </a>
                    </h3>
                    <div><b>Playtini</b> активно поддерживает и развивает свои продукты, и профессионализм команды. И на данный момент в поиске специалиста на позицию <b>«Middle+ PHP Developer/Symfony»,</b> который улучшит качество внутренних сервисов компании и увеличит их количество.</div>
                </div>
                <!--
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/symfony-senior">
                            Senior PHP Developer/Symfony
                        </a>
                    </h3>
                    <div>We are looking for strong, experienced <b>Senior PHP Developer/Symfony.</b> We expect him/her to participate in improving and extending a system built using microservice architecture by means of modern technologies.</div>
                </div>
                -->
                <div class="ad">
                    <h3><a href="http://playtini.ua/careers">
                        Остальные вакансии компании
                        <img src="..\..\..\_images\logo-playtini.png" alt="Playtini">
                    </a></h3>
                </div>
            </div>
        </div>

        <div id="main" class="col-sm-9">
            <ol class="breadcrumb">
                
                <li><a href="..\index.html">Документация</a></li>
                
                <li class="active">Архитектура</li>
            </ol>

            <div class="page">
                
  <div class="section" id="id1">
<h1>Архитектура<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>Вы - мой герой! Кто бы мог подумать, что вы все еще будете здесь, после
первых трех частей? Ваши усилия вскоре будут вознаграждены. Первые три части
не углублялись в рассмотрение архитектуры фреймворка. Так как она выделяет
Symfony из толпы фреймворков, давайте теперь нырнем в мир архитектуры.</p>
<div class="section" id="id2">
<h2>Добавление логирования<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Новое приложение Symfony микроскопическое: оно по сути состоит просто из системы
маршрутизации и контроллера. Но благодаря Flex, установка новых функций проста.</p>
<p>Хотите систему логирования? Не проблема:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> composer require logger
</pre></div>
</td></tr></table></div></div>
<p>Это устанавливает и конфигурирует (через рецепт) мощную библиотеку <a class="reference external" href="https://github.com/Seldaek/monolog">Monolog</a>. Чтобы
использовать логгер в контроллере, добавьте новый аргумент, типизрованный <tt class="docutils literal"><code>LoggerInterface</code></tt>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Psr\Log\LoggerInterface</span><span class="p">;</span>
<span class="c1">// ...</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nx">LoggerInterface</span> <span class="nv">$logger</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">info</span><span class="p">(</span><span class="s2">&quot;Saying hello to </span><span class="si">$name</span><span class="s2">!&quot;</span><span class="p">);</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>Вот и всё! Новое сообщение лога будет написано в <tt class="docutils literal"><code>var/log/dev.log</code></tt>. Конечно же,
это можно сконфигурировать, обновив один из файлов конфигурации, добавленный рецептом.</p>
</div>
<div class="section" id="id3">
<h2>Сервисы и автомонтирование<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Но погодите! Только что случилось что-то <em>очень</em> крутое. Symfony прочла типизирование
<tt class="docutils literal"><code>LoggerInterface</code></tt> и автоматически поняла, что должна передатьнам объект Логгера!
Это называется <em>автомонтирование</em>.</p>
<p>Каждая часть работы, которая проделывается в приложении Symfony, осуществляется
<em>объектом</em>: объект Логгер логирует, а объект Twig отображает шаблоны. Эти объекты
называются <em>сервисами</em> и они являются <em>инструментыми</em>, которые помогаю вам строить
богатые функции.</p>
<p>Чтобы сделать жизнь потрясающей, вы можете попросить Symfony передать вам сервис,
используя типизирование. Какие другие возможные классы или интерфейсы вы можете
использовать? Узнайте, выполнив:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> php bin/console debug:autowiring
</pre></div>
</td></tr></table></div></div>
<table border="1" class="docutils">
<colgroup>
<col width="63%">
<col width="37%">
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Тип класса/интерфейса</th>
<th class="head">ID сервиса союзника</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><code>Psr\Cache\CacheItemPoolInterface</code></tt></td>
<td>союзник для &quot;cache.app.recorder&quot;</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><code>Psr\Log\LoggerInterface</code></tt></td>
<td>союзник для &quot;monolog.logger&quot;</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><code>Symfony\Component\EventDispatcher\EventDispatcherInterface</code></tt></td>
<td>союзник для &quot;debug.event_dispatcher&quot;</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><code>Symfony\Component\HttpFoundation\RequestStack</code></tt></td>
<td>союзник для &quot;request_stack&quot;</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><code>Symfony\Component\HttpFoundation\Session\SessionInterface</code></tt></td>
<td>союзник для &quot;session&quot;</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><code>Symfony\Component\Routing\RouterInterface</code></tt></td>
<td>союзник для &quot;router.default&quot;</td>
</tr>
</tbody>
</table>
<p>Это только краткое резюме полного списка! И по мере добавления пакетов, этот список
также будет расти!</p>
</div>
<div class="section" id="id4">
<h2>Создание сервисов<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>Чтобы ваш код был упорядоченым, вы даже можете создать ваши собственные сервисы!
Представьте, что вы хотите сгенерировать рандомное приветствие (например, &quot;Привет&quot;,
&quot;Йо&quot;, и др.). Вместо того, чтобы помещать этот код напрямую в контроллер, создайте
новый класс:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/GreetingGenerator.php</span>
<span class="k">namespace</span> <span class="nx">App</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">GreetingGenerator</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getRandomGreeting</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$greetings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Hey&#39;</span><span class="p">,</span> <span class="s1">&#39;Yo&#39;</span><span class="p">,</span> <span class="s1">&#39;Aloha&#39;</span><span class="p">];</span>
        <span class="nv">$greeting</span> <span class="o">=</span> <span class="nv">$greetings</span><span class="p">[</span><span class="nb">array_rand</span><span class="p">(</span><span class="nv">$greetings</span><span class="p">)];</span>

        <span class="k">return</span> <span class="nv">$greeting</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>Отлично! Вы можете использовать это в вашем контроллере незамедлительно:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">App\GreetingGenerator</span><span class="p">;</span>
<span class="c1">// ...</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nx">LoggerInterface</span> <span class="nv">$logger</span><span class="p">,</span> <span class="nx">GreetingGenerator</span> <span class="nv">$generator</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$greeting</span> <span class="o">=</span> <span class="nv">$generator</span><span class="o">-&gt;</span><span class="na">getRandomGreeting</span><span class="p">();</span>

    <span class="nv">$logger</span><span class="o">-&gt;</span><span class="na">info</span><span class="p">(</span><span class="s2">&quot;Saying </span><span class="si">$greeting</span><span class="s2"> to </span><span class="si">$name</span><span class="s2">!&quot;</span><span class="p">);</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>Вот и всё! Symfony инстанциирует <tt class="docutils literal"><code>GreetingGenerator</code></tt> автоматически ипередаст его в
качестве аргумента. Но, можем ли мы <em>также</em> переместить логику логгера в
<tt class="docutils literal"><code>GreetingGenerator</code></tt>? Да! Вы можете использовать автомонтирование внутри сервиса,
чтобы получить доступ к <em>другим</em> сервисам. Единственное отличие в том, что это делается
в конструкторе:</p>
<div class="literal-block"><div class="highlight-diff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gi">+ use Psr\Log\LoggerInterface;</span>

class GreetingGenerator
{
<span class="gi">+     private $logger;</span>
<span class="gi">+</span>
<span class="gi">+     public function __construct(LoggerInterface $logger)</span>
<span class="gi">+     {</span>
<span class="gi">+         $this-&gt;logger = $logger;</span>
<span class="gi">+     }</span>

    public function getRandomGreeting()
    {
        // ...

 +        $this-&gt;logger-&gt;info(&#39;Using the greeting: &#39;.$greeting);

         return $greeting;
    }
}
</pre></div>
</td></tr></table></div></div>
<p>Да! Это тоже работает: никакой конфигурации, никакое время не потеряно.
Продолжайте писать код!</p>
</div>
<div class="section" id="twig">
<h2>Расширение и автоконфигурация Twig<a class="headerlink" href="#twig" title="Permalink to this headline">¶</a></h2>
<p>Благодаря обработке сервисов Symfony, вы можете <em>расширять</em> Symfony множеством
способов, вроде создания подписчика событий или избирателя безопасности для
сложных правил авторизации. Давайте добавим в Twig новый фильтр под названием
<tt class="docutils literal"><code>greet</code></tt>. Как? Просто создайте класс, расширяющий <tt class="docutils literal"><code>AbstractExtension</code></tt>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/Twig/GreetExtension.php</span>
<span class="k">namespace</span> <span class="nx">App\Twig</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">App\GreetingGenerator</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Twig\Extension\AbstractExtension</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Twig\TwigFilter</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">GreetExtension</span> <span class="k">extends</span> <span class="nx">AbstractExtension</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="nv">$greetingGenerator</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">GreetingGenerator</span> <span class="nv">$greetingGenerator</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">greetingGenerator</span> <span class="o">=</span> <span class="nv">$greetingGenerator</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getFilters</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="k">new</span> <span class="nx">TwigFilter</span><span class="p">(</span><span class="s1">&#39;greet&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;greetUser&#39;</span><span class="p">]),</span>
        <span class="p">];</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">greetUser</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$greeting</span> <span class="o">=</span>  <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">greetingGenerator</span><span class="o">-&gt;</span><span class="na">getRandomGreeting</span><span class="p">();</span>

        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">$greeting</span><span class="s2"> </span><span class="si">$name</span><span class="s2">!&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>После создания всего <em>одного</em> файла, вы можете сразу же это использовать:</p>
<div class="literal-block"><div class="highlight-twig"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">{# Отобразит что-то вроде &quot;Привет, Symfony!&quot; #}</span><span class="x"></span>
<span class="x">&lt;h1&gt;</span><span class="cp">{{</span> <span class="nv">name</span><span class="o">|</span><span class="nf">greet</span> <span class="cp">}}</span><span class="x">&lt;/h1&gt;</span>
</pre></div>
</td></tr></table></div></div>
<p>Как это работает? Symfony замечает, что ваш класс расширяет <tt class="docutils literal"><code>AbstractExtension</code></tt> и поэтому
<em>автоматически</em> регистрирует его в качестве расширения Twig. Это называется автоконфигурацией
и работает для <em>очень</em> многих вещей. Просто создайте класс, а потом расширьте базовый класс
(или реализуйте интерфейс). Symfony позаботится обо всём остальном.</p>
</div>
<div class="section" id="id5">
<h2>Со скоростью ветра: Кешированный контейнер<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>Увидев, сколько всего Symfony делает автоматически, вы можете подумать: &quot;Разве
это не вредит производительности?&quot;. На самом деле, нет! Symfony работает со скоростью
ветра.</p>
<p>Как это возможно? Система сервисов упавляется очень важным объектом под названием
&quot;контейнер&quot;. Большинство фреймворков имеют контейнер, но в Symfony он уникален, так
как он <em>кеширован</em>. Когда вы загружаете вашу первую страницу, вся информация о сервисе
была скомпилирована и сохранена. Это означает, что функции автомонтирования и автоконфигурации
<em>не</em> добавляют нагрузки! Это также означает, что вы получаете <em>отличные</em> ошибки: Symfony
исследует и валидирует <em>всё</em>, когда строится контейнер.</p>
<p>Теперь вы можете интересоваться, что просиходит, когда вы обновляете файл и кешу
нужно построиться заново? Мне нравится ваше мышление! Он достаточно умён, чтобы
построиться при следующей загрузке страницы. Но на самом деле это тема следующего
раздела.</p>
</div>
<div class="section" id="id6">
<h2>Разработка против производства: окружения<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>Одной из главных задач фреймворка является облегчение отладки! И наше приложение <em>полно</em>
отличных инструментов для этого: панель инструментов веб-отладки отображает внизу страницы,
ошибки большие, прекрасные и полные, и любая конфигурация кеша автоматически строится заново
при необходимости.</p>
<p>Но что если вы развёртываете в производстве? Нам нужно будет спрятать эти инструменты и
оптимизироваться для скорости!</p>
<p>Это решается системой <em>окружений</em> Symfony и их есть три: <tt class="docutils literal"><code>dev</code></tt>, <tt class="docutils literal"><code>prod</code></tt> и <tt class="docutils literal"><code>test</code></tt>.
В зависимости от окружения, Symfony загружает разные файлы в каталог <tt class="docutils literal"><code>config/</code></tt>:</p>
<div class="literal-block"><div class="highlight-text"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span>config/
├─ services.yaml
├─ ...
└─ packages/
    ├─ framework.yaml
    ├─ ...
    ├─ **dev/**
        ├─ monolog.yaml
        └─ ...
    ├─ **prod/**
        └─ monolog.yaml
    └─ **test/**
        ├─ framework.yaml
        └─ ...
└─ routes/
    ├─ annotations.yaml
    └─ **dev/**
        ├─ twig.yaml
        └─ web_profiler.yaml
</pre></div>
</td></tr></table></div></div>
<p>Это <em>мощная</em> идея: изменяя одну часть конфигурации (окружение), ваше приложение
трансформируется из приятного опыта отладки в оптимизированное для скорости.</p>
<p>Ой, а как изменить окружение? Измените переменную окружения <tt class="docutils literal"><code>APP_ENV</code></tt> с
<tt class="docutils literal"><code>dev</code></tt> на <tt class="docutils literal"><code>prod</code></tt>:</p>
<div class="literal-block"><div class="highlight-diff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span># .env
<span class="gd">- APP_ENV=dev</span>
<span class="gi">+ APP_ENV=prod</span>
</pre></div>
</td></tr></table></div></div>
<p>Но я хочу больше поговорить о переменных окружений дальше. Измените значение обратно
на <tt class="docutils literal"><code>dev</code></tt>: инструменты отладки прекрасны, когда вы работаете локально.</p>
</div>
<div class="section" id="id7">
<h2>Переменные окружения<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>Каждое приложение содержит конфигурацию, которая отличается на каждом сервере -
вроде информации о соединениях БД или паролей. Как их нужно хранить? В файлах?
Или каким-то другим способом?</p>
<p>Symfony следует лучшей практике индустрии, храня конфигурацию, основанную на
сервере, в виде переменных <em>окружения</em>. Это означает, что Symfony <em>отлично</em>
работает с системами развёртывания Платформы, как Сервиса (PaaS), а также с
Docker.</p>
<p>Но установка переменных окружения во время разработки может быть напряжной.
Поэтому наше приложение автоматически загружает файл <tt class="docutils literal"><code>.env</code></tt> , если переменная
окружения <tt class="docutils literal"><code>APP_ENV</code></tt> не установлена в окружении. Ключи в этом файле потом становятся
переменными окружения и считываются вашим приложением:</p>
<div class="literal-block"><div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># .env</span>
<span class="c1">###&gt; symfony/framework-bundle ###</span>
<span class="nv">APP_ENV</span><span class="o">=</span>dev
<span class="nv">APP_SECRET</span><span class="o">=</span>cc86c7ca937636d5ddf1b754beb22a10
<span class="c1">###&lt; symfony/framework-bundle ###</span>
</pre></div>
</td></tr></table></div></div>
<p>Вначале файл не содержит многого. Но с ростом вашего приложения, вы добавите больше
конфигурации по мере необходимости. Но, на самом деле, становится намного интереснее!
Представьте, что вашему приложение нужно БД ORM. Давайте установим Doctrine ORM:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> composer require doctrine
</pre></div>
</td></tr></table></div></div>
<p>Благодаря новому рецепту, установленному Flex, посмотрите на файл <tt class="docutils literal"><code>.env</code></tt> ещё раз:</p>
<div class="literal-block"><div class="highlight-diff"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span>###&gt; symfony/framework-bundle ###
APP_ENV=dev
APP_SECRET=cc86c7ca937636d5ddf1b754beb22a10
###&lt; symfony/framework-bundle ###

<span class="gi">+ ###&gt; doctrine/doctrine-bundle ###</span>
<span class="gi">+ # ...</span>
<span class="gi">+ DATABASE_URL=mysql://db_user:<a href="..\..\..\cdn-cgi\l\email-protection.html" class="__cf_email__" data-cfemail="a8cccaf7d8c9dbdbdfc7dacce8999a9f869886988699">[email&#160;protected]</a>:3306/db_name</span>
<span class="gi">+ ###&lt; doctrine/doctrine-bundle ###</span>
</pre></div>
</td></tr></table></div></div>
<p>Новая переменная окружения <tt class="docutils literal"><code>DATABASE_URL</code></tt> была добавлена <em>автоматически</em> и на неё
уже ссылается новый файл конфигурации <tt class="docutils literal"><code>doctrine.yaml</code></tt>. Объединив переменные окружения
и Flex, вы используете лучшую практику индустрии без дополнительных усилий.</p>
</div>
<div class="section" id="id8">
<h2>Продолжайте!<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<p>Назовите меня сумасшедшим, но после прочтения этой части, вам должно быть комфортно
с наиболее <em>важными</em> частями Symfony. Всё в Symfony создано, чтобы не мешать вам
писать код и добавлять функции, всё со скоростью и качеством, которых вы хотите.</p>
<p>Вот и всё для быстрого тура. От аутентификации, до форм, до кеширования - ещё столько
предстоит исследовать. Готовы погрузиться в эти темы? Тогда не ищите, а переходите
на официальный <a class="reference internal" href="..\index.html"><em>Symfony Documentation</em></a> и выберите любой справочник, который хотите.</p>
</div>
</div>


            </div>

            

            <div id="license">
                <p>Эта документация является переводом <a href="http://symfony.com/doc/current/index.html">официальной документации Symfony</a> и предоставляется по свободной лицензии <a rel="license nofollow" href="https://creativecommons.org/licenses/by-sa/3.0/deed.ru">CC BY-SA 3.0</a>.</p>
            </div>
        </div>
    </div>
</div></div>


  <script data-cfasync="false" src="..\..\..\cdn-cgi\scripts\5c5dd728\cloudflare-static\email-decode.min.js"></script></body>
</body></html>