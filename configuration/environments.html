<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    <title>Как освоить и создавать новые окружения &mdash; Symfony Framework Documentation  documentation</title>
    
    <link rel="stylesheet" href="../_static/" type="text/css">
    <link rel="stylesheet" href="..\_static\pygments.css" type="text/css">
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <link rel="top" title="Symfony Framework Documentation  documentation" href="..\index.html">
    <link rel="up" title="Configuring Symfony (and Environments)" href="..\configuration.html">
    <link rel="next" title="How to Set external Parameters in the Service Container" href="external_parameters.html">
    <link rel="prev" title="How to Master and Create new Environments" href="environments.html">

<link rel="stylesheet" href="..\_assets\app.css?v=8d6d457a0820d7c245bddae16bfd4c75">
<script src="..\_assets\manifest.js?v=d41d8cd98f00b204e980"></script>
<script src="..\_assets\app.js?v=900984040c7cb4dca514"></script>
<style>
    .header__top .container {
        overflow: hidden;
        padding-top: 10px;
        padding-bottom: 10px;
    }
    .header__top .header__logo {
        float: left;
    }
    .header__top .header__support {
        float: right;
    }

    .highlight .k, .highlight .gh, .highlight .gp,
    .highlight .gu, .highlight .kc, .highlight .kd,
    .highlight .kn, .highlight .kr, .highlight .nc,
    .highlight .nd, .highlight .ni, .highlight .nl,
    .highlight .nn, .highlight .nt, .highlight .ow,
    .highlight .se { font-weight: normal; }

    .highlight .c, .highlight .cm, .highlight .c1,
    .highlight .sd, .highlight .si { font-style: normal; }

    .doc { background: none; }
    #demo-warning {
        border: 3px dashed #c00;
        padding: 10px;
        margin-bottom: 30px;
    }
    #demo-warning h4 { font-size: 1.7em;font-weight: bold; }
    #demo-warning p { margin-bottom: 0; }
</style>

<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-107764519-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-107764519-1');
</script>

<!-- Facebook Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '250281335689441');
    fbq('track', 'PageView');
</script>
<img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=250281335689441&ev=PageView&noscript=1">
<!-- End Facebook Pixel Code -->

<script type="text/javascript">!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://vk.com/js/api/openapi.js?159",t.onload=function(){VK.Retargeting.Init("VK-RTRG-279161-8p6Jv"),VK.Retargeting.Hit()},document.head.appendChild(t)}();</script><img src="https://vk.com/rtrg?p=VK-RTRG-279161-8p6Jv" style="position:fixed; left:-999px;" alt="">


  </head>
  <body role="document">

<body class="configuration doc_article doc">

<header>
    <section class="header__top">
        <div class="container">
            <div class="header__logo">
                <a href="..\..\..\index.html">
                    <img src="..\..\..\_images\header-logo.svg" alt="Symfony.com.ua logo">
                </a>
            </div>
            <div class="header__support hidden-xs">
                <a href="http://playtini.ua/" title="Компания Playtini">
                    <img height="69" src="..\..\..\_images\support.png" alt="Symfony is a SensioLabs product">
                </a>
            </div>
        </div>
    </section>
</header>

<div class="container"><div id="page-content">
    <div class="row">
        <div id="sidebar" class="col-sm-3">
            <div id="sidebar-content"><div class="submenu">
    
    
    <ul class="list_submenu list-unstyled">
    
        <li class="first">
            <a href="..\index.html">Главная</a>
        </li>
    
        <li>
            <a href="..\components\index.html">Компоненты</a>
        </li>
    
        <li>
            <a href="..\best_practices\index.html">Лучшие практики</a>
        </li>
    
        <li>
            <a href="..\quick_tour\index.html">Быстрый старт</a>
        </li>
    
        <li>
            <a href="..\reference\index.html">Справочник</a>
        </li>
    
        <li>
            <a href="..\genindex.html">Индекс</a>
        </li>
    
        <li>
            <a href="..\contributing\index.html">Участие</a>
        </li>
    
    </ul>
</div>

                <div class="toc"> 
    <h4>Содержание</h4>
    <div class="toc-content">
        <ul>
<li><a class="reference internal" href="#">Как освоить и создавать новые окружения</a><ul>
<li><a class="reference internal" href="#index-1">Разные окружения, разные файлы конфигурации</a></li>
<li><a class="reference internal" href="#index-2">Выполнение приложения в разных окружениях</a><ul>
<li><a class="reference internal" href="#id4">Выбор окружения для консольных команд</a></li>
</ul>
</li>
<li><a class="reference internal" href="#index-4">Создание нового окружения</a></li>
<li><a class="reference internal" href="#index-5">Окружения и каталог кеша</a></li>
<li><a class="reference internal" href="#id7">Дальнейшее продвижение</a></li>
</ul>
</li>
</ul>

    </div>
</div>
                
            </div>

            <div class="ads m-b-30">
                <h2>Вакансии Playtini</h2>
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/php-dev">
                            Middle+ PHP Developer/Symfony
                        </a>
                    </h3>
                    <div><b>Playtini</b> активно поддерживает и развивает свои продукты, и профессионализм команды. И на данный момент в поиске специалиста на позицию <b>«Middle+ PHP Developer/Symfony»,</b> который улучшит качество внутренних сервисов компании и увеличит их количество.</div>
                </div>
                <!--
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/symfony-senior">
                            Senior PHP Developer/Symfony
                        </a>
                    </h3>
                    <div>We are looking for strong, experienced <b>Senior PHP Developer/Symfony.</b> We expect him/her to participate in improving and extending a system built using microservice architecture by means of modern technologies.</div>
                </div>
                -->
                <div class="ad">
                    <h3><a href="http://playtini.ua/careers">
                        Остальные вакансии компании
                        <img src="..\..\..\_images\logo-playtini.png" alt="Playtini">
                    </a></h3>
                </div>
            </div>
        </div>

        <div id="main" class="col-sm-9">
            <ol class="breadcrumb">
                
                <li><a href="..\index.html">Документация</a></li>
                
                <li><a href="..\getting_started\index.html">Getting Started</a></li>
                
                <li><a href="..\setup.html">Installing &amp; Setting up the Symfony Framework</a></li>
                
                <li><a href="..\page_creation.html">Create your First Page in Symfony</a></li>
                
                <li><a href="..\routing.html">Routing</a></li>
                
                <li><a href="..\controller.html">Controller</a></li>
                
                <li><a href="..\templating.html">Creating and Using Templates</a></li>
                
                <li><a href="..\configuration.html">Configuring Symfony (and Environments)</a></li>
                
                <li class="active">Как освоить и создавать новые окружения</li>
            </ol>

            <div class="page">
                
  <div class="section" id="index-0">
<span id="id1"></span><h1>Как освоить и создавать новые окружения<a class="headerlink" href="#index-0" title="Permalink to this headline">¶</a></h1>
<p>Каждое приложение - это комбинация кода и набора конфигурации, которая диктует,
как должен функционировать код. Конфигурация может определять используемую БД,
нужно ли что-либо кешировать или степень многословности ведения записи логов.</p>
<p>В Symfony идея &quot;окружений&quot; заключается в том, что одна и та же кодовая база может
быть выполнена с использованием множества разных конфигураций. Например, окружение
<tt class="docutils literal"><code>dev</code></tt> должно использовать конфигурацию, которая делает разработку лёгкой и дружественной,
в то время, как окружение <tt class="docutils literal"><code>prod</code></tt> должно использовать набор конфигурации, оптимизированный
для скорости.</p>
<div class="section" id="index-1">
<span id="id2"></span><h2>Разные окружения, разные файлы конфигурации<a class="headerlink" href="#index-1" title="Permalink to this headline">¶</a></h2>
<p>Типичное приложение Symfony начинается с трёх окружений: <tt class="docutils literal"><code>dev</code></tt>, <tt class="docutils literal"><code>prod</code></tt>,
и <tt class="docutils literal"><code>test</code></tt>. Как уже было сказано, каждое окружение представляет собой
способ выполнять одну кодовую базу с разными конфигурациям. Поэтому не должно
быть сюрпризом, что каждое окружение загружает свой собственные файлы конфигурации.
Эти разные файлы упорядочены по окружению:</p>
<ul class="simple">
<li>для окружения <tt class="docutils literal"><code>dev</code></tt>: <tt class="docutils literal"><code>config/packages/dev/</code></tt></li>
<li>для окружения <tt class="docutils literal"><code>prod</code></tt>: <tt class="docutils literal"><code>config/packages/prod/</code></tt></li>
<li>для окружения <tt class="docutils literal"><code>test</code></tt>: <tt class="docutils literal"><code>config/packages/test/</code></tt></li>
</ul>
<p>В действительности, каждое окружение лишь слегка отличается от других. Это
означает, что все окружения имеют общую большую базу конфигураций. Эта
конфигурация размещается в файлах напрямую в каталоге <tt class="docutils literal"><code>config/packages/</code></tt>.</p>
<p>Расположение этих файлов определяется ядром приложения:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/Kernel.php</span>

<span class="c1">// ...</span>
<span class="k">class</span> <span class="nc">Kernel</span> <span class="k">extends</span> <span class="nx">BaseKernel</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="k">protected</span> <span class="k">function</span> <span class="nf">configureContainer</span><span class="p">(</span><span class="nx">ContainerBuilder</span> <span class="nv">$container</span><span class="p">,</span> <span class="nx">LoaderInterface</span> <span class="nv">$loader</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>
        <span class="nv">$confDir</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getProjectDir</span><span class="p">()</span><span class="o">.</span><span class="s1">&#39;/config&#39;</span><span class="p">;</span>

        <span class="c1">// всегда загружать все файлы в /config/packages/</span>
        <span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="nv">$confDir</span><span class="o">.</span><span class="s1">&#39;/packages/*&#39;</span><span class="o">.</span><span class="nx">self</span><span class="o">::</span><span class="na">CONFIG_EXTS</span><span class="p">,</span> <span class="s1">&#39;glob&#39;</span><span class="p">);</span>

        <span class="c1">// потом,если возможно, загружать файлы в определённом каталоге окружения</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$confDir</span><span class="o">.</span><span class="s1">&#39;/packages/&#39;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environment</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="nv">$confDir</span><span class="o">.</span><span class="s1">&#39;/packages/&#39;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environment</span><span class="o">.</span><span class="s1">&#39;/**/*&#39;</span><span class="o">.</span><span class="nx">self</span><span class="o">::</span><span class="na">CONFIG_EXTS</span><span class="p">,</span> <span class="s1">&#39;glob&#39;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// загружать специальный services.(yaml/xml/php) и, если возможно, файл services_ENVIRONMENT.(yaml/xml/php)</span>
        <span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="nv">$confDir</span><span class="o">.</span><span class="s1">&#39;/services&#39;</span><span class="o">.</span><span class="nx">self</span><span class="o">::</span><span class="na">CONFIG_EXTS</span><span class="p">,</span> <span class="s1">&#39;glob&#39;</span><span class="p">);</span>
        <span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="nv">$confDir</span><span class="o">.</span><span class="s1">&#39;/services_&#39;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environment</span><span class="o">.</span><span class="nx">self</span><span class="o">::</span><span class="na">CONFIG_EXTS</span><span class="p">,</span> <span class="s1">&#39;glob&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>Возьмите пакет фреймворка, установленный по умолчанию, в качестве примера:</p>
<ul class="simple">
<li>Загружается во всех окружениях, <tt class="docutils literal"><code>config/packages/framework.yaml</code></tt> конфигурирует
фреймворк с некоторой установкой <tt class="docutils literal"><code>secret</code></tt>;</li>
<li>В окружении <strong>prod</strong> не будет установлено ничего дополнительного, так как нет каталога
<tt class="docutils literal"><code>config/packages/prod/</code></tt>;</li>
<li>То же самое применимо к <strong>dev</strong>, так как нет <tt class="docutils literal"><code>config/packages/dev/framework.yaml</code></tt>.
Однако существуют другие пакеты (например, <tt class="docutils literal"><code>routing.yaml</code></tt>) со спецальными настройками
для dev;</li>
<li>Наконец, в окружении <strong>test</strong>, функции теста фреймворка включаются в
<tt class="docutils literal"><code>config/packages/test/framework.yaml</code></tt>.</li>
</ul>
</div>
<div class="section" id="index-2">
<span id="id3"></span><h2>Выполнение приложения в разных окружениях<a class="headerlink" href="#index-2" title="Permalink to this headline">¶</a></h2>
<p>Чтобы выполнить приложение в каждом окружении, измените переменную
окружения <tt class="docutils literal"><code>APP_ENV</code></tt>. Во время разработки это делается в <tt class="docutils literal"><code>.env</code></tt>:</p>
<div class="literal-block"><div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># .env</span>
<span class="nv">APP_ENV</span><span class="o">=</span>dev

<span class="c1"># или для теста:</span>
<span class="c1">#APP_ENV=test</span>
</pre></div>
</td></tr></table></div></div>
<p>Перейдите на страницу <tt class="docutils literal"><code>http://localhost:8000/index.php</code></tt> в вашем веб-браузере,
чтобы увидеть ваше приложение в сконфигурированном окружении.</p>
<div class="admonition-wrapper">
<div class="tip"></div><div class="admonition admonition-tip"><p class="first admonition-title">Tip</p>
<p class="last">В производстве рекомендуется конфигурировать переменные окружения в вашей
<a class="reference internal" href="external_parameters.html#configuration-env-var-in-prod"><span>конфигурации веб-сервера</span></a>.</p>
</div></div>
<div class="admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p class="last">Данные URL предполагают, что ваш веб-сервер сконфигурирован так, чтобы
использовать каталог приложение <tt class="docutils literal"><code>public/</code></tt> в качестве корневого. Прочтите
больше в <a class="reference internal" href="..\setup.html"><em>Установке Symfony</em></a>.</p>
</div></div>
<p>Если вы откроете файл, который вы только что посетили (<tt class="docutils literal"><code>public/index.php</code></tt>), то
вы увидите, что переменная окружения передаётся ядру:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// public/index.php</span>

<span class="c1">// ...</span>
<span class="nv">$kernel</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Kernel</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;APP_ENV&#39;</span><span class="p">]</span> <span class="o">??</span> <span class="s1">&#39;dev&#39;</span><span class="p">,</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;APP_DEBUG&#39;</span><span class="p">]</span> <span class="o">??</span> <span class="k">false</span><span class="p">);</span>

<span class="c1">// ...</span>
</pre></div>
</td></tr></table></div></div>
<p>Вы также можете заменить <tt class="docutils literal"><code>$_SERVER['APP_ENV'] ?? 'dev'</code></tt> просто на <tt class="docutils literal"><code>'dev'</code></tt>, чтобы
всегда выполнять приложение в окружении разработки, независимо от переменной <tt class="docutils literal"><code>APP_ENV</code></tt>.</p>
<div class="admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p class="last">Окружение <tt class="docutils literal"><code>test</code></tt> используется при написании функциональных тестов и оно
недоступно в браузере напрямую через фронт-контроллер.</p>
</div></div>
<div class="admonition-wrapper" id="index-3">
<div class="sidebar"></div><div class="admonition admonition-sidebar"><p class="first sidebar-title">Режим <em>отладки</em></p>
<p>Важным, но не имеющим отношения к теме <em>окружений</em>, является второй аргумент
конструктора <tt class="docutils literal"><code>Kernel</code></tt>. Он указывает, должно ли приложеие работать в &quot;режиме
отладки&quot;. Несмотря на окружение, приложение Symfony может быть запущено с режимом
отладки, установленным как <tt class="docutils literal"><code>true</code></tt> или <tt class="docutils literal"><code>false</code></tt> (<tt class="docutils literal"><code>1</code></tt> или <tt class="docutils literal"><code>0</code></tt> соответственно
для переменной <tt class="docutils literal"><code>APP_DEBUG</code></tt>, определённой в <tt class="docutils literal"><code>.env</code></tt>). Это влияет на многие вещи
в приложении, такие как отображение трассы вызовов в стеке на страницах ошибки или
на динамическую перестройку файлов кеша по каждому запросу. Хоть это и не является
требованием, режим отладки обычно установлен как <tt class="docutils literal"><code>true</code></tt> для окружений <tt class="docutils literal"><code>dev</code></tt> и
<tt class="docutils literal"><code>test</code></tt>, и как <tt class="docutils literal"><code>false</code></tt> для окружения <tt class="docutils literal"><code>prod</code></tt>.</p>
<p>Внутренне, значение режима отладки становится параметром <tt class="docutils literal"><code>kernel.debug</code></tt>,
используемым внутри <a class="reference internal" href="..\service_container.html"><em>сервис-контейнера</em></a>. Если вы
посмотрите внутрь файла конфигурации приложения, вы увидите, что используемый
параметр, например, включает режим отладки Twig:</p>
<div class="last configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="literal-block"><div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># config/packages/twig.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">twig</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="s">&#39;%kernel.debug%&#39;</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>XML</em><div class="literal-block"><div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;container</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/dic/services&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xmlns:doctrine=</span><span class="s">&quot;http://symfony.com/schema/dic/doctrine&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/dic/services</span>
<span class="s">        http://symfony.com/schema/dic/services/services-1.0.xsd</span>
<span class="s">        http://symfony.com/schema/dic/twig</span>
<span class="s">        http://symfony.com/schema/dic/twig/twig-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;twig:config</span> <span class="na">debug=</span><span class="s">&quot;%kernel.debug%&quot;</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;/container&gt;</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>PHP</em><div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;twig&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;debug&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;%kernel.debug%&#39;</span><span class="p">,</span>
    <span class="c1">// ...</span>
<span class="p">));</span>
</pre></div>
</td></tr></table></div></div>
</li>
</ul>
</div>
</div></div>
<div class="section" id="id4">
<h3>Выбор окружения для консольных команд<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>По умолчанию, команды Symfony выполняются в том окружении, которое определяется
переменной окружения <tt class="docutils literal"><code>APP_ENV</code></tt> (обычно конфигурируется в вашем файле <tt class="docutils literal"><code>.env</code></tt>)`.</p>
<p>Используйте опции <tt class="docutils literal"><code>--env</code></tt> и <tt class="docutils literal"><code>--no-debug</code></tt>, чтобы настроить это поведение:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># окружение &#39;dev&#39;, отладка включена</span>
<span class="gp">$</span> php bin/console command_name

<span class="c1"># окружение &#39;prod&#39; (отладка всегда отключена для &#39;prod&#39;)</span>
<span class="gp">$</span> php bin/console command_name --env<span class="o">=</span>prod

<span class="c1"># окружение &#39;test&#39;, отладка выключена</span>
<span class="gp">$</span> php bin/console command_name --env<span class="o">=</span><span class="nb">test</span> --no-debug
</pre></div>
</td></tr></table></div></div>
</div>
</div>
<div class="section" id="index-4">
<span id="id5"></span><h2>Создание нового окружения<a class="headerlink" href="#index-4" title="Permalink to this headline">¶</a></h2>
<p>Так как окружение - это не более, чем строка, соответствующая набору конфигурации,
создать его достаточно просто.</p>
<p>Представьте, к примеру, что перед развёртыванием вам нужно провести сравнительный
тест вашего приложения. Одним способом проведения сравнения вашего приложения является
использование около-производственных настроек с включённым <tt class="docutils literal"><code>web_profiler</code></tt> Symfony.
Это позволяет Symfony записывать информацию о вашем приложени во время проведения
сравнительного теста.</p>
<p>Наилучший способ достичь этого - через новое окружение, названное, например,
<tt class="docutils literal"><code>benchmark</code></tt>. Начните с создания нового каталога и файла конфигурации:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="literal-block"><div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># config/packages/benchmark/web_profiler.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">framework</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">profiler</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span> <span class="nv">only_exceptions</span><span class="p p-Indicator">:</span> <span class="nv">false</span> <span class="p p-Indicator">}</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>XML</em><div class="literal-block"><div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">&lt;!-- config/packages/benchmark/web_profiler.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;container</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/dic/services&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xmlns:framework=</span><span class="s">&quot;http://symfony.com/schema/dic/symfony&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/dic/services</span>
<span class="s">        http://symfony.com/schema/dic/services/services-1.0.xsd</span>
<span class="s">        http://symfony.com/schema/dic/symfony</span>
<span class="s">        http://symfony.com/schema/dic/symfony/symfony-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;framework:config&gt;</span>
        <span class="nt">&lt;framework:profiler</span> <span class="na">only-exceptions=</span><span class="s">&quot;false&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/framework:config&gt;</span>

<span class="nt">&lt;/container&gt;</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>PHP</em><div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// config/packages/benchmark/web_profiler.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;framework&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;profiler&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;only_exceptions&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">),</span>
<span class="p">));</span>
</pre></div>
</td></tr></table></div></div>
</li>
</ul>
</div>
<p>И... вы закончили! Теперь приложение поддерживает новое окружение под названием
<tt class="docutils literal"><code>benchmark</code></tt>.</p>
<p>Измените переменную <tt class="docutils literal"><code>APP_ENV</code></tt> на <tt class="docutils literal"><code>benchmark</code></tt>, чтобы иметь доступ к новому окружению
в вашем браузере:</p>
<div class="literal-block"><div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># .env</span>
<span class="nv">APP_ENV</span><span class="o">=</span>benchmark
</pre></div>
</td></tr></table></div></div>
<div class="admonition-wrapper">
<div class="sidebar"></div><div class="admonition admonition-sidebar"><p class="first sidebar-title">Импорт конфигурации</p>
<p>Кроме загрузки файлов в ядре, вы также можете импортировать файлы в конфигурацию
напрямую. Например, чтобы убедиться, что окружение benchmark идентично окружению
производства, вы можете захотеть также загрузить всю его конфигурацию.</p>
<p class="last">Вы можете достичь этого, используя спеиальный клюс <tt class="docutils literal"><code>imports</code></tt>:</p>
</div></div>
</div>
<div class="section" id="index-5">
<span id="id6"></span><h2>Окружения и каталог кеша<a class="headerlink" href="#index-5" title="Permalink to this headline">¶</a></h2>
<p>Symfony во многом пользуется преимуществами кеширования: конфигурация приложения,
конфигурация маршрутизации, шаблоны Twig и многое другое кешируется в PHP-объекты,
хранящиеся в файлах файловой системы.</p>
<p>По умолчанию, эти кешированные файлы в основном хранятся в каталоге <tt class="docutils literal"><code>var/cache/</code></tt>.
Однако, каждое окружение кеширует свой собственный набор файлов:</p>
<div class="literal-block"><div class="highlight-text"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span>your-project/
├─ var/
│  ├─ cache/
│  │  ├─ dev/   # cache directory for the *dev* environment
│  │  └─ prod/  # cache directory for the *prod* environment
│  ├─ ...
</pre></div>
</td></tr></table></div></div>
<p>Иногда при отладке может быть полезным инспектировать кешированный файл,
чтобы понять, как что-то работает. Если будете так делать, не забудьте
посмотреть в каталог окружения, которое вы используете (чаще всего <tt class="docutils literal"><code>dev/</code></tt>
при разработке и отладке). Несмотря на возможные различия, каталог
<tt class="docutils literal"><code>var/cache/dev/</code></tt> включает в себя следующее:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><code>appDevDebugProjectContainer.php</code></tt></dt>
<dd>Кешированный &quot;сервис-контейнер&quot;, который представляет кешированную конфигурацию
приложения.</dd>
<dt><tt class="docutils literal"><code>appDevUrlGenerator.php</code></tt></dt>
<dd>PHP-класс сгенерированный из конфигурации маршрутизации и используемый при
генерировании URL.</dd>
<dt><tt class="docutils literal"><code>appDevUrlMatcher.php</code></tt></dt>
<dd>PHP-класс, используемый для сопоставления маршрутов - смотрите сюда, чтобы
увидеть скомпилированную логику регулярных выражений, используемую для
сопоставления входящих URL с разными маршрутами.</dd>
<dt><tt class="docutils literal"><code>twig/</code></tt></dt>
<dd>Этот каталог кодержит все кешированные шаблоны Twig.</dd>
</dl>
<div class="admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p class="last">Вы можете с лёгкостью изменить локацию и имя каталога. Чтобы узнать больше,
прочтите статью <a class="reference internal" href="override_dir_structure.html"><em>How to Override Symfony's default Directory Structure</em></a>.</p>
</div></div>
</div>
<div class="section" id="id7">
<h2>Дальнейшее продвижение<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>Прочтите статью о <a class="reference internal" href="external_parameters.html"><em>How to Set external Parameters in the Service Container</em></a>.</p>
</div>
</div>


            </div>

            
            <div class="navigation">
                <a href="environments.html">« How to Master and Create new Environments</a>
                <span class="separator">|</span>
                <a href="external_parameters.html">How to Set external Parameters in the Service Container »</a>
            </div>
            

            <div id="license">
                <p>Эта документация является переводом <a href="http://symfony.com/doc/current/index.html">официальной документации Symfony</a> и предоставляется по свободной лицензии <a rel="license nofollow" href="https://creativecommons.org/licenses/by-sa/3.0/deed.ru">CC BY-SA 3.0</a>.</p>
            </div>
        </div>
    </div>
</div></div>


  </body>
</body></html>