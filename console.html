<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    <title>Команды консоли &mdash; Symfony Framework Documentation  documentation</title>
    
    <link rel="stylesheet" href="_static/" type="text/css">
    <link rel="stylesheet" href="_static\pygments.css" type="text/css">
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <link rel="top" title="Symfony Framework Documentation  documentation" href="index.html">

<link rel="stylesheet" href="_assets\app.css?v=8d6d457a0820d7c245bddae16bfd4c75">
<script src="_assets\manifest.js?v=d41d8cd98f00b204e980"></script>
<script src="_assets\app.js?v=900984040c7cb4dca514"></script>
<style>
    .header__top .container {
        overflow: hidden;
        padding-top: 10px;
        padding-bottom: 10px;
    }
    .header__top .header__logo {
        float: left;
    }
    .header__top .header__support {
        float: right;
    }

    .highlight .k, .highlight .gh, .highlight .gp,
    .highlight .gu, .highlight .kc, .highlight .kd,
    .highlight .kn, .highlight .kr, .highlight .nc,
    .highlight .nd, .highlight .ni, .highlight .nl,
    .highlight .nn, .highlight .nt, .highlight .ow,
    .highlight .se { font-weight: normal; }

    .highlight .c, .highlight .cm, .highlight .c1,
    .highlight .sd, .highlight .si { font-style: normal; }

    .doc { background: none; }
    #demo-warning {
        border: 3px dashed #c00;
        padding: 10px;
        margin-bottom: 30px;
    }
    #demo-warning h4 { font-size: 1.7em;font-weight: bold; }
    #demo-warning p { margin-bottom: 0; }
</style>

<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-107764519-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-107764519-1');
</script>

<!-- Facebook Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '250281335689441');
    fbq('track', 'PageView');
</script>
<img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=250281335689441&ev=PageView&noscript=1">
<!-- End Facebook Pixel Code -->

<script type="text/javascript">!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://vk.com/js/api/openapi.js?159",t.onload=function(){VK.Retargeting.Init("VK-RTRG-279161-8p6Jv"),VK.Retargeting.Hit()},document.head.appendChild(t)}();</script><img src="https://vk.com/rtrg?p=VK-RTRG-279161-8p6Jv" style="position:fixed; left:-999px;" alt="">


  </head>
  <body role="document">

<body class="console-r doc_article doc">

<header>
    <section class="header__top">
        <div class="container">
            <div class="header__logo">
                <a href="..\..\index.html">
                    <img src="..\..\_images\header-logo.svg" alt="Symfony.com.ua logo">
                </a>
            </div>
            <div class="header__support hidden-xs">
                <a href="http://playtini.ua/" title="Компания Playtini">
                    <img height="69" src="..\..\_images\support.png" alt="Symfony is a SensioLabs product">
                </a>
            </div>
        </div>
    </section>
</header>

<div class="container"><div id="page-content">
    <div class="row">
        <div id="sidebar" class="col-sm-3">
            <div id="sidebar-content"><div class="submenu">
    
    
    <ul class="list_submenu list-unstyled">
    
        <li class="first">
            <a href="index.html">Главная</a>
        </li>
    
        <li>
            <a href="components\index.html">Компоненты</a>
        </li>
    
        <li>
            <a href="best_practices\index.html">Лучшие практики</a>
        </li>
    
        <li>
            <a href="quick_tour\index.html">Быстрый старт</a>
        </li>
    
        <li>
            <a href="reference\index.html">Справочник</a>
        </li>
    
        <li>
            <a href="genindex.html">Индекс</a>
        </li>
    
        <li>
            <a href="contributing\index.html">Участие</a>
        </li>
    
    </ul>
</div>

                <div class="toc"> 
    <h4>Содержание</h4>
    <div class="toc-content">
        <ul>
<li><a class="reference internal" href="#">Команды консоли</a><ul>
<li><a class="reference internal" href="#app-env-app-debug">Консоль: APP_ENV и APP_DEBUG</a></li>
<li><a class="reference internal" href="#id2">Создание команды</a></li>
<li><a class="reference internal" href="#id3">Конфигурация команды</a></li>
<li><a class="reference internal" href="#id4">Регистрация команды</a></li>
<li><a class="reference internal" href="#id5">Выполнение команды</a></li>
<li><a class="reference internal" href="#id6">Вывод в консоль</a><ul>
<li><a class="reference internal" href="#console-output-sections-ru">Секции вывода</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id8">Консоль ввода</a></li>
<li><a class="reference internal" href="#id9">Получение сервисов и сервис-контейнера</a></li>
<li><a class="reference internal" href="#id10">Жизненный цикл команды</a></li>
<li><a class="reference internal" href="#console-testing-commands-ru">Тестирование команд</a></li>
<li><a class="reference internal" href="#id12">Узнать больше</a></li>
</ul>
</li>
</ul>

    </div>
</div>
                
            </div>

            <div class="ads m-b-30">
                <h2>Вакансии Playtini</h2>
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/php-dev">
                            Middle+ PHP Developer/Symfony
                        </a>
                    </h3>
                    <div><b>Playtini</b> активно поддерживает и развивает свои продукты, и профессионализм команды. И на данный момент в поиске специалиста на позицию <b>«Middle+ PHP Developer/Symfony»,</b> который улучшит качество внутренних сервисов компании и увеличит их количество.</div>
                </div>
                <!--
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/symfony-senior">
                            Senior PHP Developer/Symfony
                        </a>
                    </h3>
                    <div>We are looking for strong, experienced <b>Senior PHP Developer/Symfony.</b> We expect him/her to participate in improving and extending a system built using microservice architecture by means of modern technologies.</div>
                </div>
                -->
                <div class="ad">
                    <h3><a href="http://playtini.ua/careers">
                        Остальные вакансии компании
                        <img src="..\..\_images\logo-playtini.png" alt="Playtini">
                    </a></h3>
                </div>
            </div>
        </div>

        <div id="main" class="col-sm-9">
            <ol class="breadcrumb">
                
                <li><a href="index.html">Документация</a></li>
                
                <li class="active">Команды консоли</li>
            </ol>

            <div class="page">
                
  <div class="section" id="index-0">
<span id="id1"></span><h1>Команды консоли<a class="headerlink" href="#index-0" title="Permalink to this headline">¶</a></h1>
<p>Фреймворк Symfony предоставляет множество команд через скрипт <tt class="docutils literal"><code>bin/console</code></tt>
(например, хорошо известная команда <tt class="docutils literal"><code>bin/console cache:clear</code></tt>). Эти команды
создаются с помощью <a class="reference internal" href="components\console.html"><em>Компонента консоль</em></a>. Вы можете
также использовать его для создания собственных команд.</p>
<div class="section" id="app-env-app-debug">
<h2>Консоль: APP_ENV и APP_DEBUG<a class="headerlink" href="#app-env-app-debug" title="Permalink to this headline">¶</a></h2>
<p>Консольные команды выполняются в <a class="reference internal" href="configuration.html#config-dot-env"><span>окружении</span></a>, определённом в
переменной <tt class="docutils literal"><code>APP_ENV</code></tt> файла <tt class="docutils literal"><code>.env</code></tt>, по умолчанию - <tt class="docutils literal"><code>dev</code></tt>. Он также считывает
значение <tt class="docutils literal"><code>APP_DEBUG</code></tt>, чтобы включать и выключать режим &quot;отладки&quot; (по умолчанию -
<tt class="docutils literal"><code>1</code></tt>, то есть включён).</p>
<p>Чтобы запустить команду в другом окружении или режиме отладки, отредактируйте значение
<tt class="docutils literal"><code>APP_ENV</code></tt> и <tt class="docutils literal"><code>APP_DEBUG</code></tt>.</p>
</div>
<div class="section" id="id2">
<h2>Создание команды<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Команды определяются в классах, расширяющих <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Command/Command.html" title="Symfony\Component\Console\Command\Command">Command</a></code></tt>.
Например, вы можете захотеть, чтобы команда создавала пользователя:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/Command/CreateUserCommand.php</span>
<span class="k">namespace</span> <span class="nx">App\Command</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Component\Console\Command\Command</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Console\Input\InputInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Console\Output\OutputInterface</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">CreateUserCommand</span> <span class="k">extends</span> <span class="nx">Command</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="k">function</span> <span class="nf">configure</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>

    <span class="k">protected</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">(</span><span class="nx">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="nx">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
</div>
<div class="section" id="id3">
<h2>Конфигурация команды<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Для начала, вы должны сконфигурировать имя команды в методе <tt class="docutils literal"><code>configure()</code></tt>.
После этого вы можете по желанию определить сообщение помощи и
<a class="reference internal" href="console\input.html"><em>аргументы и опции ввода</em></a>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// ...</span>
<span class="k">protected</span> <span class="k">function</span> <span class="nf">configure</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$this</span>
        <span class="c1">// имя команды (часть после &quot;bin/console&quot;)</span>
        <span class="o">-&gt;</span><span class="na">setName</span><span class="p">(</span><span class="s1">&#39;app:create-user&#39;</span><span class="p">)</span>

        <span class="c1">// краткое описание, отображающееся при запуске &quot;php bin/console list&quot;</span>
        <span class="o">-&gt;</span><span class="na">setDescription</span><span class="p">(</span><span class="s1">&#39;Creates a new user.&#39;</span><span class="p">)</span>

        <span class="c1">// полное описание команды, отображающееся при запуске команды</span>
        <span class="c1">// с опцией &quot;--help&quot;</span>
        <span class="o">-&gt;</span><span class="na">setHelp</span><span class="p">(</span><span class="s1">&#39;This command allows you to create a user...&#39;</span><span class="p">)</span>
    <span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>Метод <tt class="docutils literal"><code>configure()</code></tt> вызывается автоматически в конце конструктора команды.
Если ваша команда определяет свой конструктор, сначала установите свойства
и вызовите родительский конструктор для того, чтобы эти свойства стали
доступны в методе <tt class="docutils literal"><code>configure()</code></tt>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CreateUserCommand</span> <span class="k">extends</span> <span class="nx">Command</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">bool</span> <span class="nv">$requirePassword</span> <span class="o">=</span> <span class="k">false</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// хорошей практикой считается вызывать сначала родительский конструктор и</span>
        <span class="c1">// потом установка своих свойств. Это не сработает в данном случае</span>
        <span class="c1">// потому что configure() нуждается в установленных свойствах в конструкторе</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">requirePassword</span> <span class="o">=</span> <span class="nv">$requirePassword</span><span class="p">;</span>

        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">configure</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span>
            <span class="c1">// ...</span>
            <span class="o">-&gt;</span><span class="na">addArgument</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">requirePassword</span> <span class="o">?</span> <span class="nx">InputArgument</span><span class="o">::</span><span class="na">OPTIONAL</span> <span class="o">:</span> <span class="nx">InputArgument</span><span class="o">::</span><span class="na">REQUIRED</span><span class="p">,</span> <span class="s1">&#39;User password&#39;</span><span class="p">)</span>
        <span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
</div>
<div class="section" id="id4">
<h2>Регистрация команды<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>Команды Symfony должны быть зарегистрированы как сервисы и <a class="reference internal" href="service_container\tags.html"><em>отмечены тегом</em></a>
<tt class="docutils literal"><code>console.command</code></tt>. Если вы используете
<a class="reference internal" href="service_container.html#service-container-services-load-example"><span>кофигурацию services.yaml по умолчанию</span></a>,
это уже сделано для вас, благодаря <a class="reference internal" href="service_container.html#services-autoconfigure"><span>автоконфигурации</span></a>.</p>
</div>
<div class="section" id="id5">
<h2>Выполнение команды<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>После настройки и регистрации команды вы можете выполнить её в терминале:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> php bin/console app:create-user
</pre></div>
</td></tr></table></div></div>
<p>Как вы могли ожидать эта команда ничего не делает, так как вы пока не прописали никакой логики.
Добавьте свою логику в метод <tt class="docutils literal"><code>execute()</code></tt>.</p>
</div>
<div class="section" id="id6">
<h2>Вывод в консоль<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>Метод <tt class="docutils literal"><code>execute()</code></tt> имеет доступ к потоку вывода для того, чтобы писать сообщения в
консоль:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// ...</span>
<span class="k">protected</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">(</span><span class="nx">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="nx">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// выводит множество строк в консоль (добавляя &quot;\n&quot; в конце каждой строки)</span>
    <span class="nv">$output</span><span class="o">-&gt;</span><span class="na">writeln</span><span class="p">([</span>
        <span class="s1">&#39;User Creator&#39;</span><span class="p">,</span>
        <span class="s1">&#39;============&#39;</span><span class="p">,</span>
        <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="p">]);</span>

    <span class="c1">// значение возвращённое someMethod() может быть итератором (https://secure.php.net/iterator)</span>
    <span class="c1">// которое генерирует и возвращает сообщение с помощью ключевого слова PHP &#39;yield&#39;</span>
    <span class="nv">$output</span><span class="o">-&gt;</span><span class="na">writeln</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">someMethod</span><span class="p">());</span>

    <span class="c1">// выводит сообщение с последующим &quot;\n&quot;</span>
    <span class="nv">$output</span><span class="o">-&gt;</span><span class="na">writeln</span><span class="p">(</span><span class="s1">&#39;Ух ты!&#39;</span><span class="p">);</span>

    <span class="c1">// выводит сообщение, не добавляя &quot;\n&quot; в конце строки</span>
    <span class="nv">$output</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">&#39;Вы уже почти &#39;</span><span class="p">);</span>
    <span class="nv">$output</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">&#39;создали пользователя.&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.1: </span>Поддержка итераторов PHP в методах <tt class="docutils literal"><code>write()</code></tt> и <tt class="docutils literal"><code>writeln()</code></tt>
появилась в Symfony 4.1.</p>
</div>
<p>Теперь, попробуйте выполнить команду:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> php bin/console app:create-user
<span class="go">User Creator</span>
<span class="go">============</span>

<span class="go">Ух ты!</span>
<span class="go">Вы уже почти создали пользователя.</span>
</pre></div>
</td></tr></table></div></div>
<div class="section" id="console-output-sections-ru">
<span id="id7"></span><h3>Секции вывода<a class="headerlink" href="#console-output-sections-ru" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.1: </span>Секции вывода появились в Symfony 4.1.</p>
</div>
<p>Обычный вывод консоли может быть разделён на несколько независимых регионов
называемых &quot;секции вывода&quot;. Создайте одну или несколько данных секций, когда вам нужно
очистить и перезаписать выводимую информацию.</p>
<p>Секции создаются методом
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Output/ConsoleOutput.html#method_section" title="Symfony\Component\Console\Output\ConsoleOutput::section()">section()</a></code></tt>,
который возвращает экземпляр
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Output/ConsoleSectionOutput.html" title="Symfony\Component\Console\Output\ConsoleSectionOutput">ConsoleSectionOutput</a></code></tt>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyCommand</span> <span class="k">extends</span> <span class="nx">Command</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">(</span><span class="nx">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="nx">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$section1</span> <span class="o">=</span> <span class="nv">$output</span><span class="o">-&gt;</span><span class="na">section</span><span class="p">();</span>
        <span class="nv">$section2</span> <span class="o">=</span> <span class="nv">$output</span><span class="o">-&gt;</span><span class="na">section</span><span class="p">();</span>
        <span class="nv">$section1</span><span class="o">-&gt;</span><span class="na">writeln</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">);</span>
        <span class="nv">$section2</span><span class="o">-&gt;</span><span class="na">writeln</span><span class="p">(</span><span class="s1">&#39;World!&#39;</span><span class="p">);</span>
        <span class="c1">// Вывод отображает &quot;Hello\nWorld!\n&quot;</span>

        <span class="c1">// overwrite() заменяет всё содержимое секции с указанным текстом</span>
        <span class="nv">$section1</span><span class="o">-&gt;</span><span class="na">overwrite</span><span class="p">(</span><span class="s1">&#39;Goodbye&#39;</span><span class="p">);</span>
        <span class="c1">// Вывод сейчас отображает &quot;Goodbye\nWorld!\n&quot;</span>

        <span class="c1">// clear() удаляет всё содержимое данной секции...</span>
        <span class="nv">$section2</span><span class="o">-&gt;</span><span class="na">clear</span><span class="p">();</span>
        <span class="c1">// Вывод сейчас отображает &quot;Goodbye\n&quot;</span>

        <span class="c1">// ...но вы можете также удалить указанное число строк</span>
        <span class="c1">// (этот пример удаляет последние 2 строки секции)</span>
        <span class="nv">$section1</span><span class="o">-&gt;</span><span class="na">clear</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
        <span class="c1">// Вывод сейчас полностью пустой!</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<div class="admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p class="last">Новая строка добавляется автоматически при отображении информации в секции.</p>
</div></div>
<p>Секции вывода позволяют вам манипулировать выводом консоли сложными способами, например,
<a class="reference internal" href="components/console/helpers/progressbar-ru.html#console-multiple-progress-bars"><span>отображение нескольких прогрессбаров</span></a>, которые
обновляются независимо друг от друга и <a class="reference internal" href="components/console/helpers/table-ru.html#console-modify-rendered-tables"><span>добавление строк в таблицы</span></a>,
которые уже были выведены.</p>
</div>
</div>
<div class="section" id="id8">
<h2>Консоль ввода<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<p>Используйте опции или аргументы ввода, чтобы передать информацию в команду:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Console\Input\InputArgument</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">protected</span> <span class="k">function</span> <span class="nf">configure</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$this</span>
        <span class="c1">// создать аргумент</span>
        <span class="o">-&gt;</span><span class="na">addArgument</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="nx">InputArgument</span><span class="o">::</span><span class="na">REQUIRED</span><span class="p">,</span> <span class="s1">&#39;The username of the user.&#39;</span><span class="p">)</span>
        <span class="c1">// ...</span>
    <span class="p">;</span>
<span class="p">}</span>

<span class="c1">// ...</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">(</span><span class="nx">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="nx">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$output</span><span class="o">-&gt;</span><span class="na">writeln</span><span class="p">([</span>
        <span class="s1">&#39;User Creator&#39;</span><span class="p">,</span>
        <span class="s1">&#39;============&#39;</span><span class="p">,</span>
        <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="p">]);</span>

    <span class="c1">// получить значение аргумента, используя getArgument()</span>
    <span class="nv">$output</span><span class="o">-&gt;</span><span class="na">writeln</span><span class="p">(</span><span class="s1">&#39;Username: &#39;</span><span class="o">.</span><span class="nv">$input</span><span class="o">-&gt;</span><span class="na">getArgument</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>Теперь вы можете передать имя пользователя в команду:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> php bin/console app:create-user Wouter
<span class="go">User Creator</span>
<span class="go">============</span>

<span class="go">Username: Wouter</span>
</pre></div>
</td></tr></table></div></div>
<div class="admonition-wrapper">
<div class="seealso"></div><div class="admonition admonition-seealso">Смотрите <a class="reference internal" href="console\input.html"><em>Console Input (Arguments &amp; Options)</em></a>, чтобы узнать больше информации об опциях
и аргументах консоли.</div></div>
</div>
<div class="section" id="id9">
<h2>Получение сервисов и сервис-контейнера<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>Чтобы действительно создать нового пользователя, команда должна получить доступ
к некоторым <a class="reference internal" href="service_container.html"><em>сервисам</em></a>. Так как ваша команда уже зарегистрирована,
как сервис, вы можете использовать нормальное внедрение зависимости. Представьте,
что у вас есть сервис <tt class="docutils literal"><code>App\Service\UserManager</code></tt>, к которому вы хотите получить
доступ:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// ...</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Console\Command\Command</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Service\UserManager</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">CreateUserCommand</span> <span class="k">extends</span> <span class="nx">Command</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="nv">$userManager</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">UserManager</span> <span class="nv">$userManager</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">userManager</span> <span class="o">=</span> <span class="nv">$userManager</span><span class="p">;</span>

        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// ...</span>

    <span class="k">protected</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">(</span><span class="nx">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="nx">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">userManager</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nv">$input</span><span class="o">-&gt;</span><span class="na">getArgument</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">));</span>

        <span class="nv">$output</span><span class="o">-&gt;</span><span class="na">writeln</span><span class="p">(</span><span class="s1">&#39;User successfully generated!&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
</div>
<div class="section" id="id10">
<h2>Жизненный цикл команды<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<p>Команды имеют три метода жизненного цикла, которые активируются при
выполнении команды:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Command/Command.html#method_initialize" title="Symfony\Component\Console\Command\Command::initialize()">initialize()</a></code></tt> <em>(необязательный)</em></dt>
<dd>Этот метод выполняется до методов <tt class="docutils literal"><code>interact()</code></tt> и <tt class="docutils literal"><code>execute()</code></tt>. Его
главная цель - инициализировать переменные, используемые в других методах
команды.</dd>
<dt><tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Command/Command.html#method_interact" title="Symfony\Component\Console\Command\Command::interact()">interact()</a></code></tt> <em>(необязательный)</em></dt>
<dd>Этот метод выполняется после  <tt class="docutils literal"><code>initialize()</code></tt> и до <tt class="docutils literal"><code>execute()</code></tt>. Его
цель - проверка наличия всех опций/аргументов и спросить пользователя значения
в диалоговом режиме. Это последнее место, где вы можете запросить отсутствующие
опции/аргументы. После этой команды, отсутствующие опции/аргументы будут
приводить к ошибке.</dd>
<dt><tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Command/Command.html#method_execute" title="Symfony\Component\Console\Command\Command::execute()">execute()</a></code></tt> <em>(обязательный)</em></dt>
<dd>Этот метод выполняется после``interact()`` и <tt class="docutils literal"><code>initialize()</code></tt>. Он содержит
логику, которую вы хотите выполнить с помощью команды.</dd>
</dl>
</div>
<div class="section" id="console-testing-commands-ru">
<span id="id11"></span><h2>Тестирование команд<a class="headerlink" href="#console-testing-commands-ru" title="Permalink to this headline">¶</a></h2>
<p>Symfony предоставляет несколько инструментов, чтобы помочь вам тестировать
ваши команды. Самая полезная - это класс <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Tester/CommandTester.html" title="Symfony\Component\Console\Tester\CommandTester">CommandTester</a></code></tt>.
Он использует специальные классы ввода и вывода, чтобы облегчить тестирование
без настоящей консоли:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// tests/Command/CreateUserCommandTest.php</span>
<span class="k">namespace</span> <span class="nx">App\Tests\Command</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">App\Command\CreateUserCommand</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Bundle\FrameworkBundle\Console\Application</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Bundle\FrameworkBundle\Test\KernelTestCase</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Console\Tester\CommandTester</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">CreateUserCommandTest</span> <span class="k">extends</span> <span class="nx">KernelTestCase</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">testExecute</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$kernel</span> <span class="o">=</span> <span class="nx">self</span><span class="o">::</span><span class="na">bootKernel</span><span class="p">();</span>
        <span class="nv">$application</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Application</span><span class="p">(</span><span class="nv">$kernel</span><span class="p">);</span>

        <span class="nv">$application</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">CreateUserCommand</span><span class="p">());</span>

        <span class="nv">$command</span> <span class="o">=</span> <span class="nv">$application</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;app:create-user&#39;</span><span class="p">);</span>
        <span class="nv">$commandTester</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CommandTester</span><span class="p">(</span><span class="nv">$command</span><span class="p">);</span>
        <span class="nv">$commandTester</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;command&#39;</span>  <span class="o">=&gt;</span> <span class="nv">$command</span><span class="o">-&gt;</span><span class="na">getName</span><span class="p">(),</span>

            <span class="c1">// передать аргументы помощнику</span>
            <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Wouter&#39;</span><span class="p">,</span>

            <span class="c1">// добавить к ключу префикс с двумя дефисами при передаче опций,</span>
            <span class="c1">// например: &#39;--some-option&#39; =&gt; &#39;option_value&#39;,</span>
        <span class="p">));</span>

        <span class="c1">// вывод команды в консоли</span>
        <span class="nv">$output</span> <span class="o">=</span> <span class="nv">$commandTester</span><span class="o">-&gt;</span><span class="na">getDisplay</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertContains</span><span class="p">(</span><span class="s1">&#39;Username: Wouter&#39;</span><span class="p">,</span> <span class="nv">$output</span><span class="p">);</span>

        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<div class="admonition-wrapper">
<div class="tip"></div><div class="admonition admonition-tip"><p class="first admonition-title">Tip</p>
<p class="last">Вы также можете тестировать всю консоль приложения, используя
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Tester/ApplicationTester.html" title="Symfony\Component\Console\Tester\ApplicationTester">ApplicationTester</a></code></tt>.</p>
</div></div>
<div class="admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p class="last">При использовании компонена консоль в отдельностоящем проекте,
используйте класс
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Application.html" title="Symfony\Component\Console\Application">Symfony\Component\Console\Application</a></code></tt>
и расширьте нормальный <tt class="docutils literal"><code>\PHPUnit\Framework\TestCase</code></tt>.</p>
</div></div>
<p>Чтобы иметь возможность использовать полностью установленный сервис-контейнер
для тестов вашей консоли, вы можете расширить ваш тест из
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Bundle/FrameworkBundle/Test/KernelTestCase.html" title="Symfony\Bundle\FrameworkBundle\Test\KernelTestCase">KernelTestCase</a></code></tt>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// ...</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Console\Tester\CommandTester</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Bundle\FrameworkBundle\Console\Application</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Bundle\FrameworkBundle\Test\KernelTestCase</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">CreateUserCommandTest</span> <span class="k">extends</span> <span class="nx">KernelTestCase</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">testExecute</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$kernel</span> <span class="o">=</span> <span class="k">static</span><span class="o">::</span><span class="na">createKernel</span><span class="p">();</span>
        <span class="nv">$kernel</span><span class="o">-&gt;</span><span class="na">boot</span><span class="p">();</span>

        <span class="nv">$application</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Application</span><span class="p">(</span><span class="nv">$kernel</span><span class="p">);</span>

        <span class="nv">$command</span> <span class="o">=</span> <span class="nv">$application</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;app:create-user&#39;</span><span class="p">);</span>
        <span class="nv">$commandTester</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CommandTester</span><span class="p">(</span><span class="nv">$command</span><span class="p">);</span>
        <span class="nv">$commandTester</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;command&#39;</span>  <span class="o">=&gt;</span> <span class="nv">$command</span><span class="o">-&gt;</span><span class="na">getName</span><span class="p">(),</span>
            <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Wouter&#39;</span><span class="p">,</span>
        <span class="p">));</span>

        <span class="nv">$output</span> <span class="o">=</span> <span class="nv">$commandTester</span><span class="o">-&gt;</span><span class="na">getDisplay</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertContains</span><span class="p">(</span><span class="s1">&#39;Username: Wouter&#39;</span><span class="p">,</span> <span class="nv">$output</span><span class="p">);</span>

        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
</div>
<div class="section" id="id12">
<h2>Узнать больше<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="console\calling_commands.html">How to Call Other Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="console/calling_commands-ru.html">Как вызывать другие команды</a></li>
<li class="toctree-l1"><a class="reference internal" href="console\coloring.html">How to Color and Style the Console Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="console/coloring-ru.html">Как раскрашивать и стилизовать вывод консоли</a></li>
<li class="toctree-l1"><a class="reference internal" href="console\command_in_controller.html">How to Call a Command from a Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="console/command_in_controller-ru.html">Как вызвать команду из контроллера</a></li>
<li class="toctree-l1"><a class="reference internal" href="console\commands_as_services.html">How to Define Commands as Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="console/commands_as_services-ru.html">Как определять команды, как сервисы</a></li>
<li class="toctree-l1"><a class="reference internal" href="console\hide_commands.html">How to Hide Console Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="console/hide_commands-ru.html">Как скрывать консольные команды</a></li>
<li class="toctree-l1"><a class="reference internal" href="console\input.html">Console Input (Arguments &amp; Options)</a></li>
<li class="toctree-l1"><a class="reference internal" href="console/input-ru.html">Ввод консоли (аргументы и опции)</a></li>
<li class="toctree-l1"><a class="reference internal" href="console\lazy_commands.html">How to Make Commands Lazily Loaded</a></li>
<li class="toctree-l1"><a class="reference internal" href="console/lazy_commands-ru.html">Как сделать команды ленивой загрузки</a></li>
<li class="toctree-l1"><a class="reference internal" href="console\lockable_trait.html">Prevent Multiple Executions of a Console Command</a></li>
<li class="toctree-l1"><a class="reference internal" href="console/lockable_trait-ru.html">Предотвращение многократного выполения консольной команды</a></li>
<li class="toctree-l1"><a class="reference internal" href="console\request_context.html">How to Generate URLs from the Console</a></li>
<li class="toctree-l1"><a class="reference internal" href="console/request_context-ru.html">Как генерировать URL из консоли</a></li>
<li class="toctree-l1"><a class="reference internal" href="console\style.html">How to Style a Console Command</a></li>
<li class="toctree-l1"><a class="reference internal" href="console/style-ru.html">Как оформить консольную команду</a></li>
<li class="toctree-l1"><a class="reference internal" href="console\verbosity.html">Verbosity Levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="console/verbosity-ru.html">Уровни детализации</a></li>
</ul>
</div>
<p>Компонент консоль акже содержит набор &quot;помощников&quot; - разных маленьких
инструментов, способных помочь вам с разными заданиями:</p>
<ul class="simple">
<li><a class="reference internal" href="components\console\helpers\questionhelper.html"><em>Question Helper</em></a>: узнать у пользователя информацию в диалоговом режиме</li>
<li><a class="reference internal" href="components\console\helpers\formatterhelper.html"><em>Formatter Helper</em></a>: настроить расцвеичвание вывода</li>
<li><a class="reference internal" href="components\console\helpers\progressbar.html"><em>Progress Bar</em></a>: показать бар прогресса</li>
<li><a class="reference internal" href="components\console\helpers\table.html"><em>Table</em></a>: отобразить данные в табличной форме</li>
</ul>
</div>
</div>


            </div>

            

            <div id="license">
                <p>Эта документация является переводом <a href="http://symfony.com/doc/current/index.html">официальной документации Symfony</a> и предоставляется по свободной лицензии <a rel="license nofollow" href="https://creativecommons.org/licenses/by-sa/3.0/deed.ru">CC BY-SA 3.0</a>.</p>
            </div>
        </div>
    </div>
</div></div>


  </body>
</body></html>