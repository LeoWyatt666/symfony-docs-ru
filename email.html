<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    <title>Как отправить электронное письмо &mdash; Symfony Framework Documentation  documentation</title>
    
    <link rel="stylesheet" href="_static/" type="text/css">
    <link rel="stylesheet" href="_static\pygments.css" type="text/css">
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <link rel="top" title="Symfony Framework Documentation  documentation" href="index.html">

<link rel="stylesheet" href="_assets\app.css?v=8d6d457a0820d7c245bddae16bfd4c75">
<script src="_assets\manifest.js?v=d41d8cd98f00b204e980"></script>
<script src="_assets\app.js?v=900984040c7cb4dca514"></script>
<style>
    .header__top .container {
        overflow: hidden;
        padding-top: 10px;
        padding-bottom: 10px;
    }
    .header__top .header__logo {
        float: left;
    }
    .header__top .header__support {
        float: right;
    }

    .highlight .k, .highlight .gh, .highlight .gp,
    .highlight .gu, .highlight .kc, .highlight .kd,
    .highlight .kn, .highlight .kr, .highlight .nc,
    .highlight .nd, .highlight .ni, .highlight .nl,
    .highlight .nn, .highlight .nt, .highlight .ow,
    .highlight .se { font-weight: normal; }

    .highlight .c, .highlight .cm, .highlight .c1,
    .highlight .sd, .highlight .si { font-style: normal; }

    .doc { background: none; }
    #demo-warning {
        border: 3px dashed #c00;
        padding: 10px;
        margin-bottom: 30px;
    }
    #demo-warning h4 { font-size: 1.7em;font-weight: bold; }
    #demo-warning p { margin-bottom: 0; }
</style>

<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-107764519-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-107764519-1');
</script>

<!-- Facebook Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '250281335689441');
    fbq('track', 'PageView');
</script>
<img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=250281335689441&ev=PageView&noscript=1">
<!-- End Facebook Pixel Code -->

<script type="text/javascript">!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://vk.com/js/api/openapi.js?159",t.onload=function(){VK.Retargeting.Init("VK-RTRG-279161-8p6Jv"),VK.Retargeting.Hit()},document.head.appendChild(t)}();</script><img src="https://vk.com/rtrg?p=VK-RTRG-279161-8p6Jv" style="position:fixed; left:-999px;" alt="">


  </head>
  <body role="document">

<body class="email-r doc_article doc">

<header>
    <section class="header__top">
        <div class="container">
            <div class="header__logo">
                <a href="..\..\index.html">
                    <img src="..\..\_images\header-logo.svg" alt="Symfony.com.ua logo">
                </a>
            </div>
            <div class="header__support hidden-xs">
                <a href="http://playtini.ua/" title="Компания Playtini">
                    <img height="69" src="..\..\_images\support.png" alt="Symfony is a SensioLabs product">
                </a>
            </div>
        </div>
    </section>
</header>

<div class="container"><div id="page-content">
    <div class="row">
        <div id="sidebar" class="col-sm-3">
            <div id="sidebar-content"><div class="submenu">
    
    
    <ul class="list_submenu list-unstyled">
    
        <li class="first">
            <a href="index.html">Главная</a>
        </li>
    
        <li>
            <a href="components\index.html">Компоненты</a>
        </li>
    
        <li>
            <a href="best_practices\index.html">Лучшие практики</a>
        </li>
    
        <li>
            <a href="quick_tour\index.html">Быстрый старт</a>
        </li>
    
        <li>
            <a href="reference\index.html">Справочник</a>
        </li>
    
        <li>
            <a href="genindex.html">Индекс</a>
        </li>
    
        <li>
            <a href="contributing\index.html">Участие</a>
        </li>
    
    </ul>
</div>

                <div class="toc"> 
    <h4>Содержание</h4>
    <div class="toc-content">
        <ul>
<li><a class="reference internal" href="#">Как отправить электронное письмо</a><ul>
<li><a class="reference internal" href="#id2">Установка</a></li>
<li><a class="reference internal" href="#swift-mailer-configuration-ru">Конфигурация</a></li>
<li><a class="reference internal" href="#id4">Отправка писем</a></li>
<li><a class="reference internal" href="#gmail">Использование Gmail для отправки писем</a></li>
<li><a class="reference internal" href="#id5">Использование облачных сервисов для отправки писем</a></li>
<li><a class="reference internal" href="#id6">Узнать больше</a></li>
</ul>
</li>
</ul>

    </div>
</div>
                
            </div>

            <div class="ads m-b-30">
                <h2>Вакансии Playtini</h2>
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/php-dev">
                            Middle+ PHP Developer/Symfony
                        </a>
                    </h3>
                    <div><b>Playtini</b> активно поддерживает и развивает свои продукты, и профессионализм команды. И на данный момент в поиске специалиста на позицию <b>«Middle+ PHP Developer/Symfony»,</b> который улучшит качество внутренних сервисов компании и увеличит их количество.</div>
                </div>
                <!--
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/symfony-senior">
                            Senior PHP Developer/Symfony
                        </a>
                    </h3>
                    <div>We are looking for strong, experienced <b>Senior PHP Developer/Symfony.</b> We expect him/her to participate in improving and extending a system built using microservice architecture by means of modern technologies.</div>
                </div>
                -->
                <div class="ad">
                    <h3><a href="http://playtini.ua/careers">
                        Остальные вакансии компании
                        <img src="..\..\_images\logo-playtini.png" alt="Playtini">
                    </a></h3>
                </div>
            </div>
        </div>

        <div id="main" class="col-sm-9">
            <ol class="breadcrumb">
                
                <li><a href="index.html">Документация</a></li>
                
                <li class="active">Как отправить электронное письмо</li>
            </ol>

            <div class="page">
                
  <div class="section" id="index-0">
<span id="id1"></span><h1>Как отправить электронное письмо<a class="headerlink" href="#index-0" title="Permalink to this headline">¶</a></h1>
<p>Symfony предоставляет почтовую функцию, основанную на популярной библиотеке
<a class="reference external" href="http://swiftmailer.org/">Swift Mailer</a> через <a class="reference external" href="https://github.com/symfony/swiftmailer-bundle">SwiftMailerBundle</a>. Этот почтовый сервис поддерживает
отправку сообщений с вашими собственными почтовыми серверами, а также с
использованием поплулярных провайдеров почтового сервиса, вроде <a class="reference external" href="https://mandrill.com/">Mandrill</a>,
<a class="reference external" href="https://sendgrid.com/">SendGrid</a>, и <a class="reference external" href="http://aws.amazon.com/ses/">Amazon SES</a>.</p>
<div class="section" id="id2">
<h2>Установка<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>В приложениях, использующих <a class="reference internal" href="setup\flex.html"><em>Symfony Flex</em></a>, запустите эту
команду, чтобы установить почтовый сервис, основанный на Swift Mailer, до того,
как его использовать:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> composer require mailer
</pre></div>
</td></tr></table></div></div>
<p>Если ваше приложение не использует Symfony Flex, следуйте инструкциям по
установке на <a class="reference external" href="https://github.com/symfony/swiftmailer-bundle">SwiftMailerBundle</a>.</p>
</div>
<div class="section" id="swift-mailer-configuration-ru">
<span id="id3"></span><h2>Конфигурация<a class="headerlink" href="#swift-mailer-configuration-ru" title="Permalink to this headline">¶</a></h2>
<p>Файл <tt class="docutils literal"><code>config/packages/swiftmailer.yaml</code></tt>, который создаётся при установке почтовой
программы, предоставляет всю изначальную конфигурацию, необходимую для отправки писем,
кроме деталей соединения с вашим почтовым сервером. Эти параметры определяются в
переменной окружения <tt class="docutils literal"><code>MAILER_URL</code></tt> в файле <tt class="docutils literal"><code>.env</code></tt>:</p>
<div class="literal-block"><div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># используйте это, чтобы отключить доставку писем</span>
<span class="nv">MAILER_URL</span><span class="o">=</span>null://localhost

<span class="c1"># используйте это, чтобы сконфигурировать традиционный SMTP-сервер</span>
<span class="nv">MAILER_URL</span><span class="o">=</span>smtp://localhost:25?encryption<span class="o">=</span>ssl<span class="p">&amp;</span><span class="nv">auth_mode</span><span class="o">=</span>login<span class="p">&amp;</span><span class="nv">username</span><span class="o">=</span><span class="p">&amp;</span><span class="nv">password</span><span class="o">=</span>
</pre></div>
</td></tr></table></div></div>
<p>Обратитесь к <a class="reference internal" href="reference\configuration\swiftmailer.html"><em>справочнику конфигурации SwiftMailer</em></a>,
чтобы увидеть детальное объяснение всех доступных опций конфигурации.</p>
</div>
<div class="section" id="id4">
<h2>Отправка писем<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>Библиотека Swift Mailer работает путем создания, конфигурации и последующей
отправки объектов <tt class="docutils literal"><code>Swift_Message</code></tt>. &quot;Отправщик&quot; ответственнен за действительную
доставку сообщения и к нему можно получить доступ через сервис <tt class="docutils literal"><code>Swift_Mailer</code></tt>.
В общем, отправка электронного письма достаточно прямолинейна:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nx">\Swift_Mailer</span> <span class="nv">$mailer</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$message</span> <span class="o">=</span> <span class="p">(</span><span class="k">new</span> <span class="nx">\Swift_Message</span><span class="p">(</span><span class="s1">&#39;Hello Email&#39;</span><span class="p">))</span>
        <span class="o">-&gt;</span><span class="na">setFrom</span><span class="p">(</span><span class="s1">&#39;<a href="..\..\cdn-cgi\l\email-protection.html" class="__cf_email__" data-cfemail="1b687e757f5b7e637a766b777e35787476">[email&#160;protected]</a>&#39;</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">setTo</span><span class="p">(</span><span class="s1">&#39;<a href="..\..\cdn-cgi\l\email-protection.html" class="__cf_email__" data-cfemail="86f4e3e5eff6efe3e8f2c6e3fee7ebf6eae3a8e5e9eb">[email&#160;protected]</a>&#39;</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">setBody</span><span class="p">(</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">renderView</span><span class="p">(</span>
                <span class="c1">// templates/emails/registration.html.twig</span>
                <span class="s1">&#39;emails/registration.html.twig&#39;</span><span class="p">,</span>
                <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">)</span>
            <span class="p">),</span>
            <span class="s1">&#39;text/html&#39;</span>
        <span class="p">)</span>
        <span class="cm">/*</span>
<span class="cm">         * Если вы также хотите включить в сообщение версию обычного текста</span>
<span class="cm">        -&gt;addPart(</span>
<span class="cm">            $this-&gt;renderView(</span>
<span class="cm">                &#39;emails/registration.txt.twig&#39;,</span>
<span class="cm">                array(&#39;name&#39; =&gt; $name)</span>
<span class="cm">            ),</span>
<span class="cm">            &#39;text/plain&#39;</span>
<span class="cm">        )</span>
<span class="cm">        */</span>
    <span class="p">;</span>

    <span class="nv">$mailer</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span><span class="nv">$message</span><span class="p">);</span>

    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span><span class="o">...</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>Чтобы все было раздельно, тело письма было сохранено в щаблоне и отображено
с помощью метода <tt class="docutils literal"><code>renderView()</code></tt>. Шаблон <tt class="docutils literal"><code>registration.html.twig</code></tt> может
выглядеть как-то так:</p>
<div class="literal-block"><div class="highlight-html+jinja"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">{# templates/emails/registration.html.twig #}</span>
<span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Вы сделали это! Вы зарегистрировались!<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>

Привет, <span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}</span>! Вы успешно зарегистрировались.

<span class="c">{# пример, предполагающий, что у вас есть маршрут под названием &quot;login&quot; #}</span>
Чтобы выполнить вход, перейдите по: <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">url</span><span class="o">(</span><span class="s1">&#39;login&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="p">&gt;</span>...<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>.

Спасибо!

<span class="c">{# Создаёт абсолютный URL к файлу /images/logo.png #}</span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">absolute_url</span><span class="o">(</span><span class="nv">asset</span><span class="o">(</span><span class="s1">&#39;images/logo.png&#39;</span><span class="o">))</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div></div>
<p>Объект <tt class="docutils literal"><code>$message</code></tt> поддерживает больше опций, таких как добавление вложений,
добавление HTML-содержимого и многое другое. Обратитесь к разделу <a class="reference external" href="http://swiftmailer.org/docs/messages.html">Создание сообщений</a>
документации Swift Mailer, чтобы узнать больше.</p>
</div>
<div class="section" id="gmail">
<span id="email-using-gmail-ru"></span><h2>Использование Gmail для отправки писем<a class="headerlink" href="#gmail" title="Permalink to this headline">¶</a></h2>
<p>Во время разработки, вы можете предпочесть отправлять письма, используя Gmail
вместо установки обычного SMTP-сервера. Чтобы сделать это, обновите <tt class="docutils literal"><code>MAILER_URL</code></tt>
вашего файла <tt class="docutils literal"><code>.env</code></tt> до следующего:</p>
<div class="literal-block"><div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># имя пользователя - ваш полный почтовый адрес Gmail или Google Apps</span>
<span class="nv">MAILER_URL</span><span class="o">=</span>gmail://username:<a href="..\..\cdn-cgi\l\email-protection.html" class="__cf_email__" data-cfemail="3d4d5c4e4e4a524f597d51525e5c5155524e49">[email&#160;protected]</a>
</pre></div>
</td></tr></table></div></div>
<p>Транспорт <tt class="docutils literal"><code>gmail</code></tt> это просто сокращение, которое использует транспорт <tt class="docutils literal"><code>smtp</code></tt>,
шифрование <tt class="docutils literal"><code>ssl</code></tt>, режим авторизации``login`` и хост <tt class="docutils literal"><code>smtp.gmail.com</code></tt>. Если ваше
приложение использует другое шифрование или режим авторизации, вам нужно переопределить
эти значения (<a class="reference internal" href="reference\configuration\swiftmailer.html"><em>см. справочник конфигурации почтовой программы</em></a>):</p>
<div class="literal-block"><div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># имя пользователя - ваш полный почтовый адрес Gmail или Google Apps</span>
<span class="nv">MAILER_URL</span><span class="o">=</span>gmail://username:<a href="..\..\cdn-cgi\l\email-protection.html" class="__cf_email__" data-cfemail="3c4c5d4f4f4b534e587c50535f5d5054534f48">[email&#160;protected]</a>?encryption<span class="o">=</span>tls<span class="p">&amp;</span><span class="nv">auth_mode</span><span class="o">=</span>oauth
</pre></div>
</td></tr></table></div></div>
<p>Если ваша учётная запись Gmail использует двухшаговую верификацию, вы должны
<a class="reference external" href="https://support.google.com/accounts/answer/185833">сгенерировать пароль приложения</a> и использовать его в качестве значения пароля
почтовой программы. Вы также должны гарантировать, что вы
<a class="reference external" href="https://support.google.com/accounts/answer/6010255">позволяете менее безопасным программам получать доступ к вашей учётной записи Gmail</a>.</p>
</div>
<div class="section" id="id5">
<h2>Использование облачных сервисов для отправки писем<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>Облачные почтовые сервисы являются популярной опцией для компаний, которые не
хотят устанавливать и содержать собственные надёжные почтовые серверы. В приложениях
Symfony, исползование таких сервисов так же просто, как обновление значения
<tt class="docutils literal"><code>MAILER_URL</code></tt> в файле <tt class="docutils literal"><code>.env</code></tt>. Например, для <a class="reference external" href="http://aws.amazon.com/ses/">Amazon SES</a> (Simple Email Service):</p>
<div class="literal-block"><div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># TХост будет отличаться, в зависимости от вашей зоны AWS</span>
<span class="c1"># Сертификаты имени пользователя / пароля добываются из консоли Amazon SES</span>
<span class="nv">MAILER_URL</span><span class="o">=</span>smtp://email-smtp.us-east-1.amazonaws.com:587?encryption<span class="o">=</span>tls<span class="p">&amp;</span><span class="nv">username</span><span class="o">=</span>YOUR_SES_USERNAME<span class="p">&amp;</span><span class="nv">password</span><span class="o">=</span>YOUR_SES_PASSWORD
</pre></div>
</td></tr></table></div></div>
<p>Используйте ту же технику для всех других почтовых сервисов, так как в большинстве
случаев, не требуется ничего, кроме конфигурации конечной точки SMTP.</p>
</div>
<div class="section" id="id6">
<h2>Узнать больше<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="email\dev_environment.html">How to Work with Emails during Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="email/dev_environment-ru.html">Как работать с электронными письмами во время разработки</a></li>
<li class="toctree-l1"><a class="reference internal" href="email\spool.html">How to Spool Emails</a></li>
<li class="toctree-l1"><a class="reference internal" href="email/spool-ru.html">Как спулить электронные письма</a></li>
<li class="toctree-l1"><a class="reference internal" href="email\testing.html">How to Test that an Email is Sent in a Functional Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="email/testing-ru.html">Как протестировать, было ли отправлено электронное письмо в функциональном тесте</a></li>
</ul>
</div>
</div>
</div>


            </div>

            

            <div id="license">
                <p>Эта документация является переводом <a href="http://symfony.com/doc/current/index.html">официальной документации Symfony</a> и предоставляется по свободной лицензии <a rel="license nofollow" href="https://creativecommons.org/licenses/by-sa/3.0/deed.ru">CC BY-SA 3.0</a>.</p>
            </div>
        </div>
    </div>
</div></div>


  <script data-cfasync="false" src="..\..\cdn-cgi\scripts\5c5dd728\cloudflare-static\email-decode.min.js"></script></body>
</body></html>