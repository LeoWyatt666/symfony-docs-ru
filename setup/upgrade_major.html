<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    <title>Обновление полноценной версии (например, с 2.7.0 до 3.0.0) &mdash; Symfony Framework Documentation  documentation</title>
    
    <link rel="stylesheet" href="../_static/" type="text/css">
    <link rel="stylesheet" href="..\_static\pygments.css" type="text/css">
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <link rel="top" title="Symfony Framework Documentation  documentation" href="..\index.html">
    <link rel="up" title="Installing &amp; Setting up the Symfony Framework" href="..\setup.html">
    <link rel="next" title="Upgrading a Minor Version (e.g. 3.3.3 to 3.4.0)" href="upgrade_minor.html">
    <link rel="prev" title="Upgrading a Major Version (e.g. 3.4.0 to 4.1.0)" href="upgrade_major.html">

<link rel="stylesheet" href="..\_assets\app.css?v=8d6d457a0820d7c245bddae16bfd4c75">
<script src="..\_assets\manifest.js?v=d41d8cd98f00b204e980"></script>
<script src="..\_assets\app.js?v=900984040c7cb4dca514"></script>
<style>
    .header__top .container {
        overflow: hidden;
        padding-top: 10px;
        padding-bottom: 10px;
    }
    .header__top .header__logo {
        float: left;
    }
    .header__top .header__support {
        float: right;
    }

    .highlight .k, .highlight .gh, .highlight .gp,
    .highlight .gu, .highlight .kc, .highlight .kd,
    .highlight .kn, .highlight .kr, .highlight .nc,
    .highlight .nd, .highlight .ni, .highlight .nl,
    .highlight .nn, .highlight .nt, .highlight .ow,
    .highlight .se { font-weight: normal; }

    .highlight .c, .highlight .cm, .highlight .c1,
    .highlight .sd, .highlight .si { font-style: normal; }

    .doc { background: none; }
    #demo-warning {
        border: 3px dashed #c00;
        padding: 10px;
        margin-bottom: 30px;
    }
    #demo-warning h4 { font-size: 1.7em;font-weight: bold; }
    #demo-warning p { margin-bottom: 0; }
</style>

<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-107764519-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-107764519-1');
</script>

<!-- Facebook Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '250281335689441');
    fbq('track', 'PageView');
</script>
<img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=250281335689441&ev=PageView&noscript=1">
<!-- End Facebook Pixel Code -->

<script type="text/javascript">!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://vk.com/js/api/openapi.js?159",t.onload=function(){VK.Retargeting.Init("VK-RTRG-279161-8p6Jv"),VK.Retargeting.Hit()},document.head.appendChild(t)}();</script><img src="https://vk.com/rtrg?p=VK-RTRG-279161-8p6Jv" style="position:fixed; left:-999px;" alt="">


  </head>
  <body role="document">

<body class="setup doc_article doc">

<header>
    <section class="header__top">
        <div class="container">
            <div class="header__logo">
                <a href="..\..\..\index.html">
                    <img src="..\..\..\_images\header-logo.svg" alt="Symfony.com.ua logo">
                </a>
            </div>
            <div class="header__support hidden-xs">
                <a href="http://playtini.ua/" title="Компания Playtini">
                    <img height="69" src="..\..\..\_images\support.png" alt="Symfony is a SensioLabs product">
                </a>
            </div>
        </div>
    </section>
</header>

<div class="container"><div id="page-content">
    <div class="row">
        <div id="sidebar" class="col-sm-3">
            <div id="sidebar-content"><div class="submenu">
    
    
    <ul class="list_submenu list-unstyled">
    
        <li class="first">
            <a href="..\index.html">Главная</a>
        </li>
    
        <li>
            <a href="..\components\index.html">Компоненты</a>
        </li>
    
        <li>
            <a href="..\best_practices\index.html">Лучшие практики</a>
        </li>
    
        <li>
            <a href="..\quick_tour\index.html">Быстрый старт</a>
        </li>
    
        <li>
            <a href="..\reference\index.html">Справочник</a>
        </li>
    
        <li>
            <a href="..\genindex.html">Индекс</a>
        </li>
    
        <li>
            <a href="..\contributing\index.html">Участие</a>
        </li>
    
    </ul>
</div>

                <div class="toc"> 
    <h4>Содержание</h4>
    <div class="toc-content">
        <ul>
<li><a class="reference internal" href="#">Обновление полноценной версии (например, с 2.7.0 до 3.0.0)</a><ul>
<li><a class="reference internal" href="#upgrade-major-symfony-deprecations-ru">1) Избавить ваш код от возражений</a><ul>
<li><a class="reference internal" href="#phpunit">Возражения в PHPUnit</a></li>
</ul>
</li>
<li><a class="reference internal" href="#composer">2) Обновить до новой полноценной версии через Composer</a><ul>
<li><a class="reference internal" href="#dependency-errors">Dependency Errors</a></li>
<li><a class="reference internal" href="#upgrading-other-packages">Upgrading other Packages</a></li>
</ul>
</li>
<li><a class="reference internal" href="#upgrade-major-symfony-after-ru">3) Обновить ваш код, чтобы он работал с новой версией</a></li>
</ul>
</li>
</ul>

    </div>
</div>
                
            </div>

            <div class="ads m-b-30">
                <h2>Вакансии Playtini</h2>
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/php-dev">
                            Middle+ PHP Developer/Symfony
                        </a>
                    </h3>
                    <div><b>Playtini</b> активно поддерживает и развивает свои продукты, и профессионализм команды. И на данный момент в поиске специалиста на позицию <b>«Middle+ PHP Developer/Symfony»,</b> который улучшит качество внутренних сервисов компании и увеличит их количество.</div>
                </div>
                <!--
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/symfony-senior">
                            Senior PHP Developer/Symfony
                        </a>
                    </h3>
                    <div>We are looking for strong, experienced <b>Senior PHP Developer/Symfony.</b> We expect him/her to participate in improving and extending a system built using microservice architecture by means of modern technologies.</div>
                </div>
                -->
                <div class="ad">
                    <h3><a href="http://playtini.ua/careers">
                        Остальные вакансии компании
                        <img src="..\..\..\_images\logo-playtini.png" alt="Playtini">
                    </a></h3>
                </div>
            </div>
        </div>

        <div id="main" class="col-sm-9">
            <ol class="breadcrumb">
                
                <li><a href="..\index.html">Документация</a></li>
                
                <li><a href="..\getting_started\index.html">Getting Started</a></li>
                
                <li><a href="..\setup.html">Installing &amp; Setting up the Symfony Framework</a></li>
                
                <li class="active">Обновление полноценной версии (например, с 2.7.0 до 3.0.0)</li>
            </ol>

            <div class="page">
                
  <div class="section" id="index-0">
<span id="id1"></span><h1>Обновление полноценной версии (например, с 2.7.0 до 3.0.0)<a class="headerlink" href="#index-0" title="Permalink to this headline">¶</a></h1>
<p>Каждые два года Symfony выпускает новую полноценную версию (меняется первая
цифра). Эти релизы самые сложные в обновлении, так как им разрешено нарушать
обратную совместимость. Однако, Symfony делает так, чтобы процесс обновления
прошёл как можно более гладко.</p>
<p>Это означает, что вы можете обновить большую часть вашего кода до того, как
полноценная версия на самом деле будет выпущена. Это называется делать ваш
код <em>совместимым с будущим</em>.</p>
<p>В обновлении полноценной версии существует несколько шагов:</p>
<ol class="arabic simple">
<li><a class="reference internal" href="upgrade_major.html#upgrade-major-symfony-deprecations"><span>Избавить ваш код от возражений</span></a>;</li>
<li><a class="reference internal" href="upgrade_major.html#upgrade-major-symfony-composer"><span>Обновить до новой полноценной версии через Composer</span></a>;</li>
<li><a class="reference internal" href="upgrade_major.html#upgrade-major-symfony-after"><span>Обновить ваш код, чтобы он работал с новой версией</span></a>.</li>
</ol>
<div class="section" id="upgrade-major-symfony-deprecations-ru">
<span id="id2"></span><h2>1) Избавить ваш код от возражений<a class="headerlink" href="#upgrade-major-symfony-deprecations-ru" title="Permalink to this headline">¶</a></h2>
<p>Во время жизненного релиза полноценного релиза, добавляются новые функции, а
подписи методов и использование публичных API изменяются. Однако,
<a class="reference internal" href="upgrade_minor.html"><em>упрощённые версии</em></a> не должны содержать никаких
изменений обратной совместимости. Чтобы добиться этого, &quot;старый&quot; код (например,
функции, классы и т.д.) всё ещё будет работать, но будет помечен как <em>осуждённый</em>,
обозначая, что он будет удалён или изменён в будущем, и что вам стоит перестать
его использовать.</p>
<p>Когда выпускается полноценная версия (например, 3.0.0), все осуждённые функции
и особенности удаляются. Так что, если вы обновили ваш код так, чтобы он перестал
использовать такие функции в последней версии перед полноценной (например, в 2.8.*),
у вас не должно возникнуть проблем с обновлением.</p>
<p>Чтобы помочь вам в этом, пометки возражения запускаются каждый раз, когда вы
используете осуждённую функцю. Когда вы посещаете ваше приложение в
<a class="reference internal" href="..\configuration\environments.html"><em>окружении разработки</em></a> вашего браузера, эти
пометки отображаются в панели инструментов веб-разработки:</p>
<img alt="../_images/deprecations-in-profiler.png" class="with-browser align-center" src="..\_images\deprecations-in-profiler.png">
<p>В конце-концов, вы захотите перестать использовать осуждённую функциональность.
Иногда это просто: предупреждение может сказать вам о том, что именно нужно
изменить.</p>
<p>Но в других ситуациях предупреждение может быть туманным: установка где-то
может вызвать более глубокий класс вызвать предупреждение. В этом случае
Symfony старается как можно чётче сформулировать сообщение, но возможно вы
захотите глубже исследовать такое предупреждение.</p>
<p>А иногда предупреждение может поступать от сторонней библиотеки или пакета,
которые вы используете. Если это так, то существует высокая вероятность, что
такие возражения уже были обновлены. В таком случае, обновите библиотеку,
чтобы исправить их.</p>
<p>Как только исчезнут все предупреждения о возражениях, вы можете обновляться
с наибольшей уверенностью.</p>
<div class="section" id="phpunit">
<h3>Возражения в PHPUnit<a class="headerlink" href="#phpunit" title="Permalink to this headline">¶</a></h3>
<p>Когда вы выполняете ваши тесты, используя PHPUnit, сообщения о возражениях не
отображаются. Чтобы помочь вам в этом, Symfony предоставляет мост PHPUnit.
Этот мост покажет вам удобное резюме всех сообщений о возражениях в конце
тестовго отчёта.</p>
<p>Всё, что вам нужно - это установить мост PHPUnit:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> composer require --dev symfony/phpunit-bridge
</pre></div>
</td></tr></table></div></div>
<p>Теперь вы можете начать исправлять сообщения:</p>
<div class="literal-block"><div class="highlight-text"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ phpunit
...

OK (10 тестов, 20 утверждений)

Оставшиеся сообщения о возражениях (6)

Сервис &quot;запроса&quot; (&quot;request&quot;) вызывает возражение и будет удалён в версии 3.0.
Добавьте типизирование для Symfony\Component\HttpFoundation\Request в параметры
вашего контроллера, чтобы вместо этого вернуть запрос: 6x
    3x in PageAdminTest::testPageShow from Symfony\Cmf\SimpleCmsBundle\Tests\WebTest\Admin
    2x in PageAdminTest::testPageList from Symfony\Cmf\SimpleCmsBundle\Tests\WebTest\Admin
    1x in PageAdminTest::testPageEdit from Symfony\Cmf\SimpleCmsBundle\Tests\WebTest\Admin
</pre></div>
</td></tr></table></div></div>
<p>Как только вы исправите всё, команда окончится <tt class="docutils literal"><code>0</code></tt> (успех) и вы закончили!</p>
<div class="admonition-wrapper">
<div class="sidebar"></div><div class="admonition admonition-sidebar"><p class="first sidebar-title">Исползование режима слабых возражений</p>
<p>Иногда вам не удастся исправить все возражения (например, что-то вызвало
возражение в версии 2.8, а вам всё еще нужна поддержка версии 2.7). В таких
случаях, вы всё равно можете использовать мост для исправления как можно
наибольшего количества возражений, а потом переключиться в режим слабого
тестирования, чтобы заставить ваши тесты снова пройти. Вы можете сделать это,
используя переменную <tt class="docutils literal"><code>SYMFONY_DEPRECATIONS_HELPER</code></tt>:</p>
<div class="literal-block"><div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">&lt;!-- phpunit.xml.dist --&gt;</span>
<span class="nt">&lt;phpunit&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>

    <span class="nt">&lt;php&gt;</span>
        <span class="nt">&lt;env</span> <span class="na">name=</span><span class="s">&quot;SYMFONY_DEPRECATIONS_HELPER&quot;</span> <span class="na">value=</span><span class="s">&quot;weak&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/php&gt;</span>
<span class="nt">&lt;/phpunit&gt;</span>
</pre></div>
</td></tr></table></div></div>
<p class="last">(Вы также можете выполнить команду так: <tt class="docutils literal"><code>SYMFONY_DEPRECATIONS_HELPER=weak phpunit</code></tt>).</p>
</div></div>
<div class="admonition-wrapper">
<div class="tip"></div><div class="admonition admonition-tip"><p class="first admonition-title">Tip</p>
<p class="last">Некоторые члены сообщества Symfony разработали инструмент под названием
<a class="reference external" href="https://github.com/umpirsky/Symfony-Upgrade-Fixer">Symfony-Upgrade-Fixer</a>, который автоматически исправляет некоторые из
самых распространённых возражений, обнаруженным при обновлении с Symfony
2 до Symfony 3.</p>
</div></div>
</div>
</div>
<div class="section" id="composer">
<span id="upgrade-major-symfony-composer-ru"></span><h2>2) Обновить до новой полноценной версии через Composer<a class="headerlink" href="#composer" title="Permalink to this headline">¶</a></h2>
<p>Когда ваш код будет избавлен от возражений, вы можете обновить библиотеку
Symfony через Composer, модифицировав ваш файл <tt class="docutils literal"><code>composer.json</code></tt>:</p>
<div class="literal-block"><div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;...&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>

    <span class="nt">&quot;require&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;symfony/symfony&quot;</span><span class="p">:</span> <span class="s2">&quot;3.0.*&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="nt">&quot;...&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>Далее, используйте Composer, чтобы скачать новые версии билиотек:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> composer update symfony/symfony
</pre></div>
</td></tr></table></div></div>
<div class="section" id="dependency-errors">
<h3>Dependency Errors<a class="headerlink" href="#dependency-errors" title="Permalink to this headline">¶</a></h3>
<p>If you get a dependency error, it may simply mean that you need to upgrade
other Symfony dependencies too. In that case, try the following command:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> composer update symfony/symfony --with-dependencies
</pre></div>
</td></tr></table></div></div>
<p>This updates <tt class="docutils literal"><code>symfony/symfony</code></tt> and <em>all</em> packages that it depends on, which will
include several other packages. By using tight version constraints in
<tt class="docutils literal"><code>composer.json</code></tt>, you can control what versions each library upgrades to.</p>
<p>If this still doesn't work, your <tt class="docutils literal"><code>composer.json</code></tt> file may specify a version
for a library that is not compatible with the newer Symfony version. In that
case, updating that library to a newer version in <tt class="docutils literal"><code>composer.json</code></tt> may solve
the issue.</p>
<p>Or, you may have deeper issues where different libraries depend on conflicting
versions of other libraries. Check your error message to debug.</p>
<p>Another issue that may happen is that the project dependencies can be installed
in your local computer but not on the remote server. This usually happens when
the PHP versions are different on each machine. The solution is to add the
<a class="reference external" href="https://getcomposer.org/doc/06-config.md#platform">platform</a> config option in your <cite>composer.json</cite> file to define the highest
PHP version allowed for the dependencies (set it to server's PHP version).</p>
</div>
<div class="section" id="upgrading-other-packages">
<h3>Upgrading other Packages<a class="headerlink" href="#upgrading-other-packages" title="Permalink to this headline">¶</a></h3>
<p>You may also want to upgrade the rest of your libraries. If you've done a
good job with your <a class="reference external" href="https://getcomposer.org/doc/01-basic-usage.md#package-versions">version constraints</a> in <tt class="docutils literal"><code>composer.json</code></tt>, you can do
this safely by running:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> composer update
</pre></div>
</td></tr></table></div></div>
<div class="admonition-wrapper">
<div class="caution"></div><div class="admonition admonition-caution"><p class="first admonition-title">Caution</p>
<p class="last">Beware, if you have some unspecific <a class="reference external" href="https://getcomposer.org/doc/01-basic-usage.md#package-versions">version constraints</a> in your
<tt class="docutils literal"><code>composer.json</code></tt> (e.g. <tt class="docutils literal"><code>dev-master</code></tt>), this could upgrade some
non-Symfony libraries to new versions that contain backwards-compatibility
breaking changes.</p>
</div></div>
</div>
</div>
<div class="section" id="upgrade-major-symfony-after-ru">
<span id="id3"></span><h2>3) Обновить ваш код, чтобы он работал с новой версией<a class="headerlink" href="#upgrade-major-symfony-after-ru" title="Permalink to this headline">¶</a></h2>
<p>Существует неплохой шанс того, что вы уже закончили! Однако, следующая
полноценная версия <em>может</em> тоже содержать новые нарушения обратной совместимости,
так как уровень обратной совместимости не всегда возможен. Обязательно прочитайте
<tt class="docutils literal"><code>UPGRADE-X.0.md</code></tt> (где X - это новая полноценная версия), включённый в хранилище
Symfony, чтобы узнать о любом нарушении обратной совместимости.</p>
</div>
</div>


            </div>

            
            <div class="navigation">
                <a href="upgrade_major.html">« Upgrading a Major Version (e.g. 3.4.0 to 4.1.0)</a>
                <span class="separator">|</span>
                <a href="upgrade_minor.html">Upgrading a Minor Version (e.g. 3.3.3 to 3.4.0) »</a>
            </div>
            

            <div id="license">
                <p>Эта документация является переводом <a href="http://symfony.com/doc/current/index.html">официальной документации Symfony</a> и предоставляется по свободной лицензии <a rel="license nofollow" href="https://creativecommons.org/licenses/by-sa/3.0/deed.ru">CC BY-SA 3.0</a>.</p>
            </div>
        </div>
    </div>
</div></div>


  </body>
</body></html>