<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    <title>Установка или исправление разрешений файлов &mdash; Symfony Framework Documentation  documentation</title>
    
    <link rel="stylesheet" href="../_static/" type="text/css">
    <link rel="stylesheet" href="..\_static\pygments.css" type="text/css">
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <link rel="top" title="Symfony Framework Documentation  documentation" href="..\index.html">
    <link rel="up" title="Installing &amp; Setting up the Symfony Framework" href="..\setup.html">
    <link rel="next" title="Using Symfony Flex to Manage Symfony Applications" href="flex.html">
    <link rel="prev" title="Setting up or Fixing File Permissions" href="file_permissions.html">

<link rel="stylesheet" href="..\_assets\app.css?v=8d6d457a0820d7c245bddae16bfd4c75">
<script src="..\_assets\manifest.js?v=d41d8cd98f00b204e980"></script>
<script src="..\_assets\app.js?v=900984040c7cb4dca514"></script>
<style>
    .header__top .container {
        overflow: hidden;
        padding-top: 10px;
        padding-bottom: 10px;
    }
    .header__top .header__logo {
        float: left;
    }
    .header__top .header__support {
        float: right;
    }

    .highlight .k, .highlight .gh, .highlight .gp,
    .highlight .gu, .highlight .kc, .highlight .kd,
    .highlight .kn, .highlight .kr, .highlight .nc,
    .highlight .nd, .highlight .ni, .highlight .nl,
    .highlight .nn, .highlight .nt, .highlight .ow,
    .highlight .se { font-weight: normal; }

    .highlight .c, .highlight .cm, .highlight .c1,
    .highlight .sd, .highlight .si { font-style: normal; }

    .doc { background: none; }
    #demo-warning {
        border: 3px dashed #c00;
        padding: 10px;
        margin-bottom: 30px;
    }
    #demo-warning h4 { font-size: 1.7em;font-weight: bold; }
    #demo-warning p { margin-bottom: 0; }
</style>

<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-107764519-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-107764519-1');
</script>

<!-- Facebook Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '250281335689441');
    fbq('track', 'PageView');
</script>
<img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=250281335689441&ev=PageView&noscript=1">
<!-- End Facebook Pixel Code -->

<script type="text/javascript">!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://vk.com/js/api/openapi.js?159",t.onload=function(){VK.Retargeting.Init("VK-RTRG-279161-8p6Jv"),VK.Retargeting.Hit()},document.head.appendChild(t)}();</script><img src="https://vk.com/rtrg?p=VK-RTRG-279161-8p6Jv" style="position:fixed; left:-999px;" alt="">


  </head>
  <body role="document">

<body class="setup doc_article doc">

<header>
    <section class="header__top">
        <div class="container">
            <div class="header__logo">
                <a href="..\..\..\index.html">
                    <img src="..\..\..\_images\header-logo.svg" alt="Symfony.com.ua logo">
                </a>
            </div>
            <div class="header__support hidden-xs">
                <a href="http://playtini.ua/" title="Компания Playtini">
                    <img height="69" src="..\..\..\_images\support.png" alt="Symfony is a SensioLabs product">
                </a>
            </div>
        </div>
    </section>
</header>

<div class="container"><div id="page-content">
    <div class="row">
        <div id="sidebar" class="col-sm-3">
            <div id="sidebar-content"><div class="submenu">
    
    
    <ul class="list_submenu list-unstyled">
    
        <li class="first">
            <a href="..\index.html">Главная</a>
        </li>
    
        <li>
            <a href="..\components\index.html">Компоненты</a>
        </li>
    
        <li>
            <a href="..\best_practices\index.html">Лучшие практики</a>
        </li>
    
        <li>
            <a href="..\quick_tour\index.html">Быстрый старт</a>
        </li>
    
        <li>
            <a href="..\reference\index.html">Справочник</a>
        </li>
    
        <li>
            <a href="..\genindex.html">Индекс</a>
        </li>
    
        <li>
            <a href="..\contributing\index.html">Участие</a>
        </li>
    
    </ul>
</div>

                <div class="toc"> 
    <h4>Содержание</h4>
    <div class="toc-content">
        <ul>
<li><a class="reference internal" href="#">Установка или исправление разрешений файлов</a><ul>
<li><a class="reference internal" href="#id2">1. Использование одного пользователя для командной строки и веб-сервера</a></li>
<li><a class="reference internal" href="#acl-chmod-a-macos">2. Использование ACL в системе, поддерживающей <tt class="docutils literal"><code>chmod +a</code></tt> (macOS)</a></li>
<li><a class="reference internal" href="#acl-setfacl-linux-bsd">3. Использование ACL в системе, поддерживающей <tt class="docutils literal"><code>setfacl</code></tt> (Linux/BSD)</a></li>
<li><a class="reference internal" href="#acl">4. Без использования ACL</a></li>
</ul>
</li>
</ul>

    </div>
</div>
                
            </div>

            <div class="ads m-b-30">
                <h2>Вакансии Playtini</h2>
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/php-dev">
                            Middle+ PHP Developer/Symfony
                        </a>
                    </h3>
                    <div><b>Playtini</b> активно поддерживает и развивает свои продукты, и профессионализм команды. И на данный момент в поиске специалиста на позицию <b>«Middle+ PHP Developer/Symfony»,</b> который улучшит качество внутренних сервисов компании и увеличит их количество.</div>
                </div>
                <!--
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/symfony-senior">
                            Senior PHP Developer/Symfony
                        </a>
                    </h3>
                    <div>We are looking for strong, experienced <b>Senior PHP Developer/Symfony.</b> We expect him/her to participate in improving and extending a system built using microservice architecture by means of modern technologies.</div>
                </div>
                -->
                <div class="ad">
                    <h3><a href="http://playtini.ua/careers">
                        Остальные вакансии компании
                        <img src="..\..\..\_images\logo-playtini.png" alt="Playtini">
                    </a></h3>
                </div>
            </div>
        </div>

        <div id="main" class="col-sm-9">
            <ol class="breadcrumb">
                
                <li><a href="..\index.html">Документация</a></li>
                
                <li><a href="..\getting_started\index.html">Getting Started</a></li>
                
                <li><a href="..\setup.html">Installing &amp; Setting up the Symfony Framework</a></li>
                
                <li class="active">Установка или исправление разрешений файлов</li>
            </ol>

            <div class="page">
                
  <div class="section" id="id1">
<h1>Установка или исправление разрешений файлов<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>Одним важным требованием Symfony является то, что каталог <tt class="docutils literal"><code>var</code></tt> должен быть
перезаписываемый как веб-сервером, так и ползователем командной строки.</p>
<p>В системах Linux и macOS, если пользователь вашего веб-сервера отличается от
вашего пользователя командной строки, вам нужно правильно сконфигурировать
разрешения, чтобы избежать проблем. Существует несколько способов достичь этого:</p>
<div class="section" id="id2">
<h2>1. Использование одного пользователя для командной строки и веб-сервера<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Редактируйте конфигурацию вашего веб-сервера (обычно <tt class="docutils literal"><code>httpd.conf</code></tt> или <tt class="docutils literal"><code>apache2.conf</code></tt>
для Apache) и установите её ползователя так, чтобы он совпадал с вашим пользователем
командной строки (например, для Apache, обновите директивы <tt class="docutils literal"><code>User</code></tt> и <tt class="docutils literal"><code>Group</code></tt>).</p>
<div class="admonition-wrapper">
<div class="caution"></div><div class="admonition admonition-caution"><p class="first admonition-title">Caution</p>
<p class="last">Если это решение используется на сервере производства, убедитесь в том, что
этот пользователь имеет только лимитированные привелегии (и не имеет доступа
к приватным данным или серверам, выполнению небезопасных бинарных кодов и др.),
так как скомпроментированные сервер предоставит хакеру такие привелегии.</p>
</div></div>
</div>
<div class="section" id="acl-chmod-a-macos">
<h2>2. Использование ACL в системе, поддерживающей <tt class="docutils literal"><code>chmod +a</code></tt> (macOS)<a class="headerlink" href="#acl-chmod-a-macos" title="Permalink to this headline">¶</a></h2>
<p>В системах macOS, команда <tt class="docutils literal"><code>chmod``поддерживает флаг ``+a</code></tt> для определения ACL.
Используйте следующий скрипт, чтобы определить пользователя вашего веб-сервера и
предоставить ему необходимые разрешения:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> rm -rf var/cache/*
<span class="gp">$</span> rm -rf var/logs/*

<span class="gp">$</span> <span class="nv">HTTPDUSER</span><span class="o">=</span><span class="k">$(</span>ps axo user,comm <span class="p">|</span> grep -E <span class="s1">&#39;[a]pache|[h]ttpd|[_]www|[w]ww-data|[n]ginx&#39;</span> <span class="p">|</span> grep -v root <span class="p">|</span> head -1 <span class="p">|</span> cut -d<span class="se">\ </span> -f1<span class="k">)</span>
<span class="gp">$</span> sudo chmod +a <span class="s2">&quot;</span><span class="nv">$HTTPDUSER</span><span class="s2"> allow delete,write,append,file_inherit,directory_inherit&quot;</span> var
<span class="gp">$</span> sudo chmod +a <span class="s2">&quot;</span><span class="k">$(</span>whoami<span class="k">)</span><span class="s2"> allow delete,write,append,file_inherit,directory_inherit&quot;</span> var
</pre></div>
</td></tr></table></div></div>
</div>
<div class="section" id="acl-setfacl-linux-bsd">
<h2>3. Использование ACL в системе, поддерживающей <tt class="docutils literal"><code>setfacl</code></tt> (Linux/BSD)<a class="headerlink" href="#acl-setfacl-linux-bsd" title="Permalink to this headline">¶</a></h2>
<p>Большинство дистрибутивов Linux и BSD не поддерживают <tt class="docutils literal"><code>chmod +a</code></tt>, однако
поддерживают другую утилиту под названием <tt class="docutils literal"><code>setfacl</code></tt>. Вам может понадобиться
установить <tt class="docutils literal"><code>setfacl</code></tt> и <a class="reference external" href="https://help.ubuntu.com/community/FilePermissionsACLs">включить поддержку ACL</a> в вашем разделе диска до того,
как его использовать. Потом, используйте следующий скрипт, чтобы определить пользователя
вашего веб-сервера и предоставить ему необходимые разрешения:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nv">HTTPDUSER</span><span class="o">=</span><span class="k">$(</span>ps axo user,comm <span class="p">|</span> grep -E <span class="s1">&#39;[a]pache|[h]ttpd|[_]www|[w]ww-data|[n]ginx&#39;</span> <span class="p">|</span> grep -v root <span class="p">|</span> head -1 <span class="p">|</span> cut -d<span class="se">\ </span> -f1<span class="k">)</span>
<span class="c1"># if this doesn&#39;t work, try adding `-n` option</span>
<span class="gp">$</span> sudo setfacl -dR -m u:<span class="s2">&quot;</span><span class="nv">$HTTPDUSER</span><span class="s2">&quot;</span>:rwX -m u:<span class="k">$(</span>whoami<span class="k">)</span>:rwX var
<span class="gp">$</span> sudo setfacl -R -m u:<span class="s2">&quot;</span><span class="nv">$HTTPDUSER</span><span class="s2">&quot;</span>:rwX -m u:<span class="k">$(</span>whoami<span class="k">)</span>:rwX var
</pre></div>
</td></tr></table></div></div>
<div class="admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p>Первая команда <tt class="docutils literal"><code>setfacl</code></tt> устанавливает разрешения в существующих файлах и папках,
в то время как вторая - в будущих файлах и папках. Обе эти команды назначают
разрешения для пользователя системы и пользователя Apache.</p>
<p class="last"><tt class="docutils literal"><code>setfacl</code></tt> недоступна в монтаже NFS. Однако, хранение кеша и записей логов в NFS
очень порицается по причинам производительности.</p>
</div></div>
</div>
<div class="section" id="acl">
<h2>4. Без использования ACL<a class="headerlink" href="#acl" title="Permalink to this headline">¶</a></h2>
<p>Если ни один из предыдущих методов для вас не работает, измените umask так,
чтобы каталоги кеша и логов имели возможность быть перезаписанными группами или
миром (в зависимости от того, находятся ли пользователь веб-сервера и пользователь
командной строки в одной группе, или нет). Чтобы достичь эого, пометите следующую
строку в начале файлов <tt class="docutils literal"><code>bin/console</code></tt>, <tt class="docutils literal"><code>web/app.php</code></tt> и <tt class="docutils literal"><code>web/app_dev.php</code></tt>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nb">umask</span><span class="p">(</span><span class="mo">0002</span><span class="p">);</span> <span class="c1">// This will let the permissions be 0775</span>

<span class="c1">// or</span>

<span class="nb">umask</span><span class="p">(</span><span class="mo">0000</span><span class="p">);</span> <span class="c1">// This will let the permissions be 0777</span>
</pre></div>
</td></tr></table></div></div>
<div class="admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p class="last">Изменение umask не ориентировано на многопоточное изменение, поэтому рекомендуются
ACL-методы в случае, если они доступны.</p>
</div></div>
</div>
</div>


            </div>

            
            <div class="navigation">
                <a href="file_permissions.html">« Setting up or Fixing File Permissions</a>
                <span class="separator">|</span>
                <a href="flex.html">Using Symfony Flex to Manage Symfony Applications »</a>
            </div>
            

            <div id="license">
                <p>Эта документация является переводом <a href="http://symfony.com/doc/current/index.html">официальной документации Symfony</a> и предоставляется по свободной лицензии <a rel="license nofollow" href="https://creativecommons.org/licenses/by-sa/3.0/deed.ru">CC BY-SA 3.0</a>.</p>
            </div>
        </div>
    </div>
</div></div>


  </body>
</body></html>