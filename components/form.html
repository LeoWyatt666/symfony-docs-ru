<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    <title>Компонент Form &mdash; Symfony Framework Documentation  documentation</title>
    
    <link rel="stylesheet" href="../_static/" type="text/css">
    <link rel="stylesheet" href="..\_static\pygments.css" type="text/css">
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <link rel="top" title="Symfony Framework Documentation  documentation" href="..\index.html">
    <link rel="up" title="The Components" href="index.html">
    <link rel="next" title="The HttpFoundation Component" href="http_foundation.html">
    <link rel="prev" title="The Form Component" href="form.html">

<link rel="stylesheet" href="..\_assets\app.css?v=8d6d457a0820d7c245bddae16bfd4c75">
<script src="..\_assets\manifest.js?v=d41d8cd98f00b204e980"></script>
<script src="..\_assets\app.js?v=900984040c7cb4dca514"></script>
<style>
    .header__top .container {
        overflow: hidden;
        padding-top: 10px;
        padding-bottom: 10px;
    }
    .header__top .header__logo {
        float: left;
    }
    .header__top .header__support {
        float: right;
    }

    .highlight .k, .highlight .gh, .highlight .gp,
    .highlight .gu, .highlight .kc, .highlight .kd,
    .highlight .kn, .highlight .kr, .highlight .nc,
    .highlight .nd, .highlight .ni, .highlight .nl,
    .highlight .nn, .highlight .nt, .highlight .ow,
    .highlight .se { font-weight: normal; }

    .highlight .c, .highlight .cm, .highlight .c1,
    .highlight .sd, .highlight .si { font-style: normal; }

    .doc { background: none; }
    #demo-warning {
        border: 3px dashed #c00;
        padding: 10px;
        margin-bottom: 30px;
    }
    #demo-warning h4 { font-size: 1.7em;font-weight: bold; }
    #demo-warning p { margin-bottom: 0; }
</style>

<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-107764519-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-107764519-1');
</script>

<!-- Facebook Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '250281335689441');
    fbq('track', 'PageView');
</script>
<img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=250281335689441&ev=PageView&noscript=1">
<!-- End Facebook Pixel Code -->

<script type="text/javascript">!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://vk.com/js/api/openapi.js?159",t.onload=function(){VK.Retargeting.Init("VK-RTRG-279161-8p6Jv"),VK.Retargeting.Hit()},document.head.appendChild(t)}();</script><img src="https://vk.com/rtrg?p=VK-RTRG-279161-8p6Jv" style="position:fixed; left:-999px;" alt="">


  </head>
  <body role="document">

<body class="components doc_article doc">

<header>
    <section class="header__top">
        <div class="container">
            <div class="header__logo">
                <a href="..\..\..\index.html">
                    <img src="..\..\..\_images\header-logo.svg" alt="Symfony.com.ua logo">
                </a>
            </div>
            <div class="header__support hidden-xs">
                <a href="http://playtini.ua/" title="Компания Playtini">
                    <img height="69" src="..\..\..\_images\support.png" alt="Symfony is a SensioLabs product">
                </a>
            </div>
        </div>
    </section>
</header>

<div class="container"><div id="page-content">
    <div class="row">
        <div id="sidebar" class="col-sm-3">
            <div id="sidebar-content"><div class="submenu">
    
    
    <ul class="list_submenu list-unstyled">
    
        <li class="first">
            <a href="..\index.html">Главная</a>
        </li>
    
        <li>
            <a href="index.html">Компоненты</a>
        </li>
    
        <li>
            <a href="..\best_practices\index.html">Лучшие практики</a>
        </li>
    
        <li>
            <a href="..\quick_tour\index.html">Быстрый старт</a>
        </li>
    
        <li>
            <a href="..\reference\index.html">Справочник</a>
        </li>
    
        <li>
            <a href="..\genindex.html">Индекс</a>
        </li>
    
        <li>
            <a href="..\contributing\index.html">Участие</a>
        </li>
    
    </ul>
</div>

                <div class="toc"> 
    <h4>Содержание</h4>
    <div class="toc-content">
        <ul>
<li><a class="reference internal" href="#">Компонент Form</a><ul>
<li><a class="reference internal" href="#id1">Установка</a></li>
<li><a class="reference internal" href="#id2">Конфигурация</a><ul>
<li><a class="reference internal" href="#id3">Обработка запросов</a></li>
<li><a class="reference internal" href="#csrf">CSRF-защита</a></li>
<li><a class="reference internal" href="#twig">Шаблонизация Twig</a></li>
<li><a class="reference internal" href="#component-form-intro-install-translation-ru">Перевод</a></li>
<li><a class="reference internal" href="#id5">Валидация</a></li>
<li><a class="reference internal" href="#id6">Доступ к фабрике форм</a></li>
</ul>
</li>
<li><a class="reference internal" href="#component-form-intro-create-simple-form-ru">Создание простой формы</a><ul>
<li><a class="reference internal" href="#id8">Установка значений по умолчению</a></li>
<li><a class="reference internal" href="#component-form-intro-rendering-form-ru">Отображение формы</a></li>
<li><a class="reference internal" href="#id10">Изменения метода и действия формы</a></li>
<li><a class="reference internal" href="#component-form-intro-handling-submission-ru">Обработка отправок формы</a></li>
<li><a class="reference internal" href="#component-form-intro-validation-ru">Валидация форм</a></li>
<li><a class="reference internal" href="#id13">Доступ к ошибкам формы</a></li>
<li><a class="reference internal" href="#clearing-form-errors">Clearing Form Errors</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id14">Узнайте больше</a></li>
</ul>
</li>
</ul>

    </div>
</div>
                
            </div>

            <div class="ads m-b-30">
                <h2>Вакансии Playtini</h2>
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/php-dev">
                            Middle+ PHP Developer/Symfony
                        </a>
                    </h3>
                    <div><b>Playtini</b> активно поддерживает и развивает свои продукты, и профессионализм команды. И на данный момент в поиске специалиста на позицию <b>«Middle+ PHP Developer/Symfony»,</b> который улучшит качество внутренних сервисов компании и увеличит их количество.</div>
                </div>
                <!--
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/symfony-senior">
                            Senior PHP Developer/Symfony
                        </a>
                    </h3>
                    <div>We are looking for strong, experienced <b>Senior PHP Developer/Symfony.</b> We expect him/her to participate in improving and extending a system built using microservice architecture by means of modern technologies.</div>
                </div>
                -->
                <div class="ad">
                    <h3><a href="http://playtini.ua/careers">
                        Остальные вакансии компании
                        <img src="..\..\..\_images\logo-playtini.png" alt="Playtini">
                    </a></h3>
                </div>
            </div>
        </div>

        <div id="main" class="col-sm-9">
            <ol class="breadcrumb">
                
                <li><a href="..\index.html">Документация</a></li>
                
                <li><a href="index.html">The Components</a></li>
                
                <li class="active">Компонент Form</li>
            </ol>

            <div class="page">
                
  <div class="section" id="form">
<span id="index-0"></span><h1>Компонент Form<a class="headerlink" href="#form" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>Компонент Form позволяет вам с лёгкостью создавать, обрабатывать и использовать
формы повторно.</div></blockquote>
<p>Копомнент Form - это инструмент, призванный помочь вам решить проблему разрешения
конечным пользователям взаимодействовать и изменять данные в вашем приложении. И
хотя традиционно это делалось через HTML формы, компонент фокусируется на обработке
данных к и от вашего клиента и приложения, будь эти данные из обычной записи формы
или из API.</p>
<div class="section" id="id1">
<h2>Установка<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> composer require symfony/form
</pre></div>
</td></tr></table></div></div>
<p>Также вы можете клонировать репозиторий <a class="reference external" href="https://github.com/symfony/form">https://github.com/symfony/form</a>.</p>
<div class="admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p class="last">If you install this component outside of a Symfony application, you must
require the <tt class="docutils literal"><code>vendor/autoload.php</code></tt> file in your code to enable the class
autoloading mechanism provided by Composer. Read
<a class="reference internal" href="using_components.html"><em>this article</em></a> for more details.</p>
</div></div>
</div>
<div class="section" id="id2">
<h2>Конфигурация<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="admonition-wrapper">
<div class="seealso"></div><div class="admonition admonition-seealso">Эта статья объясняет как использовать функции Form как независимого
компонента в любом приложении PHP. Прочитайте статью <a class="reference internal" href="..\forms.html"><em>Forms</em></a>
для понимания как использовать его в приложениях Symfony.</div></div>
<div class="admonition-wrapper">
<div class="tip"></div><div class="admonition admonition-tip"><p class="first admonition-title">Tip</p>
<p class="last">Если вы работаете с полным фреймворком Symfony, компонент Форма уже сконфигурирован
для вас. В этом случае, перейдите к <a class="reference internal" href="form.html#component-form-intro-create-simple-form"><span>Creating a simple Form</span></a>.</p>
</div></div>
<p>В Symfony, формы представлены объектыми, а эти объекты строятся с использованием
<em>фабрики форм</em>. Построить фабрику форм просто:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Form\Forms</span><span class="p">;</span>

<span class="nv">$formFactory</span> <span class="o">=</span> <span class="nx">Forms</span><span class="o">::</span><span class="na">createFormFactory</span><span class="p">();</span>
</pre></div>
</td></tr></table></div></div>
<p>Эта фабрика может уже быть использована для создания базовых форм, но ей
не хватает поддержки для очень важных функций:</p>
<ul class="simple">
<li><strong>Обработка запросов:</strong> Поддержка обработки запросов и загрузки файлов;</li>
<li><strong>CSRF-защита:</strong> Поддержка защиты от атак межсайтовой подделки запросов
(CSRF);</li>
<li><strong>Шаблонизация:</strong> Интеграция с уровнем шаблонизации, который позволяет вам
использовать фрагменты HTML повторно при отображении формы;</li>
<li><strong>Перевод:</strong> Поддержка перевода сообщений об ошибках, ярлыков полей и других
строк;</li>
<li><strong>Валидация:</strong> Интеграция с библиотекой валидации для генерирования сообщений
об ошибках для отправленных данных.</li>
</ul>
<p>Компонент Форма Symfony полагается на другие библиотеки в решении этих проблем.
В большинстве случаев вы будете использовать Twig и Symfony
<a class="reference internal" href="http_foundation.html"><em>HttpFoundation</em></a>, компоненты Перевод и Валидатор,
но вы можете заменить любой из них другой библиотекой на ваш выбор.</p>
<p>Следующие разделы объясняют, как подключать эти библиотеки в фабрику форм.</p>
<div class="admonition-wrapper">
<div class="tip"></div><div class="admonition admonition-tip"><p class="first admonition-title">Tip</p>
<p class="last">Чтобы увидеть рабочий пример, см. <a class="reference external" href="https://github.com/webmozart/standalone-forms">https://github.com/webmozart/standalone-forms</a></p>
</div></div>
<div class="section" id="id3">
<h3>Обработка запросов<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Чтобы обработать даныные формы, вам понадобится вызвать метод
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/Form.html#method_handleRequest" title="Symfony\Component\Form\Form::handleRequest()">handleRequest()</a></code></tt>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nv">$form</span><span class="o">-&gt;</span><span class="na">handleRequest</span><span class="p">();</span>
</pre></div>
</td></tr></table></div></div>
<p>За кулисами используется объект <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/NativeRequestHandler.html" title="Symfony\Component\Form\NativeRequestHandler">NativeRequestHandler</a></code></tt>
для считывания данных с правильных суперглобальных PHP (т.е. <tt class="docutils literal"><code>$_POST</code></tt> или <tt class="docutils literal"><code>$_GET</code></tt>),
основанніх на HTTP методе, сконфигурированном в форме (POST по умолчанию).</p>
<div class="admonition-wrapper">
<div class="seealso"></div><div class="admonition admonition-seealso">Если вам нужно больше контроля над тем, когда именно отправляется ваша форма,
или какие данные передаются ей, вы можете использовать для этого
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/FormInterface.html#method_submit" title="Symfony\Component\Form\FormInterface::submit()">submit()</a></code></tt>. Прочтите больше
об этом <a class="reference internal" href="..\form\direct_submit.html#form-call-submit-directly"><span>Calling Form::submit() manually</span></a>.</div></div>
<div class="admonition-wrapper">
<div class="sidebar"></div><div class="admonition admonition-sidebar"><p class="first sidebar-title">Интеграция с компонентом HttpFoundation</p>
<p>Если вы используете компонент HttpFoundation, то вам стоит добавить
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/Extension/HttpFoundation/HttpFoundationExtension.html" title="Symfony\Component\Form\Extension\HttpFoundation\HttpFoundationExtension">HttpFoundationExtension</a></code></tt>
в вашу фабрику форм:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Form\Forms</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\HttpFoundation\HttpFoundationExtension</span><span class="p">;</span>

<span class="nv">$formFactory</span> <span class="o">=</span> <span class="nx">Forms</span><span class="o">::</span><span class="na">createFormFactoryBuilder</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">addExtension</span><span class="p">(</span><span class="k">new</span> <span class="nx">HttpFoundationExtension</span><span class="p">())</span>
    <span class="o">-&gt;</span><span class="na">getFormFactory</span><span class="p">();</span>
</pre></div>
</td></tr></table></div></div>
<p>Теперь, когда вы обрабатываете форму, вы можете передать объект
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html" title="Symfony\Component\HttpFoundation\Request">Request</a></code></tt> методу
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/Form.html#method_handleRequest" title="Symfony\Component\Form\Form::handleRequest()">handleRequest()</a></code></tt>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nv">$form</span><span class="o">-&gt;</span><span class="na">handleRequest</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span>
</pre></div>
</td></tr></table></div></div>
<div class="last admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p class="last">Чтобы узнать больше о компоненте HttpFoundation или о том, как его
установить, см. <a class="reference internal" href="http_foundation.html"><em>The HttpFoundation Component</em></a>.</p>
</div></div>
</div></div>
</div>
<div class="section" id="csrf">
<h3>CSRF-защита<a class="headerlink" href="#csrf" title="Permalink to this headline">¶</a></h3>
<p>Защита от CSRF-атак встроена в компонент Форма, но вам нужно ясно включить
её или заменить пользовательским решением. Если вы хотите использовать встроенную
поддержку, для начала установите компонент CSRF-защита:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> composer require symfony/security-csrf
</pre></div>
</td></tr></table></div></div>
<p>Следующий отрезок добавляет CSRF-защиту к фабрике форм:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Form\Forms</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Session\Session</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Csrf\CsrfExtension</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Security\Csrf\TokenStorage\SessionTokenStorage</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Security\Csrf\TokenGenerator\UriSafeTokenGenerator</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Security\Csrf\CsrfTokenManager</span><span class="p">;</span>

<span class="c1">// создаёт объект сесси из компонента HttpFoundation</span>
<span class="nv">$session</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Session</span><span class="p">();</span>

<span class="nv">$csrfGenerator</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">UriSafeTokenGenerator</span><span class="p">();</span>
<span class="nv">$csrfStorage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SessionTokenStorage</span><span class="p">(</span><span class="nv">$session</span><span class="p">);</span>
<span class="nv">$csrfManager</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CsrfTokenManager</span><span class="p">(</span><span class="nv">$csrfGenerator</span><span class="p">,</span> <span class="nv">$csrfStorage</span><span class="p">);</span>

<span class="nv">$formFactory</span> <span class="o">=</span> <span class="nx">Forms</span><span class="o">::</span><span class="na">createFormFactoryBuilder</span><span class="p">()</span>
    <span class="c1">// ...</span>
    <span class="o">-&gt;</span><span class="na">addExtension</span><span class="p">(</span><span class="k">new</span> <span class="nx">CsrfExtension</span><span class="p">(</span><span class="nv">$csrfManager</span><span class="p">))</span>
    <span class="o">-&gt;</span><span class="na">getFormFactory</span><span class="p">();</span>
</pre></div>
</td></tr></table></div></div>
<p>Внутренне, это расширение автоматически добавит скрытое поле к каждой форме
(по умолчанию названное <tt class="docutils literal"><code>_token</code></tt>), значение которой автоматически генерируется
CSRF-генератором и валидируется при построении формы.</p>
<div class="admonition-wrapper">
<div class="tip"></div><div class="admonition admonition-tip"><p class="first admonition-title">Tip</p>
<p>Если вы не используете компонент HttpFoundation, то вместо него вы можете использовать
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Security/Csrf/TokenStorage/NativeSessionTokenStorage.html" title="Symfony\Component\Security\Csrf\TokenStorage\NativeSessionTokenStorage">NativeSessionTokenStorage</a></code></tt>,
который полагается на встроенную PHP обработку сессии:</p>
<div class="literal-block"><div class="last highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Security\Csrf\TokenStorage\NativeSessionTokenStorage</span><span class="p">;</span>

<span class="nv">$csrfStorage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">NativeSessionTokenStorage</span><span class="p">();</span>
<span class="c1">// ...</span>
</pre></div>
</td></tr></table></div></div>
</div></div>
</div>
<div class="section" id="twig">
<h3>Шаблонизация Twig<a class="headerlink" href="#twig" title="Permalink to this headline">¶</a></h3>
<p>Если вы используете компонент Форма для обработки HTML форм, то вам понадобится
способ с лёгкостью отображать вашу форму в виде полей HTML формы (заполненную
значениями полей, ошибками и ярлыками). Если вы используете <a class="reference external" href="http://twig.sensiolabs.org">Twig</a> в качестве
шаблонизатора, то компонент Форма предлагает богатую интеграцию.</p>
<p>Чтобы использовать интеграцию, вам понадобится twig bridge, который предоставляет
интеграцию между Twig и некоторыми компонентами Symfony:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> composer require symfony/twig-bridge
</pre></div>
</td></tr></table></div></div>
<p>Интеграция TwigBridge предоставляет вам несколько <a class="reference internal" href="..\reference\forms\twig_reference.html"><em>функций Twig</em></a>,
которые помогают вам отображать HTML-виджет, ярлык и ошибку для каждого
поля (а также несколько других вещей). Чтобы сконфигурировать интеграцию,
вам понадобится запустить или получить доступ к Twig и добавить
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Bridge/Twig/Extension/FormExtension.html" title="Symfony\Bridge\Twig\Extension\FormExtension">FormExtension</a></code></tt>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Form\Forms</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Bridge\Twig\Extension\FormExtension</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\FormRenderer</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Bridge\Twig\Form\TwigRendererEngine</span><span class="p">;</span>

<span class="c1">// файл Twig, содержащий всю разметку по умолчанию для отображения форм</span>
<span class="c1">// этот файл поставляется с TwigBridge</span>
<span class="nv">$defaultFormTheme</span> <span class="o">=</span> <span class="s1">&#39;form_div_layout.html.twig&#39;</span><span class="p">;</span>

<span class="nv">$vendorDirectory</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="no">__DIR__</span><span class="o">.</span><span class="s1">&#39;/../vendor&#39;</span><span class="p">);</span>
<span class="c1">// путь к библиотеке TwigBridge, чтобы Twig мог найти</span>
<span class="c1">// файл form_div_layout.html.twig</span>
<span class="nv">$appVariableReflection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\ReflectionClass</span><span class="p">(</span><span class="s1">&#39;\Symfony\Bridge\Twig\AppVariable&#39;</span><span class="p">);</span>
<span class="nv">$vendorTwigBridgeDirectory</span> <span class="o">=</span> <span class="nb">dirname</span><span class="p">(</span><span class="nv">$appVariableReflection</span><span class="o">-&gt;</span><span class="na">getFileName</span><span class="p">());</span>
<span class="c1">// путь к вашим другим щаблонам</span>
<span class="nv">$viewsDirectory</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="no">__DIR__</span><span class="o">.</span><span class="s1">&#39;/../views&#39;</span><span class="p">);</span>

<span class="nv">$twig</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Twig_Environment</span><span class="p">(</span><span class="k">new</span> <span class="nx">Twig_Loader_Filesystem</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="nv">$viewsDirectory</span><span class="p">,</span>
    <span class="nv">$vendorTwigBridgeDirectory</span><span class="o">.</span><span class="s1">&#39;/Resources/views/Form&#39;</span><span class="p">,</span>
<span class="p">)));</span>
<span class="nv">$formEngine</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TwigRendererEngine</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="nv">$defaultFormTheme</span><span class="p">),</span> <span class="nv">$twig</span><span class="p">);</span>
<span class="nv">$twig</span><span class="o">-&gt;</span><span class="na">addRuntimeLoader</span><span class="p">(</span><span class="k">new</span> <span class="nx">\Twig_FactoryRuntimeLoader</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="nx">FormRenderer</span><span class="o">::</span><span class="na">class</span> <span class="o">=&gt;</span> <span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$formEngine</span><span class="p">,</span> <span class="nv">$csrfManager</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">FormRenderer</span><span class="p">(</span><span class="nv">$formEngine</span><span class="p">,</span> <span class="nv">$csrfManager</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">)));</span>

<span class="c1">// ... (см. предыдущий раздел CSRF-защита, чтобы узнать больше)</span>

<span class="c1">// добавляет FormExtension в Twig</span>
<span class="nv">$twig</span><span class="o">-&gt;</span><span class="na">addExtension</span><span class="p">(</span><span class="k">new</span> <span class="nx">FormExtension</span><span class="p">());</span>

<span class="c1">// создаёт фабрику форм</span>
<span class="nv">$formFactory</span> <span class="o">=</span> <span class="nx">Forms</span><span class="o">::</span><span class="na">createFormFactoryBuilder</span><span class="p">()</span>
    <span class="c1">// ...</span>
    <span class="o">-&gt;</span><span class="na">getFormFactory</span><span class="p">();</span>
</pre></div>
</td></tr></table></div></div>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.30: </span><tt class="docutils literal"><code>Twig_FactoryRuntimeLoader</code></tt> была представлена в Twig 1.30.</p>
</div>
<p>Точные детали вашей <a class="reference external" href="http://twig.sensiolabs.org/doc/intro.html">Конфигурации Twig</a> будут отличаться, но цель - позволить
добавить <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Bridge/Twig/Extension/FormExtension.html" title="Symfony\Bridge\Twig\Extension\FormExtension">FormExtension</a></code></tt> в Twig, что
предоставляет вам доступ к функциям Twig для отображения форм.
Чтобы сделать это, вам для начала нужно создать
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Bridge/Twig/Form/TwigRendererEngine.html" title="Symfony\Bridge\Twig\Form\TwigRendererEngine">TwigRendererEngine</a></code></tt>, где вы определите
ваш <a class="reference internal" href="../form/form_customization-ru.html#form-customization-form-themes"><span>form themes</span></a> (т.е. источники /
файлы, которые определяют HTML разметку формы).</p>
<p>Чтобы узнать общие детали об отображении форм, см. <a class="reference internal" href="..\form\form_customization.html"><em>How to Customize Form Rendering</em></a>.</p>
<div class="admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p class="last">Если вы используете интеграцию Twig, прочтите &quot;<a class="reference internal" href="form.html#component-form-intro-install-translation"><span>Translation</span></a>&quot;
ниже, чтобы узнать детали о необходимых фильтрах перевода.</p>
</div></div>
</div>
<div class="section" id="component-form-intro-install-translation-ru">
<span id="id4"></span><h3>Перевод<a class="headerlink" href="#component-form-intro-install-translation-ru" title="Permalink to this headline">¶</a></h3>
<p>Если вы используете интеграцию Twig с одним из файлов темы по умолчанию
(например, <tt class="docutils literal"><code>form_div_layout.html.twig</code></tt>), то существуется 2 фильтра Twig
(<tt class="docutils literal"><code>trans</code></tt> и <tt class="docutils literal"><code>transChoice</code></tt>), которые используются для перевода ярлыков
формы, ошибок, текста опций и других строк.</p>
<p>Чтобы добавить эти фильтры Twig, вы можете либо использовать встроенный
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Bridge/Twig/Extension/TranslationExtension.html" title="Symfony\Bridge\Twig\Extension\TranslationExtension">TranslationExtension</a></code></tt>, который
интегрируется с компонентом Symfony Перевод, либо добавить 2 фильтра Twig
самостоятельно, через ваше собственное расширение Twig.</p>
<p>Чтобы использовать встроенную интеграцию, убедитесь в том, что в вашем
проекте установлены компоненты Symfony Перевод и <a class="reference internal" href="config.html"><em>Конфигурация</em></a>:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> composer require symfony/translation symfony/config
</pre></div>
</td></tr></table></div></div>
<p>Далее, добавьте <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Bridge/Twig/Extension/TranslationExtension.html" title="Symfony\Bridge\Twig\Extension\TranslationExtension">TranslationExtension</a></code></tt>
к вашему экземпляру <tt class="docutils literal"><code>Twig_Environment</code></tt>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Form\Forms</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Translation\Translator</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Translation\Loader\XliffFileLoader</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Bridge\Twig\Extension\TranslationExtension</span><span class="p">;</span>

<span class="c1">// создаёт Переводчик</span>
<span class="nv">$translator</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Translator</span><span class="p">(</span><span class="s1">&#39;en&#39;</span><span class="p">);</span>
<span class="c1">// как-то загружает некоторые переводы в него</span>
<span class="nv">$translator</span><span class="o">-&gt;</span><span class="na">addLoader</span><span class="p">(</span><span class="s1">&#39;xlf&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">XliffFileLoader</span><span class="p">());</span>
<span class="nv">$translator</span><span class="o">-&gt;</span><span class="na">addResource</span><span class="p">(</span>
    <span class="s1">&#39;xlf&#39;</span><span class="p">,</span>
    <span class="no">__DIR__</span><span class="o">.</span><span class="s1">&#39;/path/to/translations/messages.en.xlf&#39;</span><span class="p">,</span>
    <span class="s1">&#39;en&#39;</span>
<span class="p">);</span>

<span class="c1">// добавляет TranslationExtension (даёт нам фильтры trans и transChoice)</span>
<span class="nv">$twig</span><span class="o">-&gt;</span><span class="na">addExtension</span><span class="p">(</span><span class="k">new</span> <span class="nx">TranslationExtension</span><span class="p">(</span><span class="nv">$translator</span><span class="p">));</span>

<span class="nv">$formFactory</span> <span class="o">=</span> <span class="nx">Forms</span><span class="o">::</span><span class="na">createFormFactoryBuilder</span><span class="p">()</span>
    <span class="c1">// ...</span>
    <span class="o">-&gt;</span><span class="na">getFormFactory</span><span class="p">();</span>
</pre></div>
</td></tr></table></div></div>
<p>В зависимости от того, как загружаются ваши переводы, вы можете теперь добавить
ключи строк, например, ярлыки полей и их переводы в ваши файлы переводов.</p>
<p>Чтобы узнать больше о переводах, см. <a class="reference internal" href="..\translation.html"><em>Translations</em></a>.</p>
</div>
<div class="section" id="id5">
<h3>Валидация<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>Компонент Форма поставляется с тесной (но необязательной) интеграцией с компонентом
Symfony Валидатор. Если вы используете другое решение для валидации - то это не
проблема! Просто возьмите отправленные данные вашей формы (массив или объект) и
передайте их через вашу собственную систему валидации.</p>
<p>Чтобы использовать интеграцию с компонентом Symfony Валидатор, для начала
убедитесь, что он установлен в вашем приложении:</p>
<div class="literal-block"><div class="highlight-terminal"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> composer require symfony/validator
</pre></div>
</td></tr></table></div></div>
<p>Если вы не знакомы с этим компонентом, прочтите больше о нём: <a class="reference internal" href="..\validation.html"><em>Validation</em></a>.
Компонент Форма поставляется с классом
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/Extension/Validator/ValidatorExtension.html" title="Symfony\Component\Form\Extension\Validator\ValidatorExtension">ValidatorExtension</a></code></tt>,
который автоматически применяет валидацию к вашим данным. Эти ошибки потом
связываются с соответствующим полем и отображаются.</p>
<p>Ваша интеграция с компонентом Валидация будет выглядеть как-то так:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Form\Forms</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Validator\ValidatorExtension</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Validator\Validation</span><span class="p">;</span>

<span class="nv">$vendorDirectory</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="no">__DIR__</span><span class="o">.</span><span class="s1">&#39;/../vendor&#39;</span><span class="p">);</span>
<span class="nv">$vendorFormDirectory</span> <span class="o">=</span> <span class="nv">$vendorDirectory</span><span class="o">.</span><span class="s1">&#39;/symfony/form&#39;</span><span class="p">;</span>
<span class="nv">$vendorValidatorDirectory</span> <span class="o">=</span> <span class="nv">$vendorDirectory</span><span class="o">.</span><span class="s1">&#39;/symfony/validator&#39;</span><span class="p">;</span>

<span class="c1">// создаёт валидатор - детали будут отличаться</span>
<span class="nv">$validator</span> <span class="o">=</span> <span class="nx">Validation</span><span class="o">::</span><span class="na">createValidator</span><span class="p">();</span>

<span class="c1">// существуют встроенные переходы для базовых сообщений ошибок</span>
<span class="nv">$translator</span><span class="o">-&gt;</span><span class="na">addResource</span><span class="p">(</span>
    <span class="s1">&#39;xlf&#39;</span><span class="p">,</span>
    <span class="nv">$vendorFormDirectory</span><span class="o">.</span><span class="s1">&#39;/Resources/translations/validators.en.xlf&#39;</span><span class="p">,</span>
    <span class="s1">&#39;en&#39;</span><span class="p">,</span>
    <span class="s1">&#39;validators&#39;</span>
<span class="p">);</span>
<span class="nv">$translator</span><span class="o">-&gt;</span><span class="na">addResource</span><span class="p">(</span>
    <span class="s1">&#39;xlf&#39;</span><span class="p">,</span>
    <span class="nv">$vendorValidatorDirectory</span><span class="o">.</span><span class="s1">&#39;/Resources/translations/validators.en.xlf&#39;</span><span class="p">,</span>
    <span class="s1">&#39;en&#39;</span><span class="p">,</span>
    <span class="s1">&#39;validators&#39;</span>
<span class="p">);</span>

<span class="nv">$formFactory</span> <span class="o">=</span> <span class="nx">Forms</span><span class="o">::</span><span class="na">createFormFactoryBuilder</span><span class="p">()</span>
    <span class="c1">// ...</span>
    <span class="o">-&gt;</span><span class="na">addExtension</span><span class="p">(</span><span class="k">new</span> <span class="nx">ValidatorExtension</span><span class="p">(</span><span class="nv">$validator</span><span class="p">))</span>
    <span class="o">-&gt;</span><span class="na">getFormFactory</span><span class="p">();</span>
</pre></div>
</td></tr></table></div></div>
<p>Чтобы узнать больше, перейдите к разделу <a class="reference internal" href="form.html#component-form-intro-validation"><span>Form Validation</span></a>.</p>
</div>
<div class="section" id="id6">
<h3>Доступ к фабрике форм<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>Вашему приложению нужна только одна фабрика форм, и один объект фабрики должен
быть использован для создания всех объектов формы в вашем приложении. Это означает,
что вам нужно создать его в центральной части изначальной загрузки вашего приложения,
а потом получать доступ к нему, когда вам нужно будет строить форму.</p>
<div class="admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p class="last">В этом документе, фабрика форм всегда является локальной переменной под
названием <tt class="docutils literal"><code>$formFactory</code></tt>. Суть в том, что вам скорее всего понадобится
создать этот объект в более &quot;глобальном&quot; виде, чтобы вы могли получить к
нему доступ откуда угодно.</p>
</div></div>
<p>То, как именно вы получит доступ к вашей фабрике форм - зависит от вас. Если
вы используете сервис-контейнер (как предоставленный с
<a class="reference internal" href="dependency_injection.html"><em>компонентом DependencyInjection</em></a>), то
вам стоит добавить фабрику форм в ваш контейнер и вызывать её, когда вам будет
это нужно. Если ваше приложение использует глобальные или статические перменные
(обычно не очень хорошая идея), то вы можете хранить объект в некотором статичном
классе или сделать что-то подобное.</p>
<p>Вне зависимости от архитектуры вашего приложения, просто помните, что вам нужно
иметь только одну фабрику форм, и что вам нужно иметь к ней доступ во всём своём
приложении.</p>
</div>
</div>
<div class="section" id="component-form-intro-create-simple-form-ru">
<span id="id7"></span><h2>Создание простой формы<a class="headerlink" href="#component-form-intro-create-simple-form-ru" title="Permalink to this headline">¶</a></h2>
<div class="admonition-wrapper">
<div class="tip"></div><div class="admonition admonition-tip"><p class="first admonition-title">Tip</p>
<p class="last">Если вы используете фреймворк Symfony, то фабрика форм доступна автоматически
в виде сервиса под названием <tt class="docutils literal"><code>form.factory</code></tt>. Кроме того, базовый класс контроллера
по умолчанию имеет метод <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Bundle/FrameworkBundle/Controller.html#method_createFormBuilder" title="Symfony\Bundle\FrameworkBundle\Controller::createFormBuilder()">createFormBuilder()</a></code></tt>,
который является шорткатом для получения фабрики форм и вызова в ней <tt class="docutils literal"><code>createBuilder()</code></tt>.</p>
</div></div>
<p>Создание формы осуществляется через объект <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/FormBuilder.html" title="Symfony\Component\Form\FormBuilder">FormBuilder</a></code></tt>,
где вы строите и конфигурируете разные поля. Конструктор форм создаётся из
фабрики форм.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Standalone Use</em><div class="literal-block"><div class="highlight-php-standalone"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\TextType</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\DateType</span><span class="p">;</span>

<span class="c1">// ...</span>

<span class="nv">$form</span> <span class="o">=</span> <span class="nv">$formFactory</span><span class="o">-&gt;</span><span class="na">createBuilder</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;task&#39;</span><span class="p">,</span> <span class="nx">TextType</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;dueDate&#39;</span><span class="p">,</span> <span class="nx">DateType</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">getForm</span><span class="p">();</span>

<span class="nb">var_dump</span><span class="p">(</span><span class="nv">$twig</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span><span class="s1">&#39;new.html.twig&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;form&#39;</span> <span class="o">=&gt;</span> <span class="nv">$form</span><span class="o">-&gt;</span><span class="na">createView</span><span class="p">(),</span>
<span class="p">)));</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>Framework Use</em><div class="literal-block"><div class="highlight-php-symfony"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/Controller/TaskController.php</span>
<span class="k">namespace</span> <span class="nx">App\Controller</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Bundle\FrameworkBundle\Controller\Controller</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Request</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\TextType</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\DateType</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">TaskController</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">new</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// createFormBuilder - это сокращение для получения &quot;фабрики форм&quot;</span>
        <span class="c1">// и потом вызова &quot;createBuilder()&quot; в ней</span>

        <span class="nv">$form</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createFormBuilder</span><span class="p">()</span>
            <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;task&#39;</span><span class="p">,</span> <span class="nx">TextType</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;dueDate&#39;</span><span class="p">,</span> <span class="nx">DateType</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">getForm</span><span class="p">();</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span><span class="s1">&#39;task/new.html.twig&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;form&#39;</span> <span class="o">=&gt;</span> <span class="nv">$form</span><span class="o">-&gt;</span><span class="na">createView</span><span class="p">(),</span>
        <span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
</li>
</ul>
</div>
<p>Как вы видите, создание формы - это как написание рецепта: вы вызываете <tt class="docutils literal"><code>add()</code></tt>
для каждого нового поля, которое вы хотите создать. Первый аргумент <tt class="docutils literal"><code>add()</code></tt> -
это имя вашего поля, а второй - полное имя класса. Компонент Форма поставляетс
со множеством <a class="reference internal" href="..\reference\forms\types.html"><em>встроенных типов</em></a>.</p>
<p>Теперь, когда вы построили вашу форму, узнайте, как
<a class="reference internal" href="form.html#component-form-intro-rendering-form"><span>отображать</span></a> её и
<a class="reference internal" href="form.html#component-form-intro-handling-submission"><span>обрабатывать отправку формы</span></a>.</p>
<div class="section" id="id8">
<h3>Установка значений по умолчению<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>Если вам нужно, чтобы ваша форма загружалась с некоторыми значеиями по умолчанию
(или если вы строите форму &quot;редактирования&quot;), просто передайте данные по умолчанию
при создании вашего конструктора форм:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Standalone Use</em><div class="literal-block"><div class="highlight-php-standalone"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\FormType</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\TextType</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\DateType</span><span class="p">;</span>

<span class="c1">// ...</span>

<span class="nv">$defaults</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;dueDate&#39;</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">\DateTime</span><span class="p">(</span><span class="s1">&#39;tomorrow&#39;</span><span class="p">),</span>
<span class="p">);</span>

<span class="nv">$form</span> <span class="o">=</span> <span class="nv">$formFactory</span><span class="o">-&gt;</span><span class="na">createBuilder</span><span class="p">(</span><span class="nx">FormType</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="nv">$defaults</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;task&#39;</span><span class="p">,</span> <span class="nx">TextType</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;dueDate&#39;</span><span class="p">,</span> <span class="nx">DateType</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">getForm</span><span class="p">();</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>Framework Use</em><div class="literal-block"><div class="highlight-php-symfony"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/Controller/DefaultController.php</span>
<span class="k">namespace</span> <span class="nx">App\Controller</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Bundle\FrameworkBundle\Controller\Controller</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\TextType</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\DateType</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">DefaultController</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">new</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$defaults</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;dueDate&#39;</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">\DateTime</span><span class="p">(</span><span class="s1">&#39;tomorrow&#39;</span><span class="p">),</span>
        <span class="p">);</span>

        <span class="nv">$form</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createFormBuilder</span><span class="p">(</span><span class="nv">$defaults</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;task&#39;</span><span class="p">,</span> <span class="nx">TextType</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;dueDate&#39;</span><span class="p">,</span> <span class="nx">DateType</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">getForm</span><span class="p">();</span>

        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
</li>
</ul>
</div>
<div class="admonition-wrapper">
<div class="tip"></div><div class="admonition admonition-tip"><p class="first admonition-title">Tip</p>
<p class="last">В этом примере, данные по умолчанию - массив. Позже, когда вы будете
использовать опцию <a class="reference internal" href="..\forms.html#form-data-class"><span>data_class</span></a> для привязки
данных напрямую к объектам, ваши данные по умолчанию будут экземпляром
этого объекта.</p>
</div></div>
</div>
<div class="section" id="component-form-intro-rendering-form-ru">
<span id="id9"></span><h3>Отображение формы<a class="headerlink" href="#component-form-intro-rendering-form-ru" title="Permalink to this headline">¶</a></h3>
<p>Теперь, когда форма была создана, следующий шаг - отобразить её. Это делается
путём передачи специального объекта формы &quot;view&quot; в ваш щаблон (отметьте <tt class="docutils literal"><code>$form-&gt;createView()</code></tt>
в контроллере выше) и использования набора функций-помощников формы:</p>
<div class="literal-block"><div class="highlight-html+twig"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">form_start</span><span class="o">(</span><span class="nv">form</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="cp">{{</span> <span class="nv">form_widget</span><span class="o">(</span><span class="nv">form</span><span class="o">)</span> <span class="cp">}}</span>

    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="p">/&gt;</span>
<span class="cp">{{</span> <span class="nv">form_end</span><span class="o">(</span><span class="nv">form</span><span class="o">)</span> <span class="cp">}}</span>
</pre></div>
</td></tr></table></div></div>
<img alt="../_images/simple-form.png" class="align-center" src="..\_images\simple-form.png">
<p>Вот и всё! Напечатав <tt class="docutils literal"><code>form_widget(form)</code></tt>, вы отобразите каждое поле формы
вместе с ярлыком и сообщением ошибки (если оно есть). И хоть это и легко, но
(пока) не очень гибко. Обычно, вам нужно будет отображать каждое поле формы
отдельно, чтобы вы могли контролировать то, как выглядит форма. Вы узнаете,
как это делать в разделе &quot;<a class="reference internal" href="..\form\rendering.html"><em>How to Control the Rendering of a Form</em></a>&quot;.</p>
</div>
<div class="section" id="id10">
<h3>Изменения метода и действия формы<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>По умолчанию, форма отправляет по тому же URI, который отобразил форму с запросом
HTTP POST. Это поведение можно изменить используя опции <a class="reference internal" href="..\reference\forms\types\form.html#form-option-action"><span>action</span></a>
и <a class="reference internal" href="..\reference\forms\types\form.html#form-option-method"><span>method</span></a> (опция <tt class="docutils literal"><code>method</code></tt> также используется <tt class="docutils literal"><code>handleRequest()</code></tt>,
чтобы определить, была ли отправлена форма):</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Standalone Use</em><div class="literal-block"><div class="highlight-php-standalone"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\FormType</span><span class="p">;</span>

<span class="c1">// ...</span>

<span class="nv">$formBuilder</span> <span class="o">=</span> <span class="nv">$formFactory</span><span class="o">-&gt;</span><span class="na">createBuilder</span><span class="p">(</span><span class="nx">FormType</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/search&#39;</span><span class="p">,</span>
    <span class="s1">&#39;method&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
<span class="p">));</span>

<span class="c1">// ...</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>Framework Use</em><div class="literal-block"><div class="highlight-php-symfony"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/Acme/TaskBundle/Controller/DefaultController.php</span>
<span class="k">namespace</span> <span class="nx">Acme\TaskBundle\Controller</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Bundle\FrameworkBundle\Controller\Controller</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\FormType</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">DefaultController</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">searchAction</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$formBuilder</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createFormBuilder</span><span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/search&#39;</span><span class="p">,</span>
            <span class="s1">&#39;method&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
        <span class="p">));</span>

        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
</li>
</ul>
</div>
</div>
<div class="section" id="component-form-intro-handling-submission-ru">
<span id="id11"></span><h3>Обработка отправок формы<a class="headerlink" href="#component-form-intro-handling-submission-ru" title="Permalink to this headline">¶</a></h3>
<p>Чтобы обработать отправки формы, используйте метод <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/Form.html#method_handleRequest" title="Symfony\Component\Form\Form::handleRequest()">handleRequest()</a></code></tt>:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Standalone Use</em><div class="literal-block"><div class="highlight-php-standalone"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Request</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\RedirectResponse</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\DateType</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\TextType</span><span class="p">;</span>

<span class="c1">// ...</span>

<span class="nv">$form</span> <span class="o">=</span> <span class="nv">$formFactory</span><span class="o">-&gt;</span><span class="na">createBuilder</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;task&#39;</span><span class="p">,</span> <span class="nx">TextType</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;dueDate&#39;</span><span class="p">,</span> <span class="nx">DateType</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">getForm</span><span class="p">();</span>

<span class="nv">$request</span> <span class="o">=</span> <span class="nx">Request</span><span class="o">::</span><span class="na">createFromGlobals</span><span class="p">();</span>

<span class="nv">$form</span><span class="o">-&gt;</span><span class="na">handleRequest</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$form</span><span class="o">-&gt;</span><span class="na">isSubmitted</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nv">$form</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">())</span> <span class="p">{</span>
    <span class="nv">$data</span> <span class="o">=</span> <span class="nv">$form</span><span class="o">-&gt;</span><span class="na">getData</span><span class="p">();</span>

    <span class="c1">// ... выполнить некоторое действие, например, сохранить данные в БД</span>

    <span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RedirectResponse</span><span class="p">(</span><span class="s1">&#39;/task/success&#39;</span><span class="p">);</span>
    <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span>

    <span class="k">return</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// ...</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>Framework Use</em><div class="literal-block"><div class="highlight-php-symfony"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/Controller/TaskController.php</span>
<span class="k">namespace</span> <span class="nx">App\Controller</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Bundle\FrameworkBundle\Controller\Controller</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\DateType</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\TextType</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">TaskController</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">new</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$form</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createFormBuilder</span><span class="p">()</span>
            <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;task&#39;</span><span class="p">,</span> <span class="nx">TextType</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;dueDate&#39;</span><span class="p">,</span> <span class="nx">DateType</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">getForm</span><span class="p">();</span>

        <span class="nv">$form</span><span class="o">-&gt;</span><span class="na">handleRequest</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$form</span><span class="o">-&gt;</span><span class="na">isSubmitted</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nv">$form</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">())</span> <span class="p">{</span>
            <span class="nv">$data</span> <span class="o">=</span> <span class="nv">$form</span><span class="o">-&gt;</span><span class="na">getData</span><span class="p">();</span>

            <span class="c1">// ... выполнить некоторое действие, например, сохранить данные в БД</span>

            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirectToRoute</span><span class="p">(</span><span class="s1">&#39;task_success&#39;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
</li>
</ul>
</div>
<p>Это определяет общий &quot;Рабочий процесс&quot;, который содержит 3 разные возможности:</p>
<ol class="arabic simple">
<li>В изначальном запросе GET (т.е. когда пользователь заходит на вашу
страницу), постройте вашу форму и отобразите её;</li>
</ol>
<p>Если запрос - POST, рбработайте отправленные данные (через <tt class="docutils literal"><code>handleRequest()</code></tt>).
А потом:</p>
<ol class="arabic simple" start="2">
<li>если форма не валина, отобразите форму (которая теперь будет содержать ошибки);</li>
<li>если форма валидна, выполните некоторые действия и перенаправьте.</li>
</ol>
<p>К счастью, вам не надо решать, была ли отправлена форма. Просто передайте текущий
запрос методу <tt class="docutils literal"><code>handleRequest()</code></tt>. Далее компонент Форма сделает всю работу за вас.</p>
</div>
<div class="section" id="component-form-intro-validation-ru">
<span id="id12"></span><h3>Валидация форм<a class="headerlink" href="#component-form-intro-validation-ru" title="Permalink to this headline">¶</a></h3>
<p>Простейшим способом добавить валидацию к вашей форме - через опцию
<tt class="docutils literal"><code>constraints</code></tt> при построении каждого поля:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Standalone Use</em><div class="literal-block"><div class="highlight-php-standalone"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Validator\Constraints\NotBlank</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Validator\Constraints\Type</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\TextType</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\DateType</span><span class="p">;</span>

<span class="nv">$form</span> <span class="o">=</span> <span class="nv">$formFactory</span><span class="o">-&gt;</span><span class="na">createBuilder</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;task&#39;</span><span class="p">,</span> <span class="nx">TextType</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;constraints&#39;</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">NotBlank</span><span class="p">(),</span>
    <span class="p">))</span>
    <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;dueDate&#39;</span><span class="p">,</span> <span class="nx">DateType</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;constraints&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="k">new</span> <span class="nx">NotBlank</span><span class="p">(),</span>
            <span class="k">new</span> <span class="nx">Type</span><span class="p">(</span><span class="nx">\DateTime</span><span class="o">::</span><span class="na">class</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">))</span>
    <span class="o">-&gt;</span><span class="na">getForm</span><span class="p">();</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>Framework Use</em><div class="literal-block"><div class="highlight-php-symfony"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/Controller/DefaultController.php</span>
<span class="k">namespace</span> <span class="nx">App\Controller</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Bundle\FrameworkBundle\Controller\Controller</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Validator\Constraints\NotBlank</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Validator\Constraints\Type</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\DateType</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\TextType</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">DefaultController</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">newAction</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$form</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createFormBuilder</span><span class="p">()</span>
            <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;task&#39;</span><span class="p">,</span> <span class="nx">TextType</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;constraints&#39;</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">NotBlank</span><span class="p">(),</span>
            <span class="p">))</span>
            <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;dueDate&#39;</span><span class="p">,</span> <span class="nx">DateType</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;constraints&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                    <span class="k">new</span> <span class="nx">NotBlank</span><span class="p">(),</span>
                    <span class="k">new</span> <span class="nx">Type</span><span class="p">(</span><span class="nx">\DateTime</span><span class="o">::</span><span class="na">class</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">))</span>
            <span class="o">-&gt;</span><span class="na">getForm</span><span class="p">();</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
</li>
</ul>
</div>
<p>Когда форма привязана, эти ограничения валидации будут применены автоматически, а
ошибки отобразятся рядом с полями ошибок.</p>
<div class="admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p class="last">Чтобы увидеть список всех встроенных ограничений валидации, см.
<a class="reference internal" href="..\reference\constraints.html"><em>Validation Constraints Reference</em></a>.</p>
</div></div>
</div>
<div class="section" id="id13">
<h3>Доступ к ошибкам формы<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>Вы можете использовать метод <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/FormInterface.html#method_getErrors" title="Symfony\Component\Form\FormInterface::getErrors()">getErrors()</a></code></tt>,
чтобы получить доступ к списку ошибок. Он возвращает экземпляр
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/FormErrorIterator.html" title="Symfony\Component\Form\FormErrorIterator">FormErrorIterator</a></code></tt>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nv">$form</span> <span class="o">=</span> <span class="o">...</span><span class="p">;</span>

<span class="c1">// ...</span>

<span class="c1">// экземпляр FormErrorIterator, но только ошибки, связанные с этим</span>
<span class="c1">// уровнем формы (например, глобальные ошибки)</span>
<span class="nv">$errors</span> <span class="o">=</span> <span class="nv">$form</span><span class="o">-&gt;</span><span class="na">getErrors</span><span class="p">();</span>

<span class="c1">// экземпляр FormErrorIterator, но только ошибки, связанные с</span>
<span class="c1">// полем &quot;firstName&quot;</span>
<span class="nv">$errors</span> <span class="o">=</span> <span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;firstName&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">getErrors</span><span class="p">();</span>

<span class="c1">// экземпляр FormErrorIterator в плоской структуре</span>
<span class="c1">// использовать getOrigin(), чтобы определить форму, вызывающую ошибу</span>
<span class="nv">$errors</span> <span class="o">=</span> <span class="nv">$form</span><span class="o">-&gt;</span><span class="na">getErrors</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>

<span class="c1">// экземпляр FormErrorIterator, представляющий структуру древа формы</span>
<span class="nv">$errors</span> <span class="o">=</span> <span class="nv">$form</span><span class="o">-&gt;</span><span class="na">getErrors</span><span class="p">(</span><span class="k">true</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
</pre></div>
</td></tr></table></div></div>
</div>
<div class="section" id="clearing-form-errors">
<h3>Clearing Form Errors<a class="headerlink" href="#clearing-form-errors" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.2: </span>Метод <tt class="docutils literal"><code>clearErrors()</code></tt> появился в Symfony 4.2.</p>
</div>
<p>Все ошибки могут быть очищены вручную методом
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/ClearableErrorsInterface.html#method_clearErrors" title="Symfony\Component\Form\ClearableErrorsInterface::clearErrors()">clearErrors()</a></code></tt>.
Это удобно, если вы хотите провалидировать форму без отображения
ошибок валидации пользователю (например, при частичной отправке AJAX или
<a class="reference internal" href="..\form\dynamic_form_modification.html"><em>динамической модификации форм</em></a>).</p>
<p>Так как очистка ошибок делает форму валидной, <tt class="docutils literal"><code>clearErrors()</code></tt> должен
вызываться только после проверки того, что форма валидная.</p>
</div>
</div>
<div class="section" id="id14">
<h2>Узнайте больше<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="..\form\action_method.html">How to Change the Action and Method of a Form</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/action_method-ru.html">Как изменить действие и метод формы</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\bootstrap4.html">Bootstrap 4 Form Theme</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\button_based_validation.html">How to Choose Validation Groups Based on the Clicked Button</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/button_based_validation-ru.html">Как выбирать группы валидации, основанные на нажатой кнопке</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\create_custom_field_type.html">How to Create a Custom Form Field Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/create_custom_field_type-ru.html">Как создать пользовательский тип поля формы</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\create_form_type_extension.html">How to Create a Form Type Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/create_form_type_extension-ru.html">Как создать расширение типа формы</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\data_based_validation.html">How to Choose Validation Groups Based on the Submitted Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/data_based_validation-ru.html">Как выбирать группы валидации, основанные на отправленных данных</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\data_transformers.html">How to Use Data Transformers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/data_transformers-ru.html">Как использовать преобразователи данных</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\direct_submit.html">How to Use the submit() Function to Handle Form Submissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/direct_submit-ru.html">Как использовать функцию submit() для обработки отправки форм</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\disabling_validation.html">How to Disable the Validation of Submitted Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/disabling_validation-ru.html">Как отключить валидацию отправленных данных</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\dynamic_form_modification.html">How to Dynamically Modify Forms Using Form Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/dynamic_form_modification-ru.html">Как динамически модифицировать формы, используя события форм</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\embedded.html">How to Embed Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/embedded-ru.html">Как встраивать формы</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\events.html">Form Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/events-ru.html">События формы</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\form_collections.html">How to Embed a Collection of Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/form_collections-ru.html">Как встроить коллекцию форм</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\form_customization.html">How to Customize Form Rendering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/form_customization-ru.html">Как настроить отображение формы</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\form_dependencies.html">How to Access Services or Config from Inside a Form</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/form_dependencies-ru.html">Как получить доступ к сервисам или конфигурации изнутри формы</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\form_themes.html">How to Work with Form Themes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/form_themes-ru.html">Как работать с темами формы</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\inherit_data_option.html">How to Reduce Code Duplication with &quot;inherit_data&quot;</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/inherit_data_option-ru.html">Как уменьшить дублирование кода с помощью &quot;inherit_data&quot;</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\multiple_buttons.html">How to Submit a Form with Multiple Buttons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/multiple_buttons-ru.html">Как отправить форму с несколькими кнопками</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\rendering.html">How to Control the Rendering of a Form</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/rendering-ru.html">Как контролировать отображение в форме</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\type_guesser.html">Creating a custom Type Guesser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/type_guesser-ru.html">Создание пользовательского отгадывателя типа</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\unit_testing.html">How to Unit Test your Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/unit_testing-ru.html">Как проводить модульное тестирование ваших форм</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\use_empty_data.html">How to Configure empty Data for a Form Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/use_empty_data-ru.html">Как сконфигурировать пустые данные для класса формы</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\validation_group_service_resolver.html">How to Dynamically Configure Form Validation Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/validation_group_service_resolver-ru.html">Как сконфигурировать динамические группы валидации</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\validation_groups.html">How to Define the Validation Groups to Use</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/validation_groups-ru.html">Как определить, какие группы валидации использовать</a></li>
<li class="toctree-l1"><a class="reference internal" href="..\form\without_class.html">How to Use a Form without a Data Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../form/without_class-ru.html">Как использовать форму без класса данных</a></li>
</ul>
</div>
</div>
</div>


            </div>

            
            <div class="navigation">
                <a href="form.html">« The Form Component</a>
                <span class="separator">|</span>
                <a href="http_foundation.html">The HttpFoundation Component »</a>
            </div>
            

            <div id="license">
                <p>Эта документация является переводом <a href="http://symfony.com/doc/current/index.html">официальной документации Symfony</a> и предоставляется по свободной лицензии <a rel="license nofollow" href="https://creativecommons.org/licenses/by-sa/3.0/deed.ru">CC BY-SA 3.0</a>.</p>
            </div>
        </div>
    </div>
</div></div>


  </body>
</body></html>