<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    <title>Помощник Question &mdash; Symfony Framework Documentation  documentation</title>
    
    <link rel="stylesheet" href="../../../_static/" type="text/css">
    <link rel="stylesheet" href="..\..\..\_static\pygments.css" type="text/css">
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <link rel="top" title="Symfony Framework Documentation  documentation" href="..\..\..\index.html">

<link rel="stylesheet" href="..\..\..\_assets\app.css?v=8d6d457a0820d7c245bddae16bfd4c75">
<script src="..\..\..\_assets\manifest.js?v=d41d8cd98f00b204e980"></script>
<script src="..\..\..\_assets\app.js?v=900984040c7cb4dca514"></script>
<style>
    .header__top .container {
        overflow: hidden;
        padding-top: 10px;
        padding-bottom: 10px;
    }
    .header__top .header__logo {
        float: left;
    }
    .header__top .header__support {
        float: right;
    }

    .highlight .k, .highlight .gh, .highlight .gp,
    .highlight .gu, .highlight .kc, .highlight .kd,
    .highlight .kn, .highlight .kr, .highlight .nc,
    .highlight .nd, .highlight .ni, .highlight .nl,
    .highlight .nn, .highlight .nt, .highlight .ow,
    .highlight .se { font-weight: normal; }

    .highlight .c, .highlight .cm, .highlight .c1,
    .highlight .sd, .highlight .si { font-style: normal; }

    .doc { background: none; }
    #demo-warning {
        border: 3px dashed #c00;
        padding: 10px;
        margin-bottom: 30px;
    }
    #demo-warning h4 { font-size: 1.7em;font-weight: bold; }
    #demo-warning p { margin-bottom: 0; }
</style>

<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-107764519-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-107764519-1');
</script>

<!-- Facebook Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '250281335689441');
    fbq('track', 'PageView');
</script>
<img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=250281335689441&ev=PageView&noscript=1">
<!-- End Facebook Pixel Code -->

<script type="text/javascript">!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://vk.com/js/api/openapi.js?159",t.onload=function(){VK.Retargeting.Init("VK-RTRG-279161-8p6Jv"),VK.Retargeting.Hit()},document.head.appendChild(t)}();</script><img src="https://vk.com/rtrg?p=VK-RTRG-279161-8p6Jv" style="position:fixed; left:-999px;" alt="">


  </head>
  <body role="document">

<body class="components doc_article doc">

<header>
    <section class="header__top">
        <div class="container">
            <div class="header__logo">
                <a href="..\..\..\..\..\index.html">
                    <img src="..\..\..\..\..\_images\header-logo.svg" alt="Symfony.com.ua logo">
                </a>
            </div>
            <div class="header__support hidden-xs">
                <a href="http://playtini.ua/" title="Компания Playtini">
                    <img height="69" src="..\..\..\..\..\_images\support.png" alt="Symfony is a SensioLabs product">
                </a>
            </div>
        </div>
    </section>
</header>

<div class="container"><div id="page-content">
    <div class="row">
        <div id="sidebar" class="col-sm-3">
            <div id="sidebar-content"><div class="submenu">
    
    
    <ul class="list_submenu list-unstyled">
    
        <li class="first">
            <a href="..\..\..\index.html">Главная</a>
        </li>
    
        <li>
            <a href="..\..\index.html">Компоненты</a>
        </li>
    
        <li>
            <a href="..\..\..\best_practices\index.html">Лучшие практики</a>
        </li>
    
        <li>
            <a href="..\..\..\quick_tour\index.html">Быстрый старт</a>
        </li>
    
        <li>
            <a href="..\..\..\reference\index.html">Справочник</a>
        </li>
    
        <li>
            <a href="..\..\..\genindex.html">Индекс</a>
        </li>
    
        <li>
            <a href="..\..\..\contributing\index.html">Участие</a>
        </li>
    
    </ul>
</div>

                <div class="toc"> 
    <h4>Содержание</h4>
    <div class="toc-content">
        <ul>
<li><a class="reference internal" href="#">Помощник Question</a><ul>
<li><a class="reference internal" href="#id1">Запрос подтверждения от пользователя</a></li>
<li><a class="reference internal" href="#id2">Запрос информации у пользователя</a><ul>
<li><a class="reference internal" href="#id3">Позвольте пользователю выбирать из списка ответов</a><ul>
<li><a class="reference internal" href="#id4">Множественный выбор</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id5">Автозаполнение</a></li>
<li><a class="reference internal" href="#id6">Скрытие ответов пользователя</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7">Нормализация ответа</a></li>
<li><a class="reference internal" href="#id8">Валидация ответа</a><ul>
<li><a class="reference internal" href="#id9">Валидация скрытых ответов</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id10">Тестирования команды, ожидающей ввода</a></li>
</ul>
</li>
</ul>

    </div>
</div>
                
            </div>

            <div class="ads m-b-30">
                <h2>Вакансии Playtini</h2>
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/php-dev">
                            Middle+ PHP Developer/Symfony
                        </a>
                    </h3>
                    <div><b>Playtini</b> активно поддерживает и развивает свои продукты, и профессионализм команды. И на данный момент в поиске специалиста на позицию <b>«Middle+ PHP Developer/Symfony»,</b> который улучшит качество внутренних сервисов компании и увеличит их количество.</div>
                </div>
                <!--
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/symfony-senior">
                            Senior PHP Developer/Symfony
                        </a>
                    </h3>
                    <div>We are looking for strong, experienced <b>Senior PHP Developer/Symfony.</b> We expect him/her to participate in improving and extending a system built using microservice architecture by means of modern technologies.</div>
                </div>
                -->
                <div class="ad">
                    <h3><a href="http://playtini.ua/careers">
                        Остальные вакансии компании
                        <img src="..\..\..\..\..\_images\logo-playtini.png" alt="Playtini">
                    </a></h3>
                </div>
            </div>
        </div>

        <div id="main" class="col-sm-9">
            <ol class="breadcrumb">
                
                <li><a href="..\..\..\index.html">Документация</a></li>
                
                <li class="active">Помощник Question</li>
            </ol>

            <div class="page">
                
  <div class="section" id="question">
<span id="index-0"></span><h1>Помощник Question<a class="headerlink" href="#question" title="Permalink to this headline">¶</a></h1>
<p><tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Helper/QuestionHelper.html" title="Symfony\Component\Console\Helper\QuestionHelper">QuestionHelper</a></code></tt> предоставляет функции
для того, чтобы запросить у пользователя больше информации. Он включён в набор
помощников по умолчанию, который можете увидеть, вызвав
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Command/Command.html#method_getHelperSet" title="Symfony\Component\Console\Command\Command::getHelperSet()">getHelperSet()</a></code></tt>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nv">$helper</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getHelper</span><span class="p">(</span><span class="s1">&#39;question&#39;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div></div>
<p>Помощник Question Helper имеет единственный метод
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Command/Command.html#method_ask" title="Symfony\Component\Console\Command\Command::ask()">ask()</a></code></tt>, которому нужен
экземпляр <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Input/InputInterface.html" title="Symfony\Component\Console\Input\InputInterface">InputInterface</a></code></tt> в
качестве первого аргумента, экземпляр
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Output/OutputInterface.html" title="Symfony\Component\Console\Output\OutputInterface">OutputInterface</a></code></tt> - в качестве второго,
и <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Question/Question.html" title="Symfony\Component\Console\Question\Question">Question</a></code></tt> в качестве последнего
аргумента.</p>
<div class="section" id="id1">
<h2>Запрос подтверждения от пользователя<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Предположим, что вы хотите подтвердить действие перед тем, как его
выполнять. Добавьте в вашу команду следующее:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// ...</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Console\Input\InputInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Console\Output\OutputInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Console\Question\ConfirmationQuestion</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">YourCommand</span> <span class="k">extends</span> <span class="nx">Command</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">(</span><span class="nx">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="nx">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$helper</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getHelper</span><span class="p">(</span><span class="s1">&#39;question&#39;</span><span class="p">);</span>
        <span class="nv">$question</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ConfirmationQuestion</span><span class="p">(</span><span class="s1">&#39;Continue with this action?&#39;</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$helper</span><span class="o">-&gt;</span><span class="na">ask</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="nv">$output</span><span class="p">,</span> <span class="nv">$question</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>В этом случае, пользователя спросят &quot;Вы хотите продолжить это действие?&quot;. Если
пользователь ответит <tt class="docutils literal"><code>y</code></tt>, то вернётся <tt class="docutils literal"><code>true</code></tt>, а <tt class="docutils literal"><code>false``вернётся, если ответ
будет ``n</code></tt>.
Второй аргумент метода
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Question/ConfirmationQuestion.html#method___construct" title="Symfony\Component\Console\Question\ConfirmationQuestion::__construct()">__construct()</a></code></tt>
- это значение по умолчанию, которое стоит вернуть, если пользователь введёт невалидное
значение ввода. Если второй аргумент не предоставлен, то предполагается <tt class="docutils literal"><code>true</code></tt>.</p>
<div class="admonition-wrapper">
<div class="tip"></div><div class="admonition admonition-tip"><p class="first admonition-title">Tip</p>
<p>Вы можете настроить используемое регулярное выражение так, чтобы проверять,
означает ли ответ &quot;yes&quot;, в третьем аргументе консруктора. Например, чтобы
разрешить всё, что начинается с <tt class="docutils literal"><code>y</code></tt> или <tt class="docutils literal"><code>j</code></tt>, вам нужно установить его так:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nv">$question</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ConfirmationQuestion</span><span class="p">(</span>
    <span class="s1">&#39;Continue with this action?&#39;</span><span class="p">,</span>
    <span class="k">false</span><span class="p">,</span>
    <span class="s1">&#39;/^(y|j)/i&#39;</span>
<span class="p">);</span>
</pre></div>
</td></tr></table></div></div>
<p class="last">Регулярное выражение по умолчанию - <tt class="docutils literal"><code>/^y/i</code></tt>.</p>
</div></div>
</div>
<div class="section" id="id2">
<h2>Запрос информации у пользователя<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Вы также можете задать вопрос с более сложным ответом, чем да/нет. Например,
если вы хотите узнать имя пакета, вы можете добавить в вашу команду следующее:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Console\Question\Question</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">(</span><span class="nx">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="nx">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="nv">$question</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Question</span><span class="p">(</span><span class="s1">&#39;Please enter the name of the bundle&#39;</span><span class="p">,</span> <span class="s1">&#39;AcmeDemoBundle&#39;</span><span class="p">);</span>

    <span class="nv">$bundleName</span> <span class="o">=</span> <span class="nv">$helper</span><span class="o">-&gt;</span><span class="na">ask</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="nv">$output</span><span class="p">,</span> <span class="nv">$question</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>Пользователя попросят &quot;Пожалуйста, введите имя пакета&quot;. Он может ввести какое-то
имя, которое будет возвращено методом
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Helper/QuestionHelper.html#method_ask" title="Symfony\Component\Console\Helper\QuestionHelper::ask()">ask()</a></code></tt>. Если он
оставит поле пустым, то будет возвращено значение по умолчанию (здесь - <tt class="docutils literal"><code>AcmeDemoBundle</code></tt>).</p>
<div class="section" id="id3">
<h3>Позвольте пользователю выбирать из списка ответов<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Если у вас есть предопределённый набор ответов, из которого пользователь
может выбирать, вы можете использовать <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Question/ChoiceQuestion.html" title="Symfony\Component\Console\Question\ChoiceQuestion">ChoiceQuestion</a></code></tt>,
который гарантирует, что пользователь может вводить только валидную строку
из предопределённого списка:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Console\Question\ChoiceQuestion</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">(</span><span class="nx">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="nx">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="nv">$helper</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getHelper</span><span class="p">(</span><span class="s1">&#39;question&#39;</span><span class="p">);</span>
    <span class="nv">$question</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ChoiceQuestion</span><span class="p">(</span>
        <span class="s1">&#39;Пожалуйста, выберите ваш любимый цвет (по умолчанию красный)&#39;</span><span class="p">,</span>
        <span class="k">array</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">),</span>
        <span class="mi">0</span>
    <span class="p">);</span>
    <span class="nv">$question</span><span class="o">-&gt;</span><span class="na">setErrorMessage</span><span class="p">(</span><span class="s1">&#39;Color %s is invalid.&#39;</span><span class="p">);</span>

    <span class="nv">$color</span> <span class="o">=</span> <span class="nv">$helper</span><span class="o">-&gt;</span><span class="na">ask</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="nv">$output</span><span class="p">,</span> <span class="nv">$question</span><span class="p">);</span>
    <span class="nv">$output</span><span class="o">-&gt;</span><span class="na">writeln</span><span class="p">(</span><span class="s1">&#39;Вы только что выбрали: &#39;</span><span class="o">.</span><span class="nv">$color</span><span class="p">);</span>

    <span class="c1">// ... сделать что-то с цветом</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>Опция, выбранная по умолчанию, предоставляется третьим аргументом конструктора.
По умолчанию она <tt class="docutils literal"><code>null</code></tt>, что означает, что опции по умолчанию нет.</p>
<p>Если пользователь вводит невалидную строку, отображается сообщение об ошибке и
пользователя попросят предоставить ответ ещё раз, до тех пор, пока он не введёт
влидную строку или не достигнет максимального количества попыток. Значение по
умолчанию для максимального количества попыток - <tt class="docutils literal"><code>null</code></tt>, что означает бесконечное
количество попыток. Вы можете определить ваше собственное сообщение об ошибке,
используя
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Question/ChoiceQuestion.html#method_setErrorMessage" title="Symfony\Component\Console\Question\ChoiceQuestion::setErrorMessage()">setErrorMessage()</a></code></tt>.</p>
<div class="section" id="id4">
<h4>Множественный выбор<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Иногда можно предоставить несколько ответов. <tt class="docutils literal"><code>ChoiceQuestion</code></tt> предлагает такую
функцию, используя значения, разделённые запятыми. По умолчанию это отключено,
чтобы подключить, используйте <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Question/ChoiceQuestion.html#method_setMultiselect" title="Symfony\Component\Console\Question\ChoiceQuestion::setMultiselect()">setMultiselect()</a></code></tt>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Console\Question\ChoiceQuestion</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">(</span><span class="nx">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="nx">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="nv">$helper</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getHelper</span><span class="p">(</span><span class="s1">&#39;question&#39;</span><span class="p">);</span>
    <span class="nv">$question</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ChoiceQuestion</span><span class="p">(</span>
        <span class="s1">&#39;Пожалуйста, выберите ваши любимые цвета (по умолчанию красный и синий)&#39;</span><span class="p">,</span>
        <span class="k">array</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">),</span>
        <span class="s1">&#39;0,1&#39;</span>
    <span class="p">);</span>
    <span class="nv">$question</span><span class="o">-&gt;</span><span class="na">setMultiselect</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>

    <span class="nv">$colors</span> <span class="o">=</span> <span class="nv">$helper</span><span class="o">-&gt;</span><span class="na">ask</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="nv">$output</span><span class="p">,</span> <span class="nv">$question</span><span class="p">);</span>
    <span class="nv">$output</span><span class="o">-&gt;</span><span class="na">writeln</span><span class="p">(</span><span class="s1">&#39;Вы только что выбрали: &#39;</span> <span class="o">.</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="nv">$colors</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>Теперь, когда пользователь вводит <tt class="docutils literal"><code>1,2</code></tt>, результатом будет:
<tt class="docutils literal"><code>Вы только что выбрали: синий, желтый</code></tt>.</p>
<p>Если пользователь не введёт ничего, то результат будет:
<tt class="docutils literal"><code>Вы только что выбрали: красный, синий</code></tt>.</p>
</div>
</div>
<div class="section" id="id5">
<h3>Автозаполнение<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>Вы также можете указать массив потенциальных ответов для заданных вопросов.
Они будут автозаполнены во время того, как пользователь будет печатать:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Console\Question\Question</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">(</span><span class="nx">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="nx">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="nv">$helper</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getHelper</span><span class="p">(</span><span class="s1">&#39;question&#39;</span><span class="p">);</span>

    <span class="nv">$bundles</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;AcmeDemoBundle&#39;</span><span class="p">,</span> <span class="s1">&#39;AcmeBlogBundle&#39;</span><span class="p">,</span> <span class="s1">&#39;AcmeStoreBundle&#39;</span><span class="p">);</span>
    <span class="nv">$question</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Question</span><span class="p">(</span><span class="s1">&#39;Пожалуйста, введите имя пакета&#39;</span><span class="p">,</span> <span class="s1">&#39;FooBundle&#39;</span><span class="p">);</span>
    <span class="nv">$question</span><span class="o">-&gt;</span><span class="na">setAutocompleterValues</span><span class="p">(</span><span class="nv">$bundles</span><span class="p">);</span>

    <span class="nv">$bundleName</span> <span class="o">=</span> <span class="nv">$helper</span><span class="o">-&gt;</span><span class="na">ask</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="nv">$output</span><span class="p">,</span> <span class="nv">$question</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
</div>
<div class="section" id="id6">
<h3>Скрытие ответов пользователя<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>Вы также можете задавать вопрос и скрывать ответ. Это особенно полезно
для паролей:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Console\Question\Question</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">(</span><span class="nx">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="nx">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="nv">$helper</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getHelper</span><span class="p">(</span><span class="s1">&#39;question&#39;</span><span class="p">);</span>

    <span class="nv">$question</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Question</span><span class="p">(</span><span class="s1">&#39;Какой пароль БД?&#39;</span><span class="p">);</span>
    <span class="nv">$question</span><span class="o">-&gt;</span><span class="na">setHidden</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
    <span class="nv">$question</span><span class="o">-&gt;</span><span class="na">setHiddenFallback</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>

    <span class="nv">$password</span> <span class="o">=</span> <span class="nv">$helper</span><span class="o">-&gt;</span><span class="na">ask</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="nv">$output</span><span class="p">,</span> <span class="nv">$question</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<div class="admonition-wrapper">
<div class="caution"></div><div class="admonition admonition-caution"><p class="first admonition-title">Caution</p>
<p class="last">Когда вы запрашиваете скрытый ответ, Symfony будет использовать либо бинарный
режим изменения stty, либо другой фокус для скрытия ответа. Если ничего недоступно,
то будет использован резервный план и ответ будет видимым, кроме случаев, если
выустановите это поведение, как <tt class="docutils literal"><code>false</code></tt>, используя
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Question/Question.html#method_setHiddenFallback" title="Symfony\Component\Console\Question\Question::setHiddenFallback()">setHiddenFallback()</a></code></tt>,
как в примере выше. В этом случае, будет вызвано <tt class="docutils literal"><code>RuntimeException</code></tt>.</p>
</div></div>
<div class="admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p>Команда <tt class="docutils literal"><code>stty</code></tt> используется для получения и установки свойств командной
строки (вроде получения количества строк и столбцов или скрытия текста ввода).
В системах Windows, команда <tt class="docutils literal"><code>stty</code></tt> может генерировать тарабарский вывод и
коверкать текст ввода. Если это ваш случай, отключите это с помощью данной
команды:</p>
<div class="literal-block"><div class="last highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Console\Helper\QuestionHelper</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Console\Question\ChoiceQuestion</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">(</span><span class="nx">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="nx">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="nv">$helper</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getHelper</span><span class="p">(</span><span class="s1">&#39;question&#39;</span><span class="p">);</span>
    <span class="nx">QuestionHelper</span><span class="o">::</span><span class="na">disableStty</span><span class="p">();</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
</div></div>
</div>
</div>
<div class="section" id="id7">
<h2>Нормализация ответа<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>Перед валидацией ответа вы можете &quot;нормализовать&quot; его, чтобы исправить мелкие
ошибки или подстроить его по необходимости. Например, в предыдущем примере вы
спрашивали имя пакета. В случае, если пользователь добавляет пробелы вокруг имени
по ошибке, вы можете обрезать имя перед его валидацией. Чтобы сделать это,
сконфигурируйте нормализатор, используя метод
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Question/Question.html#method_setNormalizer" title="Symfony\Component\Console\Question\Question::setNormalizer()">setNormalizer()</a></code></tt>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Console\Question\Question</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">(</span><span class="nx">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="nx">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="nv">$helper</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getHelper</span><span class="p">(</span><span class="s1">&#39;question&#39;</span><span class="p">);</span>

    <span class="nv">$question</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Question</span><span class="p">(</span><span class="s1">&#39;Пожалуйста, введите имя пакета&#39;</span><span class="p">,</span> <span class="s1">&#39;AcmeDemoBundle&#39;</span><span class="p">);</span>
    <span class="nv">$question</span><span class="o">-&gt;</span><span class="na">setNormalizer</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// $value здесь может быть null</span>
        <span class="k">return</span> <span class="nv">$value</span> <span class="o">?</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="nv">$bundleName</span> <span class="o">=</span> <span class="nv">$helper</span><span class="o">-&gt;</span><span class="na">ask</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="nv">$output</span><span class="p">,</span> <span class="nv">$question</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<div class="admonition-wrapper">
<div class="caution"></div><div class="admonition admonition-caution"><p class="first admonition-title">Caution</p>
<p class="last">Вначале вызывается нормализатор, а возвращённое значение используется в качестве
ввода валидатора. Если ответ невалиден, не вызывайте исключений в нормализаторе
и позвольте валидатору обработать эти ошибки.</p>
</div></div>
</div>
<div class="section" id="id8">
<h2>Валидация ответа<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<p>Вы можете даже валидировать ответ. К прмиеру, в предыдущем примере вы спрашивали
имя пакета. Следуя соглашениию именования Symfony, оно должно иметь суффикс <tt class="docutils literal"><code>Bundle</code></tt>.
Вы можете валидировать это, используя метод
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Question/Question.html#method_setValidator" title="Symfony\Component\Console\Question\Question::setValidator()">setValidator()</a></code></tt>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Console\Question\Question</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">(</span><span class="nx">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="nx">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="nv">$helper</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getHelper</span><span class="p">(</span><span class="s1">&#39;question&#39;</span><span class="p">);</span>

    <span class="nv">$question</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Question</span><span class="p">(</span><span class="s1">&#39;Пожалуйста, введите имя пакета&#39;</span><span class="p">,</span> <span class="s1">&#39;AcmeDemoBundle&#39;</span><span class="p">);</span>
    <span class="nv">$question</span><span class="o">-&gt;</span><span class="na">setValidator</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$answer</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_string</span><span class="p">(</span><span class="nv">$answer</span><span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;Bundle&#39;</span> <span class="o">!==</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$answer</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">\RuntimeException</span><span class="p">(</span>
                <span class="s1">&#39;Имя пакета должно иметь суффикс \&#39;Bundle\&#39;&#39;</span>
            <span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$answer</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="nv">$question</span><span class="o">-&gt;</span><span class="na">setMaxAttempts</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

    <span class="nv">$bundleName</span> <span class="o">=</span> <span class="nv">$helper</span><span class="o">-&gt;</span><span class="na">ask</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="nv">$output</span><span class="p">,</span> <span class="nv">$question</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p><tt class="docutils literal"><code>$validator</code></tt> - это обратный вызов, который работает с валидацией. Он должен вызвать
исключение, если что-то пошло не так. Сообщение об исключении отображается в консоли,
поэтому хорошей практикой будет разместить в нём полезную информацию. Функция обратного
вызова должна также возвращать значение ввода пользователя, если валидация была успешной.</p>
<p>Вы можете установить максимальное количество повторений вопроса с помощью метода
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Question/Question.html#method_setMaxAttempts" title="Symfony\Component\Console\Question\Question::setMaxAttempts()">setMaxAttempts()</a></code></tt>. Если
вы достигните максимального количества, то будет использовано значение по умолчанию.
Использования <tt class="docutils literal"><code>null</code></tt> означает бесконечное количество попыток. Пользователя будут
спрашивать до тех пор, пока он не предоставит валидный ответ, и только тогда он
сможет продолжать.</p>
<div class="section" id="id9">
<h3>Валидация скрытых ответов<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>Вы также можете использовать валидатор со скрытым вопросом:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Console\Question\Question</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">(</span><span class="nx">InputInterface</span> <span class="nv">$input</span><span class="p">,</span> <span class="nx">OutputInterface</span> <span class="nv">$output</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="nv">$helper</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getHelper</span><span class="p">(</span><span class="s1">&#39;question&#39;</span><span class="p">);</span>

    <span class="nv">$question</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Question</span><span class="p">(</span><span class="s1">&#39;Пожалуйста, введите ваш пароль&#39;</span><span class="p">);</span>
    <span class="nv">$question</span><span class="o">-&gt;</span><span class="na">setValidator</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s1">&#39;Пароль не может быть пустым&#39;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$value</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="nv">$question</span><span class="o">-&gt;</span><span class="na">setHidden</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
    <span class="nv">$question</span><span class="o">-&gt;</span><span class="na">setMaxAttempts</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>

    <span class="nv">$password</span> <span class="o">=</span> <span class="nv">$helper</span><span class="o">-&gt;</span><span class="na">ask</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="nv">$output</span><span class="p">,</span> <span class="nv">$question</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
</div>
</div>
<div class="section" id="id10">
<h2>Тестирования команды, ожидающей ввода<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<p>Если вы хотите написать модульный тест для команды, ожидающей какого-либо ввода
из командной строки, то вам нужно установить ввод, который будет ожидать команда:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Console\Helper\QuestionHelper</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Console\Helper\HelperSet</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Console\Tester\CommandTester</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">testExecute</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="nv">$commandTester</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CommandTester</span><span class="p">(</span><span class="nv">$command</span><span class="p">);</span>

    <span class="c1">// Эквивалентно вводу пользователем &quot;Test&quot; и нажатию ENTER</span>
    <span class="nv">$commandTester</span><span class="o">-&gt;</span><span class="na">setInputs</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;Test&#39;</span><span class="p">));</span>

    <span class="c1">// Эквивалентно вводу пользователем  &quot;This&quot;, &quot;That&quot; и нажатию ENTER</span>
    <span class="c1">// Может быть использовано для ответа на два разных вопроса, к примеру</span>
    <span class="nv">$commandTester</span><span class="o">-&gt;</span><span class="na">setInputs</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;This&#39;</span><span class="p">,</span> <span class="s1">&#39;That&#39;</span><span class="p">));</span>

    <span class="c1">// Для симуляции положительного ответа на вопрос подтверждения, будет работать</span>
    <span class="c1">// дополнительный ввод &quot;yes&quot;</span>
    <span class="nv">$commandTester</span><span class="o">-&gt;</span><span class="na">setInputs</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;yes&#39;</span><span class="p">));</span>

    <span class="nv">$commandTester</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;command&#39;</span> <span class="o">=&gt;</span> <span class="nv">$command</span><span class="o">-&gt;</span><span class="na">getName</span><span class="p">()));</span>

    <span class="c1">// $this-&gt;assertRegExp(&#39;/.../&#39;, $commandTester-&gt;getDisplay());</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>Вызвав <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Tester/CommandTester.html#method_setInputs" title="Symfony\Component\Console\Tester\CommandTester::setInputs()">setInputs()</a></code></tt>, вы
имитируете то, что консоль будет делать внутренне со всем вводом пользователя через CLI.
Этот метод берёт массив в качестве единственного аргумента для каждого ожидаемого командой
ввода, вместе со строкой, представляющей то, что напечатает пользователь.
Таким образом вы можете тестировать любое взаимодействие пользователя (даже сложные),
передавая соответствующие вводы.</p>
<div class="admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p class="last">Класс <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Console/Tester/CommandTester.html" title="Symfony\Component\Console\Tester\CommandTester">CommandTester</a></code></tt> автоматически
симулирует нажатие пользователем <tt class="docutils literal"><code>ENTER</code></tt> после каждого ввода, необходимости
передавать дополнительный ввод нет.</p>
</div></div>
<div class="admonition-wrapper">
<div class="caution"></div><div class="admonition admonition-caution"><p class="first admonition-title">Caution</p>
<p class="last">В системах Windows Symfony использует специальную бинарность, чтобы реализовать
скрытые вопросы. Это означает, что такие вопросы не используют объект консоли
по умолчанию <tt class="docutils literal"><code>Input</code></tt>, и следовательно вы не можете тестировать его в Windows.</p>
</div></div>
</div>
</div>


            </div>

            

            <div id="license">
                <p>Эта документация является переводом <a href="http://symfony.com/doc/current/index.html">официальной документации Symfony</a> и предоставляется по свободной лицензии <a rel="license nofollow" href="https://creativecommons.org/licenses/by-sa/3.0/deed.ru">CC BY-SA 3.0</a>.</p>
            </div>
        </div>
    </div>
</div></div>


  </body>
</body></html>