<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    <title>Расширения разрешения аргумента действия &mdash; Symfony Framework Documentation  documentation</title>
    
    <link rel="stylesheet" href="../_static/" type="text/css">
    <link rel="stylesheet" href="..\_static\pygments.css" type="text/css">
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <link rel="top" title="Symfony Framework Documentation  documentation" href="..\index.html">
    <link rel="up" title="Controller" href="..\controller.html">
    <link rel="next" title="How to Customize Error Pages" href="error_pages.html">
    <link rel="prev" title="Extending Action Argument Resolving" href="argument_value_resolver.html">

<link rel="stylesheet" href="..\_assets\app.css?v=8d6d457a0820d7c245bddae16bfd4c75">
<script src="..\_assets\manifest.js?v=d41d8cd98f00b204e980"></script>
<script src="..\_assets\app.js?v=900984040c7cb4dca514"></script>
<style>
    .header__top .container {
        overflow: hidden;
        padding-top: 10px;
        padding-bottom: 10px;
    }
    .header__top .header__logo {
        float: left;
    }
    .header__top .header__support {
        float: right;
    }

    .highlight .k, .highlight .gh, .highlight .gp,
    .highlight .gu, .highlight .kc, .highlight .kd,
    .highlight .kn, .highlight .kr, .highlight .nc,
    .highlight .nd, .highlight .ni, .highlight .nl,
    .highlight .nn, .highlight .nt, .highlight .ow,
    .highlight .se { font-weight: normal; }

    .highlight .c, .highlight .cm, .highlight .c1,
    .highlight .sd, .highlight .si { font-style: normal; }

    .doc { background: none; }
    #demo-warning {
        border: 3px dashed #c00;
        padding: 10px;
        margin-bottom: 30px;
    }
    #demo-warning h4 { font-size: 1.7em;font-weight: bold; }
    #demo-warning p { margin-bottom: 0; }
</style>

<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-107764519-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-107764519-1');
</script>

<!-- Facebook Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '250281335689441');
    fbq('track', 'PageView');
</script>
<img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=250281335689441&ev=PageView&noscript=1">
<!-- End Facebook Pixel Code -->

<script type="text/javascript">!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://vk.com/js/api/openapi.js?159",t.onload=function(){VK.Retargeting.Init("VK-RTRG-279161-8p6Jv"),VK.Retargeting.Hit()},document.head.appendChild(t)}();</script><img src="https://vk.com/rtrg?p=VK-RTRG-279161-8p6Jv" style="position:fixed; left:-999px;" alt="">


  </head>
  <body role="document">

<body class="controller doc_article doc">

<header>
    <section class="header__top">
        <div class="container">
            <div class="header__logo">
                <a href="..\..\..\index.html">
                    <img src="..\..\..\_images\header-logo.svg" alt="Symfony.com.ua logo">
                </a>
            </div>
            <div class="header__support hidden-xs">
                <a href="http://playtini.ua/" title="Компания Playtini">
                    <img height="69" src="..\..\..\_images\support.png" alt="Symfony is a SensioLabs product">
                </a>
            </div>
        </div>
    </section>
</header>

<div class="container"><div id="page-content">
    <div class="row">
        <div id="sidebar" class="col-sm-3">
            <div id="sidebar-content"><div class="submenu">
    
    
    <ul class="list_submenu list-unstyled">
    
        <li class="first">
            <a href="..\index.html">Главная</a>
        </li>
    
        <li>
            <a href="..\components\index.html">Компоненты</a>
        </li>
    
        <li>
            <a href="..\best_practices\index.html">Лучшие практики</a>
        </li>
    
        <li>
            <a href="..\quick_tour\index.html">Быстрый старт</a>
        </li>
    
        <li>
            <a href="..\reference\index.html">Справочник</a>
        </li>
    
        <li>
            <a href="..\genindex.html">Индекс</a>
        </li>
    
        <li>
            <a href="..\contributing\index.html">Участие</a>
        </li>
    
    </ul>
</div>

                <div class="toc"> 
    <h4>Содержание</h4>
    <div class="toc-content">
        <ul>
<li><a class="reference internal" href="#">Расширения разрешения аргумента действия</a><ul>
<li><a class="reference internal" href="#httpkernel">Функциональность, поставляемая с HttpKernel</a></li>
<li><a class="reference internal" href="#id2">Добавление пользовательского разрешителя значения</a></li>
</ul>
</li>
</ul>

    </div>
</div>
                
            </div>

            <div class="ads m-b-30">
                <h2>Вакансии Playtini</h2>
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/php-dev">
                            Middle+ PHP Developer/Symfony
                        </a>
                    </h3>
                    <div><b>Playtini</b> активно поддерживает и развивает свои продукты, и профессионализм команды. И на данный момент в поиске специалиста на позицию <b>«Middle+ PHP Developer/Symfony»,</b> который улучшит качество внутренних сервисов компании и увеличит их количество.</div>
                </div>
                <!--
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/symfony-senior">
                            Senior PHP Developer/Symfony
                        </a>
                    </h3>
                    <div>We are looking for strong, experienced <b>Senior PHP Developer/Symfony.</b> We expect him/her to participate in improving and extending a system built using microservice architecture by means of modern technologies.</div>
                </div>
                -->
                <div class="ad">
                    <h3><a href="http://playtini.ua/careers">
                        Остальные вакансии компании
                        <img src="..\..\..\_images\logo-playtini.png" alt="Playtini">
                    </a></h3>
                </div>
            </div>
        </div>

        <div id="main" class="col-sm-9">
            <ol class="breadcrumb">
                
                <li><a href="..\index.html">Документация</a></li>
                
                <li><a href="..\getting_started\index.html">Getting Started</a></li>
                
                <li><a href="..\setup.html">Installing &amp; Setting up the Symfony Framework</a></li>
                
                <li><a href="..\page_creation.html">Create your First Page in Symfony</a></li>
                
                <li><a href="..\routing.html">Routing</a></li>
                
                <li><a href="..\controller.html">Controller</a></li>
                
                <li class="active">Расширения разрешения аргумента действия</li>
            </ol>

            <div class="page">
                
  <div class="section" id="index-0">
<span id="id1"></span><h1>Расширения разрешения аргумента действия<a class="headerlink" href="#index-0" title="Permalink to this headline">¶</a></h1>
<p>В <a class="reference internal" href="..\controller.html"><em>справочнике контроллера</em></a>, вы узнали, что вы можете получить
объект <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html" title="Symfony\Component\HttpFoundation\Request">Request</a></code></tt> через аргумент в вашем
контроллере. Этот аргумент должен быть типизирован классом <tt class="docutils literal"><code>Request</code></tt>, чтобы его
можно было распознать. Это делается через
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpKernel/Controller/ArgumentResolver.html" title="Symfony\Component\HttpKernel\Controller\ArgumentResolver">ArgumentResolver</a></code></tt>. Создавая и
регистрируя пользовательские разрешители значений аргумента, вы можете расширить
эту функциональность.</p>
<div class="section" id="httpkernel">
<h2>Функциональность, поставляемая с HttpKernel<a class="headerlink" href="#httpkernel" title="Permalink to this headline">¶</a></h2>
<p>Symfony поставляется с пятью разрешителями значений в компоненте HttpKernel:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpKernel/Controller/ArgumentResolver/RequestAttributeValueResolver.html" title="Symfony\Component\HttpKernel\Controller\ArgumentResolver\RequestAttributeValueResolver">RequestAttributeValueResolver</a></code></tt></dt>
<dd>Пытается найти атрибут запроса, совпадающий с именем аргумента.</dd>
<dt><tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpKernel/Controller/ArgumentResolver/RequestValueResolver.html" title="Symfony\Component\HttpKernel\Controller\ArgumentResolver\RequestValueResolver">RequestValueResolver</a></code></tt></dt>
<dd>Внедряет текущий <tt class="docutils literal"><code>Request</code></tt> при типизации <tt class="docutils literal"><code>Request</code></tt> или классе, расширяющем
<tt class="docutils literal"><code>Request</code></tt>.</dd>
<dt><tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpKernel/Controller/ArgumentResolver/ServiceValueResolver.html" title="Symfony\Component\HttpKernel\Controller\ArgumentResolver\ServiceValueResolver">ServiceValueResolver</a></code></tt></dt>
<dd>Внедряет сервис при типизации валидным классом сервиса или интерфейсом. Это работает
как <a class="reference internal" href="..\service_container\autowiring.html"><em>автомонтирование</em></a>.</dd>
<dt><tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpKernel/Controller/ArgumentResolver/SessionValueResolver.html" title="Symfony\Component\HttpKernel\Controller\ArgumentResolver\SessionValueResolver">SessionValueResolver</a></code></tt></dt>
<dd>Внедряет сконфигурированный класс сессии, расширяющий <tt class="docutils literal"><code>SessionInterface</code></tt> при
типизации <tt class="docutils literal"><code>SessionInterface</code></tt> или классом, расширяющим <tt class="docutils literal"><code>SessionInterface</code></tt>.</dd>
<dt><tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpKernel/Controller/ArgumentResolver/DefaultValueResolver.html" title="Symfony\Component\HttpKernel\Controller\ArgumentResolver\DefaultValueResolver">DefaultValueResolver</a></code></tt></dt>
<dd>При наличии, установит значение аргумента по умолчанию, если аргумент
необязательный.</dd>
<dt><tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpKernel/Controller/ArgumentResolver/VariadicValueResolver.html" title="Symfony\Component\HttpKernel\Controller\ArgumentResolver\VariadicValueResolver">VariadicValueResolver</a></code></tt></dt>
<dd>Верифицирует является ли данные запроса массивом, и добавляет их в список
аргументов. При вызове действия, последний (переменный) аргумент будет
содержать все значения этого массива.</dd>
</dl>
</div>
<div class="section" id="id2">
<h2>Добавление пользовательского разрешителя значения<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Добавление нового разрешителя значения требует создания определений одного
класса и одного сервиса. В следующем примере, вы создадите разрешитель значения
для внедрения объекта <tt class="docutils literal"><code>User</code></tt> из системы безопасности. При условии, что вы
напишете следующий контроллер:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App\Controller</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">App\Entity\User</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Response</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">UserController</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">(</span><span class="nx">User</span> <span class="nv">$user</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s1">&#39;Hello &#39;</span><span class="o">.</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">getUsername</span><span class="p">()</span><span class="o">.</span><span class="s1">&#39;!&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>Каким-то образом вам нужно будет получить объект <tt class="docutils literal"><code>User</code></tt> и внедрить его в
контроллер. Это можно сделать, реализовав
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpKernel/Controller/ArgumentValueResolverInterface.html" title="Symfony\Component\HttpKernel\Controller\ArgumentValueResolverInterface">ArgumentValueResolverInterface</a></code></tt>.
Этот интерфейс указывает на то, что вы должны реализовать два метода:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><code>supports()</code></tt></dt>
<dd>Этот метод используется, чтобы проверить, поддерживает ли разрешитель
значения данный аргумент. <tt class="docutils literal"><code>resolve()</code></tt> будет выполнен только, когда
будет возвращено <tt class="docutils literal"><code>true</code></tt>.</dd>
<dt><tt class="docutils literal"><code>resolve()</code></tt></dt>
<dd>Этот метод разрешит настоящее значение аргумента. Как только значение будет
разрешено, вы должны <a class="reference external" href="http://php.net/manual/ru/language.generators.syntax.php">yield</a> значение в <tt class="docutils literal"><code>ArgumentResolver</code></tt>.</dd>
</dl>
<p>Оба метода получают объект <tt class="docutils literal"><code>Request</code></tt>, который является текущим запросом, и
экземпляр <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpKernel/ControllerMetadata/ArgumentMetadata.html" title="Symfony\Component\HttpKernel\ControllerMetadata\ArgumentMetadata">ArgumentMetadata</a></code></tt>.
Этот объект содержит всю информацию, полученную из подписи метода для текущего
аргумента.</p>
<p>Теперь, когда вы знаете, что делать, вы можете реализовать этот интерфейс.
Чтобы получить текущего <tt class="docutils literal"><code>User</code></tt>, вам нужен текущий токен безопасности. Этот
токен можно получить из хранилища токенов:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/ArgumentResolver/UserValueResolver.php</span>
<span class="k">namespace</span> <span class="nx">App\ArgumentResolver</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">App\Entity\User</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpKernel\Controller\ArgumentValueResolverInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Security\Core\Authentication\Token\Storage\TokenStorageInterface</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">UserValueResolver</span> <span class="k">implements</span> <span class="nx">ArgumentValueResolverInterface</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="nv">$tokenStorage</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">TokenStorageInterface</span> <span class="nv">$tokenStorage</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">tokenStorage</span> <span class="o">=</span> <span class="nv">$tokenStorage</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">supports</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">,</span> <span class="nx">ArgumentMetadata</span> <span class="nv">$argument</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">User</span><span class="o">::</span><span class="na">class</span> <span class="o">!==</span> <span class="nv">$argument</span><span class="o">-&gt;</span><span class="na">getType</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nv">$token</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">tokenStorage</span><span class="o">-&gt;</span><span class="na">getToken</span><span class="p">();</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$token</span> <span class="nx">instanceof</span> <span class="nx">TokenInterface</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$token</span><span class="o">-&gt;</span><span class="na">getUser</span><span class="p">()</span> <span class="nx">instanceof</span> <span class="nx">User</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">resolve</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">,</span> <span class="nx">ArgumentMetadata</span> <span class="nv">$argument</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">yield</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">tokenStorage</span><span class="o">-&gt;</span><span class="na">getToken</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getUser</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>Чтобы получить настоящий объект <tt class="docutils literal"><code>User</code></tt> в вашем аргументе, данное значение
должно соответствовать следующим требованиям:</p>
<ul class="simple">
<li>Аргумент должен быть типизирован, как <tt class="docutils literal"><code>User</code></tt> в вашей подписи метода действия;</li>
<li>Должен иметься токен безопасности;</li>
<li>Значение должно быть экземпляром <tt class="docutils literal"><code>User</code></tt>.</li>
</ul>
<p>Когда все требования выполнены и возвращён <tt class="docutils literal"><code>true</code></tt>, <tt class="docutils literal"><code>ArgumentResolver</code></tt>
вызывает <tt class="docutils literal"><code>resolve()</code></tt> с теми же значение, как вызывал <tt class="docutils literal"><code>supports()</code></tt>.</p>
<p>Вот и всё! Теперь всё, что вам осталось сделать - это добавить конфигурацию
для сервис-контейнера. Это можно сделать, тегировав сервис с помощью
<tt class="docutils literal"><code>controller.argument_value_resolver</code></tt> и добавив приоритетность.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="literal-block"><div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># config/services.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">services</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">_defaults</span><span class="p p-Indicator">:</span>
        <span class="c1"># ... убедитесь, что включено автомонтирование</span>
        <span class="l l-Scalar l-Scalar-Plain">autowire</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="c1"># ...</span>

    <span class="l l-Scalar l-Scalar-Plain">App\ArgumentResolver\UserValueResolver</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">tags</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="p p-Indicator">{</span> <span class="nv">name</span><span class="p p-Indicator">:</span> <span class="nv">controller.argument_value_resolver</span><span class="p p-Indicator">,</span> <span class="nv">priority</span><span class="p p-Indicator">:</span> <span class="nv">50</span> <span class="p p-Indicator">}</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>XML</em><div class="literal-block"><div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">&lt;!-- config/services.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;container</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/dic/services&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-Instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;services&gt;</span>
        <span class="c">&lt;!-- ... убедитесь, что включено автомонтирование --&gt;</span>
        <span class="nt">&lt;defaults</span> <span class="na">autowire=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
        <span class="c">&lt;!-- ... --&gt;</span>

        <span class="nt">&lt;service</span> <span class="na">id=</span><span class="s">&quot;App\ArgumentResolver\UserValueResolver&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;tag</span> <span class="na">name=</span><span class="s">&quot;controller.argument_value_resolver&quot;</span> <span class="na">priority=</span><span class="s">&quot;50&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/service&gt;</span>
    <span class="nt">&lt;/services&gt;</span>

<span class="nt">&lt;/container&gt;</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>PHP</em><div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// config/services.php</span>
<span class="k">use</span> <span class="nx">App\ArgumentResolver\UserValueResolver</span><span class="p">;</span>

<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">autowire</span><span class="p">(</span><span class="nx">UserValueResolver</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">addTag</span><span class="p">(</span><span class="s1">&#39;controller.argument_value_resolver&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;priority&#39;</span> <span class="o">=&gt;</span> <span class="mi">50</span><span class="p">));</span>
</pre></div>
</td></tr></table></div></div>
</li>
</ul>
</div>
<p>Несмотря на то, что добавление приоритетности необязательно, рекомендуется её
добавить, чтобы убедиться в том, что ожидаемое значение будет внедрено.
<tt class="docutils literal"><code>RequestAttributeValueResolver</code></tt> имеет приоритетность 100. Так как он отвечает
за получение атрибутов из <tt class="docutils literal"><code>Request</code></tt>, рекомендуется установить в вашем разрешителе
значений приоритетность ниже. Таким образом, разрешители значений не будут запускаться,
если имеется атрибут. Например, при передаче пользователя по подзапросам.</p>
<div class="admonition-wrapper">
<div class="tip"></div><div class="admonition admonition-tip"><p class="first admonition-title">Tip</p>
<p>Как вы можете увидеть в методе <tt class="docutils literal"><code>UserValueResolver::supports()</code></tt>, пользователь
может быть недоступен (например, когда контроллер на находится за брандмауэром).
В таких случаях, разрешитель не будет выполнен. Если не разрешено ни одно значение
аргумента, будет вызвано исключение.</p>
<p class="last">Чтобы избежать этого, вы можете добавить значение по умолчанию в контроллер
(например, <tt class="docutils literal"><code>User $user = null</code></tt>). <tt class="docutils literal"><code>DefaultValueResolver</code></tt> выполняется, как
последний разрешитель, и будет использовать значение по умолчанию, если до
этого не было разрешено ни одного значения.</p>
</div></div>
</div>
</div>


            </div>

            
            <div class="navigation">
                <a href="argument_value_resolver.html">« Extending Action Argument Resolving</a>
                <span class="separator">|</span>
                <a href="error_pages.html">How to Customize Error Pages »</a>
            </div>
            

            <div id="license">
                <p>Эта документация является переводом <a href="http://symfony.com/doc/current/index.html">официальной документации Symfony</a> и предоставляется по свободной лицензии <a rel="license nofollow" href="https://creativecommons.org/licenses/by-sa/3.0/deed.ru">CC BY-SA 3.0</a>.</p>
            </div>
        </div>
    </div>
</div></div>


  </body>
</body></html>