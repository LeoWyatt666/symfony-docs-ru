<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    <title>Как настроить страницы ошибок &mdash; Symfony Framework Documentation  documentation</title>
    
    <link rel="stylesheet" href="../_static/" type="text/css">
    <link rel="stylesheet" href="..\_static\pygments.css" type="text/css">
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <link rel="top" title="Symfony Framework Documentation  documentation" href="..\index.html">
    <link rel="up" title="Controller" href="..\controller.html">
    <link rel="next" title="How to Forward Requests to another Controller" href="forwarding.html">
    <link rel="prev" title="How to Customize Error Pages" href="error_pages.html">

<link rel="stylesheet" href="..\_assets\app.css?v=8d6d457a0820d7c245bddae16bfd4c75">
<script src="..\_assets\manifest.js?v=d41d8cd98f00b204e980"></script>
<script src="..\_assets\app.js?v=900984040c7cb4dca514"></script>
<style>
    .header__top .container {
        overflow: hidden;
        padding-top: 10px;
        padding-bottom: 10px;
    }
    .header__top .header__logo {
        float: left;
    }
    .header__top .header__support {
        float: right;
    }

    .highlight .k, .highlight .gh, .highlight .gp,
    .highlight .gu, .highlight .kc, .highlight .kd,
    .highlight .kn, .highlight .kr, .highlight .nc,
    .highlight .nd, .highlight .ni, .highlight .nl,
    .highlight .nn, .highlight .nt, .highlight .ow,
    .highlight .se { font-weight: normal; }

    .highlight .c, .highlight .cm, .highlight .c1,
    .highlight .sd, .highlight .si { font-style: normal; }

    .doc { background: none; }
    #demo-warning {
        border: 3px dashed #c00;
        padding: 10px;
        margin-bottom: 30px;
    }
    #demo-warning h4 { font-size: 1.7em;font-weight: bold; }
    #demo-warning p { margin-bottom: 0; }
</style>

<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-107764519-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-107764519-1');
</script>

<!-- Facebook Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '250281335689441');
    fbq('track', 'PageView');
</script>
<img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=250281335689441&ev=PageView&noscript=1">
<!-- End Facebook Pixel Code -->

<script type="text/javascript">!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://vk.com/js/api/openapi.js?159",t.onload=function(){VK.Retargeting.Init("VK-RTRG-279161-8p6Jv"),VK.Retargeting.Hit()},document.head.appendChild(t)}();</script><img src="https://vk.com/rtrg?p=VK-RTRG-279161-8p6Jv" style="position:fixed; left:-999px;" alt="">


  </head>
  <body role="document">

<body class="controller doc_article doc">

<header>
    <section class="header__top">
        <div class="container">
            <div class="header__logo">
                <a href="..\..\..\index.html">
                    <img src="..\..\..\_images\header-logo.svg" alt="Symfony.com.ua logo">
                </a>
            </div>
            <div class="header__support hidden-xs">
                <a href="http://playtini.ua/" title="Компания Playtini">
                    <img height="69" src="..\..\..\_images\support.png" alt="Symfony is a SensioLabs product">
                </a>
            </div>
        </div>
    </section>
</header>

<div class="container"><div id="page-content">
    <div class="row">
        <div id="sidebar" class="col-sm-3">
            <div id="sidebar-content"><div class="submenu">
    
    
    <ul class="list_submenu list-unstyled">
    
        <li class="first">
            <a href="..\index.html">Главная</a>
        </li>
    
        <li>
            <a href="..\components\index.html">Компоненты</a>
        </li>
    
        <li>
            <a href="..\best_practices\index.html">Лучшие практики</a>
        </li>
    
        <li>
            <a href="..\quick_tour\index.html">Быстрый старт</a>
        </li>
    
        <li>
            <a href="..\reference\index.html">Справочник</a>
        </li>
    
        <li>
            <a href="..\genindex.html">Индекс</a>
        </li>
    
        <li>
            <a href="..\contributing\index.html">Участие</a>
        </li>
    
    </ul>
</div>

                <div class="toc"> 
    <h4>Содержание</h4>
    <div class="toc-content">
        <ul>
<li><a class="reference internal" href="#">Как настроить страницы ошибок</a><ul>
<li><a class="reference internal" href="#using-the-default-exceptioncontroller-ru">Переопределение шаблонов ошибок по умолчанию</a></li>
<li><a class="reference internal" href="#id3">Пример шаблона ошибки 404</a><ul>
<li><a class="reference internal" href="#testing-error-pages-ru">Тестирование страниц ошибок по время разработки</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exceptioncontroller">Переопределение ExceptionController по умолчаию</a></li>
<li><a class="reference internal" href="#kernel-exception">Работа с событием <tt class="docutils literal"><code>kernel.exception</code></tt></a></li>
</ul>
</li>
</ul>

    </div>
</div>
                
            </div>

            <div class="ads m-b-30">
                <h2>Вакансии Playtini</h2>
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/php-dev">
                            Middle+ PHP Developer/Symfony
                        </a>
                    </h3>
                    <div><b>Playtini</b> активно поддерживает и развивает свои продукты, и профессионализм команды. И на данный момент в поиске специалиста на позицию <b>«Middle+ PHP Developer/Symfony»,</b> который улучшит качество внутренних сервисов компании и увеличит их количество.</div>
                </div>
                <!--
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/symfony-senior">
                            Senior PHP Developer/Symfony
                        </a>
                    </h3>
                    <div>We are looking for strong, experienced <b>Senior PHP Developer/Symfony.</b> We expect him/her to participate in improving and extending a system built using microservice architecture by means of modern technologies.</div>
                </div>
                -->
                <div class="ad">
                    <h3><a href="http://playtini.ua/careers">
                        Остальные вакансии компании
                        <img src="..\..\..\_images\logo-playtini.png" alt="Playtini">
                    </a></h3>
                </div>
            </div>
        </div>

        <div id="main" class="col-sm-9">
            <ol class="breadcrumb">
                
                <li><a href="..\index.html">Документация</a></li>
                
                <li><a href="..\getting_started\index.html">Getting Started</a></li>
                
                <li><a href="..\setup.html">Installing &amp; Setting up the Symfony Framework</a></li>
                
                <li><a href="..\page_creation.html">Create your First Page in Symfony</a></li>
                
                <li><a href="..\routing.html">Routing</a></li>
                
                <li><a href="..\controller.html">Controller</a></li>
                
                <li class="active">Как настроить страницы ошибок</li>
            </ol>

            <div class="page">
                
  <div class="section" id="index-0">
<span id="id1"></span><h1>Как настроить страницы ошибок<a class="headerlink" href="#index-0" title="Permalink to this headline">¶</a></h1>
<p>В приложениях Symfony все ошибки воспринимаются, как исключения, вне зависимости
от того, являются ли они простой ошибкой 404 &quot;Не найдено&quot; или фатальной ошибкой,
запущенной вызовом какого-то исключения в вашем коде.</p>
<p>В <a class="reference internal" href="..\configuration\environments.html"><em>окружении разработки</em></a>, Symfony ловит все
исключения и отображаеть специальную <strong>страницу исключений</strong> со множеством информации
по отладке, чтобы помочь вам быстро обнаружить основную проблему:</p>
<img alt="Типичная страница исключений в окружении разработки" class="with-browser align-center" src="..\_images\exceptions-in-dev-environment.png">
<p>Так как эти страницы содержат много чувствительной внутренней информации, Symfony
не будет отображать её в окружении производства. Вместо этого, она покажет простую
и общую ошибку <strong>страница ошибки</strong>:</p>
<img alt="Типичная страница ошибки в окружении производства" class="with-browser align-center" src="..\_images\errors-in-prod-environment.png">
<p>Страницы ошибок в окружении производства можно настроить разными способами, в
зависимости от ваших потребностей:</p>
<ol class="arabic simple">
<li>Если вы просто хотите изменить содержание и стили страниц ошибок так, чтобы
они совпадали с остальным вашим приложением,
<a class="reference internal" href="error_pages.html#use-default-exception-controller"><span>переопределите шаблоны ошибок по умолчанию</span></a>;</li>
<li>Если вы также хотите настроить логику, используемую Symfony для генерирования ваших
страниц ошибок, то <a class="reference internal" href="error_pages.html#custom-exception-controller"><span>переопределите контроллер исключений по умолчанию</span></a>;</li>
<li>Если вам нужен полный контроль над работой с исключениями, выполните вашу
собственную логику - <a class="reference internal" href="error_pages.html#use-kernel-exception-event"><span>используйте событие the kernel.exception</span></a>.</li>
</ol>
<div class="section" id="using-the-default-exceptioncontroller-ru">
<span id="use-default-exception-controller-ru"></span><span id="id2"></span><h2>Переопределение шаблонов ошибок по умолчанию<a class="headerlink" href="#using-the-default-exceptioncontroller-ru" title="Permalink to this headline">¶</a></h2>
<p>Когда загружается страница ошибки, для отображения шаблона twig и демонастрации
пользователю, используется внутренний <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Bundle/TwigBundle/Controller/ExceptionController.html" title="Symfony\Bundle\TwigBundle\Controller\ExceptionController">ExceptionController</a></code></tt>.</p>
<p id="controller-error-pages-by-status-code-ru">Этот контроллер использует статус-код HTTP, формат запроса и следующую логику,
чтобы определить имя файла шаблона:</p>
<ol class="arabic simple">
<li>Ищите шаблон для заданного формата и статус-кода (вроде <tt class="docutils literal"><code>error404.json.twig</code></tt>
или <tt class="docutils literal"><code>error500.html.twig</code></tt>);</li>
<li>Если предыдущий шаблон не существует, отбросьте статус-код и ищите общий
шаблон для заданного формата (вроде <tt class="docutils literal"><code>error.json.twig</code></tt> или  <tt class="docutils literal"><code>error.xml.twig</code></tt>);</li>
<li>Если не существует ни один из предыдущих шаблонов, используйте общий резеврный
HTML-шаблон (<tt class="docutils literal"><code>error.html.twig</code></tt>).</li>
</ol>
<p id="overriding-or-adding-templates-ru">Чтобы переопределить эти шаблоны, просто положитесь на стандартный метод Symfony
для <tt class="xref doc docutils literal"><code>пеоепределения шаблонов, живущих внутри пакета</code></tt>:
поместите их в каталоге <tt class="docutils literal"><code>templates/bundles/TwigBundle/Exception/</code></tt>.</p>
<p>Типичный проект, возвращающий страницы HTML и JSON, может выглядеть так:</p>
<div class="literal-block"><div class="highlight-text"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>
</pre></div>
</td></tr></table></div></div>
<div class="literal-block"><div class="highlight-text"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span>templates/
└─ bundles/
   └─ TwigBundle/
      └─ Exception/
         ├─ error404.html.twig
         ├─ error403.html.twig
         ├─ error.html.twig      # Все другие HTML ошибки (включая 500)
         ├─ error404.json.twig
         ├─ error403.json.twig
         └─ error.json.twig      # Все другие JSON ошибки (включая 500)
</pre></div>
</td></tr></table></div></div>
</div>
<div class="section" id="id3">
<h2>Пример шаблона ошибки 404<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Чтобы переопределить шаблон ошибки 404 для HTML-страниц, создайте новый шаблон
<tt class="docutils literal"><code>error404.html.twig</code></tt>, находящийся в <tt class="docutils literal"><code>templates/bundles/TwigBundle/Exception/</code></tt>:</p>
<div class="literal-block"><div class="highlight-html+twig"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">{# templates/bundles/TwigBundle/Exception/error404.html.twig #}</span>
<span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;base.html.twig&#39;</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Page not found<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
        Запрошенная страница не найдена. Проверьте опечатки в URL или
        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">path</span><span class="o">(</span><span class="s1">&#39;homepage&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="p">&gt;</span>вернитесь на домашнюю сраницу<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>.
    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</td></tr></table></div></div>
<p>Если они вам понадобятся, <tt class="docutils literal"><code>ExceptionController</code></tt> передаёт некоторую информацию в шаблон
ошибок через переменные <tt class="docutils literal"><code>status_code</code></tt> и <tt class="docutils literal"><code>status_text</code></tt>, которые хранят HTTP статус-код
и сообщение соотвественно.</p>
<div class="admonition-wrapper">
<div class="tip"></div><div class="admonition admonition-tip"><p class="first admonition-title">Tip</p>
<p class="last">Вы можете настроить статус-код, реализовав
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpKernel/Exception/HttpExceptionInterface.html" title="Symfony\Component\HttpKernel\Exception\HttpExceptionInterface">HttpExceptionInterface</a></code></tt>
и его обязательный метод <tt class="docutils literal"><code>getStatusCode()</code></tt>. В обратном случае, <tt class="docutils literal"><code>status_code</code></tt>
по умолчанию будет``500``.</p>
</div></div>
<div class="admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p class="last">Страницы исключений, отображающиеся в окружении разработки, можно настроить
таким же образом, как страницы об ошибках. Создайте новый шаблон <tt class="docutils literal"><code>exception.html.twig</code></tt>
для страницы стандартного HTML-исключния, или <tt class="docutils literal"><code>exception.json.twig</code></tt> для страницы
JSON-исключения.</p>
</div></div>
<div class="section" id="testing-error-pages-ru">
<span id="id4"></span><h3>Тестирование страниц ошибок по время разработки<a class="headerlink" href="#testing-error-pages-ru" title="Permalink to this headline">¶</a></h3>
<p>В то время, как вы находитесь в окружении разработки, Symfony отображает
большую страницу <em>исключений</em> вместо вашей новой блестящей страницы ошибок.
Так как вам увидеть, как она выглядит изнутри и отладить её?</p>
<p>К счастью, <tt class="docutils literal"><code>ExceptionController</code></tt> по умолчанию разрешает вам предпросмотр
вашей страницы <em>ошибки</em> во время разработки.</p>
<p>Чтобы использовать эту функцию, вам загрузить специальные маршруты, предоставленные
TwigBundle (если приложение использует <a class="reference internal" href="..\setup\flex.html"><em>Symfony Flex</em></a>, то они
загружаются автоматически при установке поддержки Twig):</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="literal-block"><div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># config/routes/dev/twig.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">_errors</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="s">&#39;@TwigBundle/Resources/config/routing/errors.xml&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">prefix</span><span class="p p-Indicator">:</span>   <span class="l l-Scalar l-Scalar-Plain">/_error</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>XML</em><div class="literal-block"><div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">&lt;!-- config/routes/dev/twig.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing</span>
<span class="s">        http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;import</span> <span class="na">resource=</span><span class="s">&quot;@TwigBundle/Resources/config/routing/errors.xml&quot;</span>
        <span class="na">prefix=</span><span class="s">&quot;/_error&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>PHP</em><div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// config/routes/dev/twig.php</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Routing\RouteCollection</span><span class="p">;</span>

<span class="nv">$collection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RouteCollection</span><span class="p">();</span>
<span class="nv">$collection</span><span class="o">-&gt;</span><span class="na">addCollection</span><span class="p">(</span>
    <span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">import</span><span class="p">(</span><span class="s1">&#39;@TwigBundle/Resources/config/routing/errors.xml&#39;</span><span class="p">)</span>
<span class="p">);</span>
<span class="nv">$collection</span><span class="o">-&gt;</span><span class="na">addPrefix</span><span class="p">(</span><span class="s2">&quot;/_error&quot;</span><span class="p">);</span>

<span class="k">return</span> <span class="nv">$collection</span><span class="p">;</span>
</pre></div>
</td></tr></table></div></div>
</li>
</ul>
</div>
<p>C добавлением этого маршрута, вы можете использовать такие URL для предпросмотра
страницы <em>ошибки</em> для заданного статус-кода в виде HTML или для заданного статус-кода
и формата.</p>
<div class="literal-block"><div class="highlight-text"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>http://localhost/index.php/_error/{statusCode}
http://localhost/index.php/_error/{statusCode}.{format}
</pre></div>
</td></tr></table></div></div>
</div>
</div>
<div class="section" id="exceptioncontroller">
<span id="replacing-the-default-exceptioncontroller-ru"></span><span id="custom-exception-controller-ru"></span><h2>Переопределение ExceptionController по умолчаию<a class="headerlink" href="#exceptioncontroller" title="Permalink to this headline">¶</a></h2>
<p>Если вам нужно немного больше гибкости кроме простого переопределения шаблона,
то вы можете изменить контроллер, отображающий странцу ошибки. Например, вам
может быть нужо передать дополнительные переменные в ваш шаблон.</p>
<p>Чтобы сделать это, просто создайте новый контролер где угодно в вашем приложении,
и установите опцию конфигурации <a class="reference internal" href="..\reference\configuration\twig.html#config-twig-exception-controller"><span>twig.exception_controller</span></a>,
чтобы указать на неё:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="literal-block"><div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># config/packages/twig.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">twig</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">exception_controller</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">App\Controller\ExceptionController::showException</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>XML</em><div class="literal-block"><div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">&lt;!-- config/packages/twig.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;container</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/dic/services&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xmlns:twig=</span><span class="s">&quot;http://symfony.com/schema/dic/twig&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/dic/services</span>
<span class="s">        http://symfony.com/schema/dic/services/services-1.0.xsd</span>
<span class="s">        http://symfony.com/schema/dic/twig</span>
<span class="s">        http://symfony.com/schema/dic/twig/twig-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;twig:config&gt;</span>
        <span class="nt">&lt;twig:exception-controller&gt;</span>App\Controller\ExceptionController::showException<span class="nt">&lt;/twig:exception-controller&gt;</span>
    <span class="nt">&lt;/twig:config&gt;</span>

<span class="nt">&lt;/container&gt;</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>PHP</em><div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// config/packages/twig.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;twig&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;exception_controller&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;App\Controller\ExceptionController::showException&#39;</span><span class="p">,</span>
    <span class="c1">// ...</span>
<span class="p">));</span>
</pre></div>
</td></tr></table></div></div>
</li>
</ul>
</div>
<p>Класс <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpKernel/EventListener/ExceptionListener.html" title="Symfony\Component\HttpKernel\EventListener\ExceptionListener">ExceptionListener</a></code></tt>,
используемый TwigBundle в качестве слушателя события <tt class="docutils literal"><code>kernel.exception</code></tt>, создаёт
запрос, который будет развёрнут в вашем контроллере. В дополнение, вашему контроллеру
будут переданы два параметра:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><code>exception</code></tt></dt>
<dd>Сущность <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master//Symfony/Component/Debug/Exception/FlattenException.html" title="\Symfony\Component\Debug\Exception\FlattenException">FlattenException</a></code></tt>,
создання их обрабатываемого исключения.</dd>
<dt><tt class="docutils literal"><code>logger</code></tt></dt>
<dd>Сущность <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master//Symfony/Component/HttpKernel/Log/DebugLoggerInterface.html" title="\Symfony\Component\HttpKernel\Log\DebugLoggerInterface">DebugLoggerInterface</a></code></tt>,
которая может в некоторых случаях быть <tt class="docutils literal"><code>null</code></tt>.</dd>
</dl>
<p>Вместо создания новго контроллера исключений с нуля, вы конечно же можете также
расширить класс по умолчанию <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Bundle/TwigBundle/Controller/ExceptionController.html" title="Symfony\Bundle\TwigBundle\Controller\ExceptionController">ExceptionController</a></code></tt>.
В таком случасе, вы можете захотеть переопределить один или оба метода <tt class="docutils literal"><code>showAction()</code></tt>
и <tt class="docutils literal"><code>findTemplate()</code></tt>. Последний содержит шаблон для использования.</p>
<div class="admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p>В случае расширения класса <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Bundle/TwigBundle/Controller/ExceptionController.html" title="Symfony\Bundle\TwigBundle\Controller\ExceptionController">ExceptionController</a></code></tt>,
вы можете сконфигурировать севис, чтобы передать окружению Twig и конструктору
флага <tt class="docutils literal"><code>debug</code></tt>.</p>
<div class="last configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="literal-block"><div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># config/services.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">services</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">_defaults</span><span class="p p-Indicator">:</span>
        <span class="c1"># ... be sure autowiring is enabled</span>
        <span class="l l-Scalar l-Scalar-Plain">autowire</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="c1"># ...</span>

    <span class="l l-Scalar l-Scalar-Plain">App\Controller\CustomExceptionController</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">public</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">arguments</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">$debug</span><span class="p p-Indicator">:</span> <span class="s">&#39;%kernel.debug%&#39;</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>XML</em><div class="literal-block"><div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">&lt;!-- config/services.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;container</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/dic/services&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/dic/services</span>
<span class="s">        http://symfony.com/schema/dic/services/services-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;services&gt;</span>
        <span class="c">&lt;!-- ... be sure autowiring is enabled --&gt;</span>
        <span class="nt">&lt;defaults</span> <span class="na">autowire=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
        <span class="c">&lt;!-- ... --&gt;</span>

        <span class="nt">&lt;service</span> <span class="na">id=</span><span class="s">&quot;App\Controller\CustomExceptionController&quot;</span> <span class="na">public=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;argument</span> <span class="na">key=</span><span class="s">&quot;$debug&quot;</span><span class="nt">&gt;</span>%kernel.debug%<span class="nt">&lt;/argument&gt;</span>
        <span class="nt">&lt;/service&gt;</span>
    <span class="nt">&lt;/services&gt;</span>

<span class="nt">&lt;/container&gt;</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>PHP</em><div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// config/services.php</span>
<span class="k">use</span> <span class="nx">App\Controller\CustomExceptionController</span><span class="p">;</span>

<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">autowire</span><span class="p">(</span><span class="nx">CustomExceptionController</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">setArgument</span><span class="p">(</span><span class="s1">&#39;$debug&#39;</span><span class="p">,</span> <span class="s1">&#39;%kernel.debug%&#39;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div></div>
</li>
</ul>
</div>
</div></div>
<div class="admonition-wrapper">
<div class="tip"></div><div class="admonition admonition-tip"><p class="first admonition-title">Tip</p>
<p class="last"><a class="reference internal" href="error_pages.html#testing-error-pages"><span>Предпросмотр страницы ошибки</span></a> также работает
с вашими собственными контроллерами, нвстроенными как угодно.</p>
</div></div>
</div>
<div class="section" id="kernel-exception">
<span id="use-kernel-exception-event-ru"></span><h2>Работа с событием <tt class="docutils literal"><code>kernel.exception</code></tt><a class="headerlink" href="#kernel-exception" title="Permalink to this headline">¶</a></h2>
<p>когда вызывается исключение, класс <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpKernel/HttpKernel.html" title="Symfony\Component\HttpKernel\HttpKernel">HttpKernel</a></code></tt>
ловит его и развёртывает событие <tt class="docutils literal"><code>kernel.exception</code></tt>. Это даёт вам возможность
конвертировать исключение в <tt class="docutils literal"><code>Response</code></tt> несколькими разными способами.</p>
<p>Работа с этим событием на самом деле значительн более мощная, чем объяснялось раньше,
но также требует тщательного понимания внутренних процессов Symfony. Представьте, что
ваш код вызывает специальные исключения с конкретным значением в вашем домене приложения.</p>
<p><a class="reference internal" href="..\event_dispatcher.html"><em>Написание вашего собственного слушателя событий</em></a> для события
<tt class="docutils literal"><code>kernel.exception</code></tt> позволяет вам ближе рассмотретьисключение и предпринять по отношению
к нему разные действия. Эти действия могут включать в себя запись лога исключения,
перенаправление пользователя на другую страницу или отображение специальных страниц ошибки.</p>
<div class="admonition-wrapper">
<div class="note"></div><div class="admonition admonition-note"><p class="first admonition-title">Note</p>
<p class="last">Если ваш слушатель вызывает <tt class="docutils literal"><code>setResponse()</code></tt> в событии
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpKernel/Event/GetResponseForExceptionEvent.html" title="Symfony\Component\HttpKernel\Event\GetResponseForExceptionEvent">GetResponseForExceptionEvent</a></code></tt>,
распространение будет остановлено и клиенту будет отправлен ответ.</p>
</div></div>
<p>Этот подход позволяет вам создавать централизованную и многослойную обработку
ошибок: вместо того, чтобы ловить (и обрабатывать) одни и те же исключения в
разных контроллерах снова и снова, вы просто можете иметь одного (или нескольких)
слушателей, чтобы разбираться с ними.</p>
<div class="admonition-wrapper">
<div class="tip"></div><div class="admonition admonition-tip"><p class="first admonition-title">Tip</p>
<p class="last">Смотрите код класса <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Security/Http/Firewall/ExceptionListener.html" title="Symfony\Component\Security\Http\Firewall\ExceptionListener">ExceptionListener</a></code></tt>
для реального примера продвинутого слушателя такого типа. Этот слушатель обрабатывает
различные исключения, связанные с безопасностью, которые вызываются в вашем приложении
(как <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Security/Core/Exception/AccessDeniedException.html" title="Symfony\Component\Security\Core\Exception\AccessDeniedException">AccessDeniedException</a></code></tt>) и
предпринимает действия вроде перенаправления пользователей на страницу входа, выполняет
их вход в систему и др.</p>
</div></div>
</div>
</div>


            </div>

            
            <div class="navigation">
                <a href="error_pages.html">« How to Customize Error Pages</a>
                <span class="separator">|</span>
                <a href="forwarding.html">How to Forward Requests to another Controller »</a>
            </div>
            

            <div id="license">
                <p>Эта документация является переводом <a href="http://symfony.com/doc/current/index.html">официальной документации Symfony</a> и предоставляется по свободной лицензии <a rel="license nofollow" href="https://creativecommons.org/licenses/by-sa/3.0/deed.ru">CC BY-SA 3.0</a>.</p>
            </div>
        </div>
    </div>
</div></div>


  </body>
</body></html>