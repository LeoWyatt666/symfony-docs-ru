<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    <title>Создание пользовательского отгадывателя типа &mdash; Symfony Framework Documentation  documentation</title>
    
    <link rel="stylesheet" href="../_static/" type="text/css">
    <link rel="stylesheet" href="..\_static\pygments.css" type="text/css">
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <link rel="top" title="Symfony Framework Documentation  documentation" href="..\index.html">
    <link rel="up" title="Forms" href="..\forms.html">
    <link rel="next" title="How to Unit Test your Forms" href="unit_testing.html">
    <link rel="prev" title="Creating a custom Type Guesser" href="type_guesser.html">

<link rel="stylesheet" href="..\_assets\app.css?v=8d6d457a0820d7c245bddae16bfd4c75">
<script src="..\_assets\manifest.js?v=d41d8cd98f00b204e980"></script>
<script src="..\_assets\app.js?v=900984040c7cb4dca514"></script>
<style>
    .header__top .container {
        overflow: hidden;
        padding-top: 10px;
        padding-bottom: 10px;
    }
    .header__top .header__logo {
        float: left;
    }
    .header__top .header__support {
        float: right;
    }

    .highlight .k, .highlight .gh, .highlight .gp,
    .highlight .gu, .highlight .kc, .highlight .kd,
    .highlight .kn, .highlight .kr, .highlight .nc,
    .highlight .nd, .highlight .ni, .highlight .nl,
    .highlight .nn, .highlight .nt, .highlight .ow,
    .highlight .se { font-weight: normal; }

    .highlight .c, .highlight .cm, .highlight .c1,
    .highlight .sd, .highlight .si { font-style: normal; }

    .doc { background: none; }
    #demo-warning {
        border: 3px dashed #c00;
        padding: 10px;
        margin-bottom: 30px;
    }
    #demo-warning h4 { font-size: 1.7em;font-weight: bold; }
    #demo-warning p { margin-bottom: 0; }
</style>

<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-107764519-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-107764519-1');
</script>

<!-- Facebook Pixel Code -->
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '250281335689441');
    fbq('track', 'PageView');
</script>
<img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=250281335689441&ev=PageView&noscript=1">
<!-- End Facebook Pixel Code -->

<script type="text/javascript">!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://vk.com/js/api/openapi.js?159",t.onload=function(){VK.Retargeting.Init("VK-RTRG-279161-8p6Jv"),VK.Retargeting.Hit()},document.head.appendChild(t)}();</script><img src="https://vk.com/rtrg?p=VK-RTRG-279161-8p6Jv" style="position:fixed; left:-999px;" alt="">


  </head>
  <body role="document">

<body class="form doc_article doc">

<header>
    <section class="header__top">
        <div class="container">
            <div class="header__logo">
                <a href="..\..\..\index.html">
                    <img src="..\..\..\_images\header-logo.svg" alt="Symfony.com.ua logo">
                </a>
            </div>
            <div class="header__support hidden-xs">
                <a href="http://playtini.ua/" title="Компания Playtini">
                    <img height="69" src="..\..\..\_images\support.png" alt="Symfony is a SensioLabs product">
                </a>
            </div>
        </div>
    </section>
</header>

<div class="container"><div id="page-content">
    <div class="row">
        <div id="sidebar" class="col-sm-3">
            <div id="sidebar-content"><div class="submenu">
    
    
    <ul class="list_submenu list-unstyled">
    
        <li class="first">
            <a href="..\index.html">Главная</a>
        </li>
    
        <li>
            <a href="..\components\index.html">Компоненты</a>
        </li>
    
        <li>
            <a href="..\best_practices\index.html">Лучшие практики</a>
        </li>
    
        <li>
            <a href="..\quick_tour\index.html">Быстрый старт</a>
        </li>
    
        <li>
            <a href="..\reference\index.html">Справочник</a>
        </li>
    
        <li>
            <a href="..\genindex.html">Индекс</a>
        </li>
    
        <li>
            <a href="..\contributing\index.html">Участие</a>
        </li>
    
    </ul>
</div>

                <div class="toc"> 
    <h4>Содержание</h4>
    <div class="toc-content">
        <ul>
<li><a class="reference internal" href="#">Создание пользовательского отгадывателя типа</a><ul>
<li><a class="reference internal" href="#phpdoc">Создайте отгадыватель типаPHPDoc</a><ul>
<li><a class="reference internal" href="#id2">Отгадывание типа</a></li>
<li><a class="reference internal" href="#id3">Опции поля отгадывания</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id4">Регистрация отгадывателя типа</a></li>
</ul>
</li>
</ul>

    </div>
</div>
                
            </div>

            <div class="ads m-b-30">
                <h2>Вакансии Playtini</h2>
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/php-dev">
                            Middle+ PHP Developer/Symfony
                        </a>
                    </h3>
                    <div><b>Playtini</b> активно поддерживает и развивает свои продукты, и профессионализм команды. И на данный момент в поиске специалиста на позицию <b>«Middle+ PHP Developer/Symfony»,</b> который улучшит качество внутренних сервисов компании и увеличит их количество.</div>
                </div>
                <!--
                <div class="ad m-b-15">
                    <h3>
                        <a href="http://playtini.ua/careers/symfony-senior">
                            Senior PHP Developer/Symfony
                        </a>
                    </h3>
                    <div>We are looking for strong, experienced <b>Senior PHP Developer/Symfony.</b> We expect him/her to participate in improving and extending a system built using microservice architecture by means of modern technologies.</div>
                </div>
                -->
                <div class="ad">
                    <h3><a href="http://playtini.ua/careers">
                        Остальные вакансии компании
                        <img src="..\..\..\_images\logo-playtini.png" alt="Playtini">
                    </a></h3>
                </div>
            </div>
        </div>

        <div id="main" class="col-sm-9">
            <ol class="breadcrumb">
                
                <li><a href="..\index.html">Документация</a></li>
                
                <li><a href="..\forms.html">Forms</a></li>
                
                <li class="active">Создание пользовательского отгадывателя типа</li>
            </ol>

            <div class="page">
                
  <div class="section" id="index-0">
<span id="id1"></span><h1>Создание пользовательского отгадывателя типа<a class="headerlink" href="#index-0" title="Permalink to this headline">¶</a></h1>
<p>Компонент Формы может отгадывать тип и некоторые опции поля формы, используя
отгадыватели типа. Компонент уже включает в себя отгадыватель типа, используя
утверждения компонента Валидации, но вы также можете добавлять ваши пользовательские
отгадыватели типа.</p>
<div class="admonition-wrapper">
<div class="sidebar"></div><div class="admonition admonition-sidebar"><p class="first sidebar-title">Отгадыватели типа в мостах</p>
<p>Symfony также предоставляет некоторые отгадыватели типв в мостах:</p>
<ul class="last simple">
<li><tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Bridge/Propel1/Form/PropelTypeGuesser.html" title="Symfony\Bridge\Propel1\Form\PropelTypeGuesser">PropelTypeGuesser</a></code></tt>, предоставленные
мостом Propel1;</li>
<li><tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Bridge/Doctrine/Form/DoctrineOrmTypeGuesser.html" title="Symfony\Bridge\Doctrine\Form\DoctrineOrmTypeGuesser">DoctrineOrmTypeGuesser</a></code></tt>, предоставленный
мостом Doctrine.</li>
</ul>
</div></div>
<div class="section" id="phpdoc">
<h2>Создайте отгадыватель типаPHPDoc<a class="headerlink" href="#phpdoc" title="Permalink to this headline">¶</a></h2>
<p>В этом разделе, вы построите отгадыватель, который читает информацию о полях из
PHPDoc свойств. Вначале, вам нужно создать класс, реализующий
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/FormTypeGuesserInterface.html" title="Symfony\Component\Form\FormTypeGuesserInterface">FormTypeGuesserInterface</a></code></tt>. Этот интерфейс требует
четыре метода:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/FormTypeGuesserInterface.html#method_guessType" title="Symfony\Component\Form\FormTypeGuesserInterface::guessType()">guessType()</a></code></tt></dt>
<dd>Пытается угадать тип поля;</dd>
<dt><tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/FormTypeGuesserInterface.html#method_guessRequired" title="Symfony\Component\Form\FormTypeGuesserInterface::guessRequired()">guessRequired()</a></code></tt></dt>
<dd>Пытается угадать значение <a class="reference internal" href="..\reference\forms\types\form.html#reference-form-option-required"><span>обязательной</span></a> опции;</dd>
<dt><tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/FormTypeGuesserInterface.html#method_guessMaxLength" title="Symfony\Component\Form\FormTypeGuesserInterface::guessMaxLength()">guessMaxLength()</a></code></tt></dt>
<dd>Пытается угадать значение атрибута ввода <tt class="docutils literal"><code>maxlength</code></tt>;</dd>
<dt><tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/FormTypeGuesserInterface.html#method_guessPattern" title="Symfony\Component\Form\FormTypeGuesserInterface::guessPattern()">guessPattern()</a></code></tt></dt>
<dd>Пытается угадать значение атрибута ввода <tt class="docutils literal"><code>pattern</code></tt>.</dd>
</dl>
<p>Начните с создание класса и этих методов. Далее, вы узнаете, как заполнять каждый из них:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/Form/TypeGuesser/PHPDocTypeGuesser.php</span>
<span class="k">namespace</span> <span class="nx">App\Form\TypeGuesser</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Component\Form\FormTypeGuesserInterface</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">PHPDocTypeGuesser</span> <span class="k">implements</span> <span class="nx">FormTypeGuesserInterface</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">guessType</span><span class="p">(</span><span class="nv">$class</span><span class="p">,</span> <span class="nv">$property</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">guessRequired</span><span class="p">(</span><span class="nv">$class</span><span class="p">,</span> <span class="nv">$property</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">guessMaxLength</span><span class="p">(</span><span class="nv">$class</span><span class="p">,</span> <span class="nv">$property</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">guessPattern</span><span class="p">(</span><span class="nv">$class</span><span class="p">,</span> <span class="nv">$property</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<div class="section" id="id2">
<h3>Отгадывание типа<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>При отгадывании типа, метод возвращает либо экземпляр класса
<tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/Guess/TypeGuess.html" title="Symfony\Component\Form\Guess\TypeGuess">TypeGuess</a></code></tt>, либо ничего,
чтобы определить, что отгадыватель не может угадать тип.</p>
<p>Конструктор <tt class="docutils literal"><code>TypeGuess</code></tt> требует трёх опций:</p>
<ul class="simple">
<li>Имя типа (один из <a class="reference internal" href="..\reference\forms\types.html"><em>типов форм</em></a>);</li>
<li>Дополнительные опции (например, когда тип - <tt class="docutils literal"><code>entity</code></tt>, вам также надо
установить опцию <tt class="docutils literal"><code>class</code></tt>). Если не угадан ни один тип, они должны быть
установлены как пустой массив;</li>
<li>Уверенность в том, что угаданный тип - верный. Это может быть одной из
констант класса <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/Guess/Guess.html" title="Symfony\Component\Form\Guess\Guess">Guess</a></code></tt>:
<tt class="docutils literal"><code>LOW_CONFIDENCE</code></tt>, <tt class="docutils literal"><code>MEDIUM_CONFIDENCE</code></tt>, <tt class="docutils literal"><code>HIGH_CONFIDENCE</code></tt>,
<tt class="docutils literal"><code>VERY_HIGH_CONFIDENCE</code></tt>. После того, как будут выполнены все отгадыватели
типа, будет использован тип с наибольшим доверием.</li>
</ul>
<p>Зная это, вы можете с лёгкостью реализовать метод <tt class="docutils literal"><code>guessType()</code></tt> в <tt class="docutils literal"><code>PHPDocTypeGuesser</code></tt>:</p>
<div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App\Form\TypeGuesser</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Component\Form\Guess\Guess</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Guess\TypeGuess</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\TextType</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\IntegerType</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\NumberType</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\CheckboxType</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">PHPDocTypeGuesser</span> <span class="k">implements</span> <span class="nx">FormTypeGuesserInterface</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">guessType</span><span class="p">(</span><span class="nv">$class</span><span class="p">,</span> <span class="nv">$property</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$annotations</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">readPhpDocAnnotations</span><span class="p">(</span><span class="nv">$class</span><span class="p">,</span> <span class="nv">$property</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$annotations</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">]))</span> <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span> <span class="c1">// guess nothing if the @var annotation is not available</span>
        <span class="p">}</span>

        <span class="c1">// в обратном случае, основывайте тип на аннотации @var</span>
        <span class="k">switch</span> <span class="p">(</span><span class="nv">$annotations</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">case</span> <span class="s1">&#39;string&#39;</span><span class="o">:</span>
                <span class="c1">// существует высокая уверенность в том, что тип - текст, когда</span>
                <span class="c1">// используется строка @var</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nx">TypeGuess</span><span class="p">(</span><span class="nx">TextType</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="nx">Guess</span><span class="o">::</span><span class="na">HIGH_CONFIDENCE</span><span class="p">);</span>

            <span class="k">case</span> <span class="s1">&#39;int&#39;</span><span class="o">:</span>
            <span class="k">case</span> <span class="s1">&#39;integer&#39;</span><span class="o">:</span>
                <span class="c1">// целые числа также могут быть id сущности или флаговой кнопкой (0 или 1)</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nx">TypeGuess</span><span class="p">(</span><span class="nx">IntegerType</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="nx">Guess</span><span class="o">::</span><span class="na">MEDIUM_CONFIDENCE</span><span class="p">);</span>

            <span class="k">case</span> <span class="s1">&#39;float&#39;</span><span class="o">:</span>
            <span class="k">case</span> <span class="s1">&#39;double&#39;</span><span class="o">:</span>
            <span class="k">case</span> <span class="s1">&#39;real&#39;</span><span class="o">:</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nx">TypeGuess</span><span class="p">(</span><span class="nx">NumberType</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="nx">Guess</span><span class="o">::</span><span class="na">MEDIUM_CONFIDENCE</span><span class="p">);</span>

            <span class="k">case</span> <span class="s1">&#39;boolean&#39;</span><span class="o">:</span>
            <span class="k">case</span> <span class="s1">&#39;bool&#39;</span><span class="o">:</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nx">TypeGuess</span><span class="p">(</span><span class="nx">CheckboxType</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="nx">Guess</span><span class="o">::</span><span class="na">HIGH_CONFIDENCE</span><span class="p">);</span>

            <span class="k">default</span><span class="o">:</span>
                <span class="c1">// уверенность в том, что этот тип правильный, очень низкая</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nx">TypeGuess</span><span class="p">(</span><span class="nx">TextType</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="nx">Guess</span><span class="o">::</span><span class="na">LOW_CONFIDENCE</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">protected</span> <span class="k">function</span> <span class="nf">readPhpDocAnnotations</span><span class="p">(</span><span class="nv">$class</span><span class="p">,</span> <span class="nv">$property</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$reflectionProperty</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\ReflectionProperty</span><span class="p">(</span><span class="nv">$class</span><span class="p">,</span> <span class="nv">$property</span><span class="p">);</span>
        <span class="nv">$phpdoc</span> <span class="o">=</span> <span class="nv">$reflectionProperty</span><span class="o">-&gt;</span><span class="na">getDocComment</span><span class="p">();</span>

        <span class="c1">// разобрать $phpdoc в массив таким образом:</span>
        <span class="c1">// массив (&#39;type&#39; =&gt; &#39;string&#39;, &#39;since&#39; =&gt; &#39;1.0&#39;)</span>
        <span class="nv">$phpdocTags</span> <span class="o">=</span> <span class="o">...</span><span class="p">;</span>

        <span class="k">return</span> <span class="nv">$phpdocTags</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div>
<p>Этот отгадыватель типа теперь может угадывать типа поля для свойства, если
оно имеет PHPdoc!</p>
</div>
<div class="section" id="id3">
<h3>Опции поля отгадывания<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Три других метода (<tt class="docutils literal"><code>guessMaxLength()</code></tt>, <tt class="docutils literal"><code>guessRequired()</code></tt> и <tt class="docutils literal"><code>guessPattern()</code></tt>)
возвращают экземпляр <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/Guess/ValueGuess.html" title="Symfony\Component\Form\Guess\ValueGuess">ValueGuess</a></code></tt> с значением
опции. Этот конструктор имеет 2 аргумента:</p>
<ul class="simple">
<li>Значение опции;</li>
<li>Уверенность в том, что отгаданное значение - верное (используя константы
класса <tt class="docutils literal"><code>Guess</code></tt>).</li>
</ul>
<p><tt class="docutils literal"><code>null</code></tt> угадывается, когда вы думаете, что значение опции не должно
быть установлено.</p>
<div class="admonition-wrapper">
<div class="caution"></div><div class="admonition admonition-caution"><p class="first admonition-title">Caution</p>
<p class="last">Вы должны быть очень осторожны используя метод <tt class="docutils literal"><code>guessPattern()</code></tt>. Когда тип
- float, вы не можете использовать его для определения минимального или максимального
значения float (например, вы хотите, чтобы float был больше, чем <tt class="docutils literal"><code>5</code></tt>, <tt class="docutils literal"><code>4.512313</code></tt> -
не является валидным, но <tt class="docutils literal"><code>length(4.512314) &gt; length(5)</code></tt> - валидно, так что схема
сработает). В этом случае, значение должно быть установлено, как <tt class="docutils literal"><code>null</code></tt> с <tt class="docutils literal"><code>MEDIUM_CONFIDENCE</code></tt>.</p>
</div></div>
</div>
</div>
<div class="section" id="id4">
<h2>Регистрация отгадывателя типа<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>Если вы используете <a class="reference internal" href="..\service_container.html#services-autowire"><span>автомонтирование</span></a> и
<a class="reference internal" href="..\service_container.html#services-autoconfigure"><span>автоконфигурацию</span></a>, то вы закончили! Symfony уже
знает и использует ваш отгадыватель типа формы..</p>
<p>Если вы <strong>не</strong> используете автомонтирование и автоконфигурацию, зарегистрируйте ваш
сервис вручную, и тегируйте его с помощью <tt class="docutils literal"><code>form.type_guesser</code></tt>:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="literal-block"><div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># config/services.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">services</span><span class="p p-Indicator">:</span>
    <span class="c1"># ...</span>

    <span class="l l-Scalar l-Scalar-Plain">App\Form\TypeGuesser\PHPDocTypeGuesser</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">tags</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">form.type_guesser</span><span class="p p-Indicator">]</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>XML</em><div class="literal-block"><div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">&lt;!-- config/services.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;container</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/dic/services&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/dic/services</span>
<span class="s">        http://symfony.com/schema/dic/services/services-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;services&gt;</span>
        <span class="nt">&lt;service</span> <span class="na">id=</span><span class="s">&quot;App\Form\TypeGuesser\PHPDocTypeGuesser&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;tag</span> <span class="na">name=</span><span class="s">&quot;form.type_guesser&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/service&gt;</span>
    <span class="nt">&lt;/services&gt;</span>
<span class="nt">&lt;/container&gt;</span>
</pre></div>
</td></tr></table></div></div>
</li>
<li><em>PHP</em><div class="literal-block"><div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// config/services.php</span>
<span class="k">use</span> <span class="nx">App\Form\TypeGuesser\PHPDocTypeGuesser</span><span class="p">;</span>

<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">register</span><span class="p">(</span><span class="nx">PHPDocTypeGuesser</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">addTag</span><span class="p">(</span><span class="s1">&#39;form.type_guesser&#39;</span><span class="p">)</span>
<span class="p">;</span>
</pre></div>
</td></tr></table></div></div>
</li>
</ul>
</div>
<div class="admonition-wrapper">
<div class="sidebar"></div><div class="admonition admonition-sidebar"><p class="first sidebar-title">Регистрация отгадывателя типа в компоненте</p>
<p>Если вы используете компоненты Формы изолированно в вашем PHP-проекте,
используйте <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/FormFactoryBuilder.html#method_addTypeGuesser" title="Symfony\Component\Form\FormFactoryBuilder::addTypeGuesser()">addTypeGuesser()</a></code></tt>
или <tt class="docutils literal"><code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/Form/FormFactoryBuilder.html#method_addTypeGuessers" title="Symfony\Component\Form\FormFactoryBuilder::addTypeGuessers()">addTypeGuessers()</a></code></tt> в
<tt class="docutils literal"><code>FormFactoryBuilder</code></tt>, чтобы зарегистрировать новые отгадыватели типа:</p>
<div class="literal-block"><div class="last highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Form\Forms</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Acme\Form\PHPDocTypeGuesser</span><span class="p">;</span>

<span class="nv">$formFactory</span> <span class="o">=</span> <span class="nx">Forms</span><span class="o">::</span><span class="na">createFormFactoryBuilder</span><span class="p">()</span>
    <span class="c1">// ...</span>
    <span class="o">-&gt;</span><span class="na">addTypeGuesser</span><span class="p">(</span><span class="k">new</span> <span class="nx">PHPDocTypeGuesser</span><span class="p">())</span>
    <span class="o">-&gt;</span><span class="na">getFormFactory</span><span class="p">();</span>

<span class="c1">// ...</span>
</pre></div>
</td></tr></table></div></div>
</div></div>
</div>
</div>


            </div>

            
            <div class="navigation">
                <a href="type_guesser.html">« Creating a custom Type Guesser</a>
                <span class="separator">|</span>
                <a href="unit_testing.html">How to Unit Test your Forms »</a>
            </div>
            

            <div id="license">
                <p>Эта документация является переводом <a href="http://symfony.com/doc/current/index.html">официальной документации Symfony</a> и предоставляется по свободной лицензии <a rel="license nofollow" href="https://creativecommons.org/licenses/by-sa/3.0/deed.ru">CC BY-SA 3.0</a>.</p>
            </div>
        </div>
    </div>
</div></div>


  </body>
</body></html>